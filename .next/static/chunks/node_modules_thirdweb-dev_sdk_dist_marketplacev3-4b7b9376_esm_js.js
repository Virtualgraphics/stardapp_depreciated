"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["node_modules_thirdweb-dev_sdk_dist_marketplacev3-4b7b9376_esm_js"],{

/***/ "./node_modules/@thirdweb-dev/sdk/dist/marketplacev3-4b7b9376.esm.js":
/*!***************************************************************************!*\
  !*** ./node_modules/@thirdweb-dev/sdk/dist/marketplacev3-4b7b9376.esm.js ***!
  \***************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"MarketplaceV3\": function() { return /* binding */ MarketplaceV3; }\n/* harmony export */ });\n/* harmony import */ var _QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__ = __webpack_require__(/*! ./QueryParams-da88d27c.esm.js */ \"./node_modules/@thirdweb-dev/sdk/dist/QueryParams-da88d27c.esm.js\");\n/* harmony import */ var _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__ = __webpack_require__(/*! ./thirdweb-checkout-33f13955.esm.js */ \"./node_modules/@thirdweb-dev/sdk/dist/thirdweb-checkout-33f13955.esm.js\");\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_66__ = __webpack_require__(/*! zod */ \"./node_modules/zod/lib/index.mjs\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IERC165_json__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IERC165.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC165.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IERC721_json__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IERC721.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC721.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IERC1155_json__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IERC1155.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC1155.json\");\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_69__ = __webpack_require__(/*! ethers */ \"./node_modules/ethers/lib.esm/index.js\");\n/* harmony import */ var tiny_invariant__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! tiny-invariant */ \"./node_modules/tiny-invariant/dist/esm/tiny-invariant.js\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IERC20_json__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IERC20.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC20.json\");\n/* harmony import */ var bn_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! bn.js */ \"./node_modules/bn.js/lib/bn.js\");\n/* harmony import */ var bn_js__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(bn_js__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IBurnableERC20_json__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IBurnableERC20.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IBurnableERC20.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IDrop_json__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IDrop.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IDrop.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IDropERC20_V2_json__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IDropERC20_V2.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IDropERC20_V2.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IDropSinglePhase_json__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IDropSinglePhase.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IDropSinglePhase.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IDropSinglePhase_V1_json__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IDropSinglePhase_V1.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IDropSinglePhase_V1.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IMintableERC20_json__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IMintableERC20.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IMintableERC20.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IMulticall_json__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IMulticall.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IMulticall.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_ISignatureMintERC20_json__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/ISignatureMintERC20.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/ISignatureMintERC20.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IBurnableERC721_json__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IBurnableERC721.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IBurnableERC721.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IClaimableERC721_json__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IClaimableERC721.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IClaimableERC721.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IDelayedReveal_json__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IDelayedReveal.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IDelayedReveal.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IDropERC721_V3_json__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IDropERC721_V3.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IDropERC721_V3.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IERC721Enumerable_json__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IERC721Enumerable.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC721Enumerable.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IERC721Supply_json__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IERC721Supply.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC721Supply.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_ILazyMint_json__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/ILazyMint.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/ILazyMint.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IMintableERC721_json__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IMintableERC721.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IMintableERC721.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_ISignatureMintERC721_json__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/ISignatureMintERC721.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/ISignatureMintERC721.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_ISignatureMintERC721_V1_json__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/ISignatureMintERC721_V1.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/ISignatureMintERC721_V1.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_LazyMintWithTier_json__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/LazyMintWithTier.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/LazyMintWithTier.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IBurnableERC1155_json__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IBurnableERC1155.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IBurnableERC1155.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IClaimableERC1155_json__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IClaimableERC1155.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IClaimableERC1155.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IDrop1155_json__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IDrop1155.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IDrop1155.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IDropERC1155_V2_json__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IDropERC1155_V2.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IDropERC1155_V2.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IDropSinglePhase1155_json__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IDropSinglePhase1155.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IDropSinglePhase1155.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IDropSinglePhase1155_V1_json__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IDropSinglePhase1155_V1.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IDropSinglePhase1155_V1.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IERC1155Enumerable_json__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IERC1155Enumerable.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC1155Enumerable.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IMintableERC1155_json__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IMintableERC1155.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IMintableERC1155.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_ISignatureMintERC1155_json__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/ISignatureMintERC1155.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/ISignatureMintERC1155.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_ERC2771Context_json__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/ERC2771Context.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/ERC2771Context.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IAppURI_json__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IAppURI.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IAppURI.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IContractMetadata_json__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IContractMetadata.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IContractMetadata.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IDirectListings_json__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IDirectListings.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IDirectListings.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IEnglishAuctions_json__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IEnglishAuctions.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IEnglishAuctions.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IOffers_json__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IOffers.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IOffers.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IPackVRFDirect_json__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IPackVRFDirect.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IPackVRFDirect.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IPermissions_json__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IPermissions.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IPermissions.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IPermissionsEnumerable_json__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IPermissionsEnumerable.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IPermissionsEnumerable.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IPlatformFee_json__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IPlatformFee.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IPlatformFee.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IPrimarySale_json__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IPrimarySale.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IPrimarySale.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IRouter_json__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IRouter.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IRouter.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IRoyalty_json__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IRoyalty.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IRoyalty.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_Ownable_json__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/Ownable.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/Ownable.json\");\n/* harmony import */ var cross_fetch__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! cross-fetch */ \"./node_modules/cross-fetch/dist/browser-ponyfill.js\");\n/* harmony import */ var cross_fetch__WEBPACK_IMPORTED_MODULE_48___default = /*#__PURE__*/__webpack_require__.n(cross_fetch__WEBPACK_IMPORTED_MODULE_48__);\n/* harmony import */ var eventemitter3__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! eventemitter3 */ \"./node_modules/@thirdweb-dev/sdk/node_modules/eventemitter3/index.mjs\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_Forwarder_json__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/Forwarder.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/Forwarder.json\");\n/* harmony import */ var _thirdweb_dev_storage__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! @thirdweb-dev/storage */ \"./node_modules/@thirdweb-dev/storage/dist/thirdweb-dev-storage.esm.js\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IERC20Metadata_json__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IERC20Metadata.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC20Metadata.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_Router_json__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/Router.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/Router.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IThirdwebContract_json__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IThirdwebContract.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IThirdwebContract.json\");\n/* harmony import */ var merkletreejs__WEBPACK_IMPORTED_MODULE_55__ = __webpack_require__(/*! merkletreejs */ \"./node_modules/merkletreejs/dist/index.js\");\n/* harmony import */ var merkletreejs__WEBPACK_IMPORTED_MODULE_55___default = /*#__PURE__*/__webpack_require__.n(merkletreejs__WEBPACK_IMPORTED_MODULE_55__);\n/* harmony import */ var fast_deep_equal__WEBPACK_IMPORTED_MODULE_56__ = __webpack_require__(/*! fast-deep-equal */ \"./node_modules/fast-deep-equal/index.js\");\n/* harmony import */ var fast_deep_equal__WEBPACK_IMPORTED_MODULE_56___default = /*#__PURE__*/__webpack_require__.n(fast_deep_equal__WEBPACK_IMPORTED_MODULE_56__);\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IERC721Metadata_json__WEBPACK_IMPORTED_MODULE_57__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IERC721Metadata.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC721Metadata.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IERC1155Metadata_json__WEBPACK_IMPORTED_MODULE_58__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IERC1155Metadata.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IERC1155Metadata.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_IDelayedRevealDeprecated_json__WEBPACK_IMPORTED_MODULE_59__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/IDelayedRevealDeprecated.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/IDelayedRevealDeprecated.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_TWFactory_json__WEBPACK_IMPORTED_MODULE_60__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/TWFactory.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/TWFactory.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_TWRegistry_json__WEBPACK_IMPORTED_MODULE_61__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/TWRegistry.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/TWRegistry.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_ContractPublisher_json__WEBPACK_IMPORTED_MODULE_62__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/ContractPublisher.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/ContractPublisher.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_TWMultichainRegistryLogic_json__WEBPACK_IMPORTED_MODULE_63__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/TWMultichainRegistryLogic.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/TWMultichainRegistryLogic.json\");\n/* harmony import */ var _thirdweb_dev_contracts_js_dist_abis_TWMultichainRegistryRouter_json__WEBPACK_IMPORTED_MODULE_64__ = __webpack_require__(/*! @thirdweb-dev/contracts-js/dist/abis/TWMultichainRegistryRouter.json */ \"./node_modules/@thirdweb-dev/contracts-js/dist/abis/TWMultichainRegistryRouter.json\");\n/* harmony import */ var bs58__WEBPACK_IMPORTED_MODULE_65__ = __webpack_require__(/*! bs58 */ \"./node_modules/@thirdweb-dev/sdk/node_modules/bs58/index.js\");\n/* harmony import */ var bs58__WEBPACK_IMPORTED_MODULE_65___default = /*#__PURE__*/__webpack_require__.n(bs58__WEBPACK_IMPORTED_MODULE_65__);\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * @internal\n */\nconst DirectListingInputParamsSchema = zod__WEBPACK_IMPORTED_MODULE_66__.z.object({\n  /**\n   * The address of the asset being listed.\n   */\n  assetContractAddress: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ad,\n  /**\n   * The ID of the token to list.\n   */\n  tokenId: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ab,\n  /**\n   * The quantity of tokens to include in the listing.\n   *\n   * For ERC721s, this value should always be 1 (and will be forced internally regardless of what is passed here).\n   */\n  quantity: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ab[\"default\"](1),\n  /**\n   * The address of the currency to accept for the listing.\n   */\n  currencyContractAddress: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ad[\"default\"](_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cc),\n  /**\n   * The price to pay per unit of NFTs listed.\n   */\n  pricePerToken: _QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__.A,\n  /**\n   * The start time of the listing.\n   */\n  startTimestamp: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ae[\"default\"](new Date()),\n  /**\n   * The end time of the listing.\n   */\n  endTimestamp: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ag,\n  /**\n   * Whether the listing is reserved to be bought from a specific set of buyers.\n   */\n  isReservedListing: zod__WEBPACK_IMPORTED_MODULE_66__.z.boolean().default(false)\n});\n\n/**\n * @public\n */\n\n/**\n * Handles direct listings\n * @public\n */\nclass MarketplaceV3DirectListings {\n  // utilities\n\n  constructor(contractWrapper, storage) {\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"featureName\", _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cQ.name);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"contractWrapper\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"storage\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"events\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"interceptor\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"encoder\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"estimator\", void 0);\n    this.contractWrapper = contractWrapper;\n    this.storage = storage;\n    this.events = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aV(this.contractWrapper);\n    this.encoder = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aj(this.contractWrapper);\n    this.interceptor = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aW(this.contractWrapper);\n    this.estimator = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aU(this.contractWrapper);\n  }\n  getAddress() {\n    return this.contractWrapper.readContract.address;\n  }\n\n  /** ******************************\n   * READ FUNCTIONS\n   *******************************/\n\n  /**\n   * Get the total number of direct listings.\n   * @returns Returns the total number of direct listings created.\n   * @public\n   *\n   * @example\n   * ```javascript\n   * const totalListings = await contract.directListings.getTotalCount();\n   * ```\n   */\n  async getTotalCount() {\n    return await this.contractWrapper.readContract.totalListings();\n  }\n\n  /**\n   * Get all direct listings.\n   *\n   * @example\n   * ```javascript\n   * const listings = await contract.directListings.getAll();\n   * const priceOfFirstListing = listings[0].price;\n   * ```\n   *\n   * @param filter - optional filter parameters\n   * @returns the Direct listing object array\n   */\n  async getAll(filter) {\n    const totalListings = await this.getTotalCount();\n    let start = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(filter?.start || 0).toNumber();\n    let end = totalListings.toNumber();\n    if (end === 0) {\n      throw new Error(`No listings exist on the contract.`);\n    }\n    let rawListings = [];\n    let batches = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cR)(start, end, this.contractWrapper.readContract.getAllListings);\n    rawListings = batches.flat();\n    const filteredListings = this.applyFilter(rawListings, filter);\n    return await Promise.all(filteredListings.map(listing => this.mapListing(listing)));\n  }\n\n  /**\n   * Get all valid direct listings.\n   *\n   * A valid listing is where the listing is active,\n   * and the creator still owns & has approved Marketplace to transfer the listed NFTs.\n   *\n   * @example\n   * ```javascript\n   * const listings = await contract.directListings.getAllValid();\n   * const priceOfFirstListing = listings[0].price;\n   * ```\n   *\n   * @param filter - optional filter parameters\n   * @returns the Direct listing object array\n   */\n  async getAllValid(filter) {\n    const totalListings = await this.getTotalCount();\n    let start = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(filter?.start || 0).toNumber();\n    let end = totalListings.toNumber();\n    if (end === 0) {\n      throw new Error(`No listings exist on the contract.`);\n    }\n    let rawListings = [];\n    let batches = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cR)(start, end, this.contractWrapper.readContract.getAllValidListings);\n    rawListings = batches.flat();\n    const filteredListings = this.applyFilter(rawListings, filter);\n    return await Promise.all(filteredListings.map(listing => this.mapListing(listing)));\n  }\n\n  /**\n   * Get a direct listing by id.\n   *\n   * @param listingId - the listing id\n   * @returns the Direct listing object\n   *\n   * @example\n   * ```javascript\n   * const listingId = 0;\n   * const listing = await contract.directListings.getListing(listingId);\n   * ```\n   */\n  async getListing(listingId) {\n    const listing = await this.contractWrapper.readContract.getListing(listingId);\n    return await this.mapListing(listing);\n  }\n\n  /**\n   * Check whether a buyer is approved for a reserved listing.\n   *\n   * @param listingId - the listing id\n   * @param buyer - buyer address\n   */\n  async isBuyerApprovedForListing(listingId, buyer) {\n    const listing = await this.validateListing(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(listingId));\n    if (!listing.isReservedListing) {\n      throw new Error(`Listing ${listingId} is not a reserved listing.`);\n    }\n    return await this.contractWrapper.readContract.isBuyerApprovedForListing(listingId, buyer);\n  }\n\n  /**\n   * Check whether a currency is approved for a listing.\n   *\n   * @param listingId - the listing id\n   * @param currency - currency address\n   */\n  async isCurrencyApprovedForListing(listingId, currency) {\n    await this.validateListing(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(listingId));\n    return await this.contractWrapper.readContract.isCurrencyApprovedForListing(listingId, currency);\n  }\n\n  /**\n   * Check price per token for an approved currency.\n   *\n   * @param listingId - the listing id\n   * @param currencyContractAddress - currency contract address\n   */\n  async currencyPriceForListing(listingId, currencyContractAddress) {\n    const listing = await this.validateListing(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(listingId));\n    if (currencyContractAddress === listing.currencyContractAddress) {\n      return listing.pricePerToken;\n    }\n    const isApprovedCurrency = await this.isCurrencyApprovedForListing(listingId, currencyContractAddress);\n    if (!isApprovedCurrency) {\n      throw new Error(`Currency ${currencyContractAddress} is not approved for Listing ${listingId}.`);\n    }\n    return await this.contractWrapper.readContract.currencyPriceForListing(listingId, currencyContractAddress);\n  }\n\n  /** ******************************\n   * WRITE FUNCTIONS\n   *******************************/\n\n  /**\n   * Create Direct Listing\n   *\n   * @remarks Create a new listing on the marketplace where people can buy an asset directly.\n   *\n   * @example\n   * ```javascript\n   * // Data of the listing you want to create\n   * const listing = {\n   *   // address of the contract the asset you want to list is on\n   *   assetContractAddress: \"0x...\",\n   *   // token ID of the asset you want to list\n   *   tokenId: \"0\",\n   *   // how many of the asset you want to list\n   *   quantity: 1,\n   *   // address of the currency contract that will be used to pay for the listing\n   *   currencyContractAddress: NATIVE_TOKEN_ADDRESS,\n   *   // The price to pay per unit of NFTs listed.\n   *   pricePerToken: 1.5,\n   *   // when should the listing open up for offers\n   *   startTimestamp: new Date(Date.now()),\n   *   // how long the listing will be open for\n   *   endTimestamp: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000),\n   *   // Whether the listing is reserved for a specific set of buyers.\n   *   isReservedListing: false\n   * }\n   *\n   * const tx = await contract.directListings.createListing(listing);\n   * const receipt = tx.receipt; // the transaction receipt\n   * const id = tx.id; // the id of the newly created listing\n   * ```\n   */\n  async createListing(listing) {\n    const parsedListing = DirectListingInputParamsSchema.parse(listing);\n    await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cS)(this.contractWrapper, this.getAddress(), parsedListing.assetContractAddress, parsedListing.tokenId, await this.contractWrapper.getSignerAddress());\n    const normalizedPricePerToken = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b8)(this.contractWrapper.getProvider(), parsedListing.pricePerToken, parsedListing.currencyContractAddress);\n    const block = await this.contractWrapper.getProvider().getBlock(\"latest\");\n    const blockTime = block.timestamp;\n    if (parsedListing.startTimestamp.lt(blockTime)) {\n      parsedListing.startTimestamp = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(blockTime);\n    }\n    const receipt = await this.contractWrapper.sendTransaction(\"createListing\", [{\n      assetContract: parsedListing.assetContractAddress,\n      tokenId: parsedListing.tokenId,\n      quantity: parsedListing.quantity,\n      currency: (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cT)(parsedListing.currencyContractAddress),\n      pricePerToken: normalizedPricePerToken,\n      startTimestamp: parsedListing.startTimestamp,\n      endTimestamp: parsedListing.endTimestamp,\n      reserved: parsedListing.isReservedListing\n    }], {\n      // Higher gas limit for create listing\n      gasLimit: 500000\n    });\n    const event = this.contractWrapper.parseLogs(\"NewListing\", receipt?.logs);\n    return {\n      id: event[0].args.listingId,\n      receipt\n    };\n  }\n\n  /**\n   * Update a Direct listing with new metadata.\n   *\n   * Note: cannot update a listing with a new quantity of 0. Use `cancelDirectListing` to remove a listing instead.\n   *\n   * @param listing - the new listing information\n   *\n   * @example\n   * ```javascript\n   * // Data of the listing you want to update\n   *\n   * const listingId = 0; // ID of the listing you want to update\n   *\n   * const listing = {\n   *   // address of the contract the asset you want to list is on\n   *   assetContractAddress: \"0x...\", // should be same as original listing\n   *   // token ID of the asset you want to list\n   *   tokenId: \"0\", // should be same as original listing\n   *   // how many of the asset you want to list\n   *   quantity: 1,\n   *   // address of the currency contract that will be used to pay for the listing\n   *   currencyContractAddress: NATIVE_TOKEN_ADDRESS,\n   *   // The price to pay per unit of NFTs listed.\n   *   pricePerToken: 1.5,\n   *   // when should the listing open up for offers\n   *   startTimestamp: new Date(Date.now()), // can't change this if listing already active\n   *   // how long the listing will be open for\n   *   endTimestamp: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000),\n   *   // Whether the listing is reserved for a specific set of buyers.\n   *   isReservedListing: false\n   * }\n   *\n   * const tx = await contract.directListings.updateListing(listingId, listing);\n   * const receipt = tx.receipt; // the transaction receipt\n   * const id = tx.id; // the id of the newly created listing\n   * ```\n   */\n  async updateListing(listingId, listing) {\n    const parsedListing = DirectListingInputParamsSchema.parse(listing);\n    await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cS)(this.contractWrapper, this.getAddress(), parsedListing.assetContractAddress, parsedListing.tokenId, await this.contractWrapper.getSignerAddress());\n    const normalizedPricePerToken = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b8)(this.contractWrapper.getProvider(), parsedListing.pricePerToken, parsedListing.currencyContractAddress);\n    const receipt = await this.contractWrapper.sendTransaction(\"updateListing\", [listingId, {\n      assetContract: parsedListing.assetContractAddress,\n      tokenId: parsedListing.tokenId,\n      quantity: parsedListing.quantity,\n      currency: (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cT)(parsedListing.currencyContractAddress),\n      pricePerToken: normalizedPricePerToken,\n      startTimestamp: parsedListing.startTimestamp,\n      endTimestamp: parsedListing.endTimestamp,\n      reserved: parsedListing.isReservedListing\n    }], {\n      // Higher gas limit for create listing\n      gasLimit: 500000\n    });\n    const event = this.contractWrapper.parseLogs(\"UpdatedListing\", receipt?.logs);\n    return {\n      id: event[0].args.listingId,\n      receipt\n    };\n  }\n\n  /**\n   * Cancel Direct Listing\n   *\n   * @remarks Cancel a direct listing on the marketplace\n   *\n   * @example\n   * ```javascript\n   * // The listing ID of the direct listing you want to cancel\n   * const listingId = 0;\n   *\n   * await contract.directListings.cancelListing(listingId);\n   * ```\n   */\n  async cancelListing(listingId) {\n    return {\n      receipt: await this.contractWrapper.sendTransaction(\"cancelListing\", [listingId])\n    };\n  }\n\n  /**\n   * Buy from a Listing\n   *\n   * @remarks Buy from a specific direct listing from the marketplace.\n   *\n   * @example\n   * ```javascript\n   * // The ID of the listing you want to buy from\n   * const listingId = 0;\n   * // Quantity of the asset you want to buy\n   * const quantityDesired = 1;\n   *\n   * await contract.directListings.buyFromListing(listingId, quantityDesired);\n   * ```\n   *\n   * @param listingId - The listing id to buy\n   * @param quantityDesired - the quantity to buy\n   * @param receiver - optional receiver of the bought listing if different from the connected wallet\n   */\n  async buyFromListing(listingId, quantityDesired, receiver) {\n    const listing = await this.validateListing(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(listingId));\n    const {\n      valid,\n      error\n    } = await this.isStillValidListing(listing, quantityDesired);\n    if (!valid) {\n      throw new Error(`Listing ${listingId} is no longer valid. ${error}`);\n    }\n    const buyFor = receiver ? receiver : await this.contractWrapper.getSignerAddress();\n    const quantity = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(quantityDesired);\n    const value = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(listing.pricePerToken).mul(quantity);\n    const overrides = (await this.contractWrapper.getCallOverrides()) || {};\n    await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cU)(this.contractWrapper, value, listing.currencyContractAddress, overrides);\n    return {\n      receipt: await this.contractWrapper.sendTransaction(\"buyFromListing\", [listingId, buyFor, quantity, listing.currencyContractAddress, value], overrides)\n    };\n  }\n\n  /**\n   * Approve buyer for reserved listing.\n   *\n   * @remarks Approve a buyer to buy from a reserved listing.\n   *\n   * @example\n   * ```javascript\n   * // The listing ID of the direct listing you want approve buyer for\n   * const listingId = \"0\";\n   *\n   * await contract.directListings.approveBuyerForReservedListing(listingId, buyer);\n   * ```\n   *\n   * @param listingId - The listing id to buy\n   * @param buyer - Address of buyer being approved\n   */\n  async approveBuyerForReservedListing(listingId, buyer) {\n    const isApproved = await this.isBuyerApprovedForListing(listingId, buyer);\n    if (!isApproved) {\n      return {\n        receipt: await this.contractWrapper.sendTransaction(\"approveBuyerForListing\", [listingId, buyer, true])\n      };\n    } else {\n      throw new Error(`Buyer ${buyer} already approved for listing ${listingId}.`);\n    }\n  }\n\n  /**\n   * Revoke approval of a buyer for reserved listing.\n   *\n   * @example\n   * ```javascript\n   * // The listing ID of the direct listing you want approve buyer for\n   * const listingId = \"0\";\n   *\n   * await contract.directListings.revokeBuyerApprovalForReservedListing(listingId, buyer);\n   * ```\n   *\n   * @param listingId - The listing id to buy\n   * @param buyer - Address of buyer being approved\n   */\n  async revokeBuyerApprovalForReservedListing(listingId, buyer) {\n    const isApproved = await this.isBuyerApprovedForListing(listingId, buyer);\n    if (isApproved) {\n      return {\n        receipt: await this.contractWrapper.sendTransaction(\"approveBuyerForListing\", [listingId, buyer, false])\n      };\n    } else {\n      throw new Error(`Buyer ${buyer} not approved for listing ${listingId}.`);\n    }\n  }\n\n  /**\n   * Approve a currency for a listing.\n   *\n   *\n   * @example\n   * ```javascript\n   * // The listing ID of the direct listing you want approve currency for\n   * const listingId = \"0\";\n   *\n   * await contract.directListings.approveCurrencyForListing(listingId, currencyContractAddress, pricePerTokenInCurrency);\n   * ```\n   *\n   * @param listingId - The listing id to buy\n   * @param currencyContractAddress - Address of currency being approved\n   * @param pricePerTokenInCurrency - Price per token in the currency\n   */\n  async approveCurrencyForListing(listingId, currencyContractAddress, pricePerTokenInCurrency) {\n    const listing = await this.validateListing(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(listingId));\n    if (currencyContractAddress === listing.currencyContractAddress) {\n      (0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(pricePerTokenInCurrency === listing.pricePerToken, \"Approving listing currency with a different price.\");\n    }\n    const currencyPrice = await this.contractWrapper.readContract.currencyPriceForListing(listingId, currencyContractAddress);\n    (0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(pricePerTokenInCurrency === currencyPrice, \"Currency already approved with this price.\");\n    return {\n      receipt: await this.contractWrapper.sendTransaction(\"approveCurrencyForListing\", [listingId, currencyContractAddress, pricePerTokenInCurrency])\n    };\n  }\n\n  /**\n   * Revoke approval of a currency from a listing.\n   *\n   *\n   * @example\n   * ```javascript\n   * // The listing ID of the direct listing you want to revoke currency for\n   * const listingId = \"0\";\n   *\n   * await contract.directListings.revokeCurrencyApprovalForListing(listingId, currencyContractAddress);\n   * ```\n   *\n   * @param listingId - The listing id to buy\n   * @param currencyContractAddress - Address of currency\n   */\n  async revokeCurrencyApprovalForListing(listingId, currencyContractAddress) {\n    const listing = await this.validateListing(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(listingId));\n    if (currencyContractAddress === listing.currencyContractAddress) {\n      throw new Error(`Can't revoke approval for main listing currency.`);\n    }\n    const currencyPrice = await this.contractWrapper.readContract.currencyPriceForListing(listingId, currencyContractAddress);\n    (0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(!currencyPrice.isZero(), \"Currency not approved.\");\n    return {\n      receipt: await this.contractWrapper.sendTransaction(\"approveCurrencyForListing\", [listingId, currencyContractAddress, ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(0)])\n    };\n  }\n\n  /** ******************************\n   * PRIVATE FUNCTIONS\n   *******************************/\n\n  /**\n   * Throws error if listing could not be found\n   *\n   * @param listingId - Listing to check for\n   */\n  async validateListing(listingId) {\n    try {\n      return await this.getListing(listingId);\n    } catch (err) {\n      console.error(`Error getting the listing with id ${listingId}`);\n      throw err;\n    }\n  }\n\n  /**\n   * Helper method maps the auction listing to the direct listing interface.\n   *\n   * @internal\n   * @param listing - The listing to map, as returned from the contract.\n   * @returns - The mapped interface.\n   */\n  async mapListing(listing) {\n    let status = _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.UNSET;\n    const block = await this.contractWrapper.getProvider().getBlock(\"latest\");\n    const blockTime = block.timestamp;\n    switch (listing.status) {\n      case 1:\n        status = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(listing.startTimestamp).gt(blockTime) ? _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Created : ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(listing.endTimestamp).lt(blockTime) ? _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Expired : _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Active;\n        break;\n      case 2:\n        status = _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Completed;\n        break;\n      case 3:\n        status = _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Cancelled;\n        break;\n    }\n    return {\n      assetContractAddress: listing.assetContract,\n      currencyContractAddress: listing.currency,\n      pricePerToken: listing.pricePerToken.toString(),\n      currencyValuePerToken: await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b6)(this.contractWrapper.getProvider(), listing.currency, listing.pricePerToken),\n      id: listing.listingId.toString(),\n      tokenId: listing.tokenId.toString(),\n      quantity: listing.quantity.toString(),\n      startTimeInSeconds: ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(listing.startTimestamp).toNumber(),\n      asset: await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cV)(listing.assetContract, this.contractWrapper.getProvider(), listing.tokenId, this.storage),\n      endTimeInSeconds: ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(listing.endTimestamp).toNumber(),\n      creatorAddress: listing.listingCreator,\n      isReservedListing: listing.reserved,\n      status: status\n    };\n  }\n\n  /**\n   * Use this method to check if a direct listing is still valid.\n   *\n   * Ways a direct listing can become invalid:\n   * 1. The asset holder transferred the asset to another wallet\n   * 2. The asset holder burned the asset\n   * 3. The asset holder removed the approval on the marketplace\n   *\n   * @internal\n   * @param listing - The listing to check.\n   * @returns - True if the listing is valid, false otherwise.\n   */\n  async isStillValidListing(listing, quantity) {\n    const approved = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cW)(this.contractWrapper.getProvider(), this.getAddress(), listing.assetContractAddress, listing.tokenId, listing.creatorAddress);\n    if (!approved) {\n      return {\n        valid: false,\n        error: `Token '${listing.tokenId}' from contract '${listing.assetContractAddress}' is not approved for transfer`\n      };\n    }\n    const provider = this.contractWrapper.getProvider();\n    const erc165 = new ethers__WEBPACK_IMPORTED_MODULE_69__.Contract(listing.assetContractAddress, _thirdweb_dev_contracts_js_dist_abis_IERC165_json__WEBPACK_IMPORTED_MODULE_0__, provider);\n    const isERC721 = await erc165.supportsInterface(_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ca);\n    const isERC1155 = await erc165.supportsInterface(_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cb);\n    if (isERC721) {\n      const asset = new ethers__WEBPACK_IMPORTED_MODULE_69__.Contract(listing.assetContractAddress, _thirdweb_dev_contracts_js_dist_abis_IERC721_json__WEBPACK_IMPORTED_MODULE_1__, provider);\n      const valid = (await asset.ownerOf(listing.tokenId)).toLowerCase() === listing.creatorAddress.toLowerCase();\n      return {\n        valid,\n        error: valid ? undefined : `Seller is not the owner of Token '${listing.tokenId}' from contract '${listing.assetContractAddress} anymore'`\n      };\n    } else if (isERC1155) {\n      const asset = new ethers__WEBPACK_IMPORTED_MODULE_69__.Contract(listing.assetContractAddress, _thirdweb_dev_contracts_js_dist_abis_IERC1155_json__WEBPACK_IMPORTED_MODULE_2__, provider);\n      const balance = await asset.balanceOf(listing.creatorAddress, listing.tokenId);\n      const valid = balance.gte(quantity || listing.quantity);\n      return {\n        valid,\n        error: valid ? undefined : `Seller does not have enough balance of Token '${listing.tokenId}' from contract '${listing.assetContractAddress} to fulfill the listing`\n      };\n    } else {\n      return {\n        valid: false,\n        error: \"Contract does not implement ERC 1155 or ERC 721.\"\n      };\n    }\n  }\n  applyFilter(listings, filter) {\n    let rawListings = [...listings];\n    if (filter) {\n      if (filter.seller) {\n        rawListings = rawListings.filter(seller => seller.listingCreator.toString().toLowerCase() === filter?.seller?.toString().toLowerCase());\n      }\n      if (filter.tokenContract) {\n        rawListings = rawListings.filter(tokenContract => tokenContract.assetContract.toString().toLowerCase() === filter?.tokenContract?.toString().toLowerCase());\n      }\n      if (filter.tokenId !== undefined) {\n        rawListings = rawListings.filter(tokenContract => tokenContract.tokenId.toString() === filter?.tokenId?.toString());\n      }\n    }\n    return filter?.count && filter.count < rawListings.length ? rawListings.slice(0, filter.count) : rawListings;\n  }\n}\n\n/**\n * @internal\n */\nconst EnglishAuctionInputParamsSchema = zod__WEBPACK_IMPORTED_MODULE_66__.z.object({\n  /**\n   * The address of the asset being auctioned.\n   */\n  assetContractAddress: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ad,\n  /**\n   * The ID of the token to auction.\n   */\n  tokenId: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ab,\n  /**\n   * The quantity of tokens to include in the listing.\n   *\n   * For ERC721s, this value should always be 1 (and will be forced internally regardless of what is passed here).\n   */\n  quantity: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ab[\"default\"](1),\n  /**\n   * The address of the currency to accept for the listing.\n   */\n  currencyContractAddress: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ad[\"default\"](_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cc),\n  /**\n   * The minimum price that a bid must be in order to be accepted.\n   */\n  minimumBidAmount: _QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__.A,\n  /**\n   * The buyout price of the auction.\n   */\n  buyoutBidAmount: _QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__.A,\n  /**\n   * This is a buffer e.g. x seconds.\n   *\n   * If a new winning bid is made less than x seconds before expirationTimestamp, the\n   * expirationTimestamp is increased by x seconds.\n   */\n  timeBufferInSeconds: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ab[\"default\"](900),\n  // 15 minutes by default\n\n  /**\n   * This is a buffer in basis points e.g. x%.\n   *\n   * To be considered as a new winning bid, a bid must be at least x% greater than\n   * the current winning bid.\n   */\n  bidBufferBps: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ab[\"default\"](500),\n  // 5% by default\n\n  /**\n   * The start time of the auction.\n   */\n  startTimestamp: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ae[\"default\"](new Date()),\n  /**\n   * The end time of the auction.\n   */\n  endTimestamp: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ag\n});\n\n/**\n * @public\n */\n\n/**\n * Handles auctions\n * @public\n */\nclass MarketplaceV3EnglishAuctions {\n  // utilities\n\n  constructor(contractWrapper, storage) {\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"featureName\", _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cX.name);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"contractWrapper\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"storage\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"events\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"interceptor\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"encoder\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"estimator\", void 0);\n    this.contractWrapper = contractWrapper;\n    this.storage = storage;\n    this.events = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aV(this.contractWrapper);\n    this.encoder = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aj(this.contractWrapper);\n    this.interceptor = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aW(this.contractWrapper);\n    this.estimator = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aU(this.contractWrapper);\n  }\n  getAddress() {\n    return this.contractWrapper.readContract.address;\n  }\n\n  /** ******************************\n   * READ FUNCTIONS\n   *******************************/\n\n  /**\n   * Get the total number of english auctions.\n   * @returns Returns the total number of auctions created.\n   * @public\n   *\n   * @example\n   * ```javascript\n   * const totalAuctions = await contract.englishAuctions.getTotalCount();\n   * ```\n   */\n  async getTotalCount() {\n    return await this.contractWrapper.readContract.totalAuctions();\n  }\n\n  /**\n   * Get all auctions.\n   *\n   * @example\n   * ```javascript\n   * const auctions = await contract.englishAuctions.getAll();\n   * ```\n   *\n   * @param filter - optional filter parameters\n   * @returns the Auction object array\n   */\n  async getAll(filter) {\n    const totalAuctions = await this.getTotalCount();\n    let start = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(filter?.start || 0).toNumber();\n    let end = totalAuctions.toNumber();\n    if (end === 0) {\n      throw new Error(`No auctions exist on the contract.`);\n    }\n    let rawAuctions = [];\n    let batches = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cR)(start, end, this.contractWrapper.readContract.getAllAuctions);\n    rawAuctions = batches.flat();\n    const filteredAuctions = this.applyFilter(rawAuctions, filter);\n    return await Promise.all(filteredAuctions.map(auction => this.mapAuction(auction)));\n  }\n\n  /**\n   * Get all valid auctions.\n   *\n   * @example\n   * ```javascript\n   * const auctions = await contract.englishAuctions.getAllValid();\n   * ```\n   *\n   * @param filter - optional filter parameters\n   * @returns the Auction object array\n   */\n  async getAllValid(filter) {\n    const totalAuctions = await this.getTotalCount();\n    let start = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(filter?.start || 0).toNumber();\n    let end = totalAuctions.toNumber();\n    if (end === 0) {\n      throw new Error(`No auctions exist on the contract.`);\n    }\n    let rawAuctions = [];\n    let batches = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cR)(start, end, this.contractWrapper.readContract.getAllValidAuctions);\n    rawAuctions = batches.flat();\n    const filteredAuctions = this.applyFilter(rawAuctions, filter);\n    return await Promise.all(filteredAuctions.map(auction => this.mapAuction(auction)));\n  }\n\n  /**\n   * Get an Auction by id.\n   *\n   * @example\n   * ```javascript\n   * const auctionId = 0;\n   * const auction = await contract.englishAuctions.getAuction(auctionId);\n   * ```\n   *\n   * @param auctionId - the auction Id\n   * @returns the Auction object\n   */\n  async getAuction(auctionId) {\n    const auction = await this.contractWrapper.readContract.getAuction(auctionId);\n    return await this.mapAuction(auction);\n  }\n\n  /**\n   * Get Highest Bid\n   *\n   * @remarks Get the current highest bid of an active auction.\n   *\n   * @example\n   * ```javascript\n   * // The ID of the auction\n   * const auctionId = 0;\n   *\n   * contract.englishAuctions.\n   *   .getWinningBid(auctionId)\n   *   .then((bid) => console.log(bid))\n   *   .catch((err) => console.error(err));\n   * ```\n   */\n  async getWinningBid(auctionId) {\n    await this.validateAuction(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auctionId));\n    const bid = await this.contractWrapper.readContract.getWinningBid(auctionId);\n    if (bid._bidder === ethers__WEBPACK_IMPORTED_MODULE_69__.constants.AddressZero) {\n      return undefined;\n    }\n    return await this.mapBid(auctionId.toString(), bid._bidder, bid._currency, bid._bidAmount.toString());\n  }\n\n  /**\n   * Check if a bid-amount is/will be a winning bid.\n   *\n   * @param auctionId - Auction Id\n   * @param bidAmount - Amount to bid\n   * @returns the Auction object\n   */\n  async isWinningBid(auctionId, bidAmount) {\n    return await this.contractWrapper.readContract.isNewWinningBid(auctionId, bidAmount);\n  }\n\n  /**\n   * Get Auction Winner\n   *\n   * @remarks Get the winner of the auction after an auction ends.\n   *\n   * @example\n   * ```javascript\n   * // The auction ID of the auction that closed\n   * const auctionId = 0;\n   *\n   * contract.englishAuctions.\n   *   .getWinner(auctionId)\n   *   .then((auctionWinner) => console.log(auctionWinner))\n   *   .catch((err) => console.error(err));\n   * ```\n   */\n  async getWinner(auctionId) {\n    const auction = await this.validateAuction(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auctionId));\n    const bid = await this.contractWrapper.readContract.getWinningBid(auctionId);\n    const now = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(Math.floor(Date.now() / 1000));\n    const endTime = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auction.endTimeInSeconds);\n\n    // if we have a winner in the map and the current time is past the endtime of the auction return the address of the winner\n    if (now.gt(endTime) && bid._bidder !== ethers__WEBPACK_IMPORTED_MODULE_69__.constants.AddressZero) {\n      return bid._bidder;\n    }\n    // otherwise fall back to query filter things\n\n    // TODO this should be via indexer or direct contract call\n    const closedAuctions = await this.contractWrapper.readContract.queryFilter(this.contractWrapper.readContract.filters.AuctionClosed());\n    const closed = closedAuctions.find(a => a.args.auctionId.eq(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auctionId)));\n    if (!closed) {\n      throw new Error(`Could not find auction with ID ${auctionId} in closed auctions`);\n    }\n    return closed.args.winningBidder;\n  }\n\n  /** ******************************\n   * WRITE FUNCTIONS\n   *******************************/\n\n  /**\n   * Create Auction\n   *\n   * @remarks Create a new auction where people can bid on an asset.\n   *\n   * @example\n   * ```javascript\n   * // Data of the auction you want to create\n   * const auction = {\n   *   // address of the contract of the asset you want to auction\n   *   assetContractAddress: \"0x...\",\n   *   // token ID of the asset you want to auction\n   *   tokenId: \"0\",\n   *   // how many of the asset you want to auction\n   *   quantity: 1,\n   *   // address of the currency contract that will be used to pay for the auctioned tokens\n   *   currencyContractAddress: NATIVE_TOKEN_ADDRESS,\n   *   // the minimum bid that will be accepted for the token\n   *   minimumBidAmount: \"1.5\",\n   *   // how much people would have to bid to instantly buy the asset\n   *   buyoutBidAmount: \"10\",\n   *   // If a bid is made less than these many seconds before expiration, the expiration time is increased by this.\n   *   timeBufferInSeconds: \"900\", // 15 minutes by default\n   *   // A bid must be at least this much bps greater than the current winning bid\n   *   bidBufferBps: \"500\", // 5% by default\n   *   // when should the auction open up for bidding\n   *   startTimestamp: new Date(Date.now()),\n   *   // end time of auction\n   *   endTimestamp: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000),\n   * }\n   *\n   * const tx = await contract.englishAuctions.createAuction(auction);\n   * const receipt = tx.receipt; // the transaction receipt\n   * const id = tx.id; // the id of the newly created auction\n   * ```\n   */\n  async createAuction(auction) {\n    const parsedAuction = EnglishAuctionInputParamsSchema.parse(auction);\n    await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cS)(this.contractWrapper, this.getAddress(), parsedAuction.assetContractAddress, parsedAuction.tokenId, await this.contractWrapper.getSignerAddress());\n    const normalizedBuyoutAmount = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b8)(this.contractWrapper.getProvider(), parsedAuction.buyoutBidAmount, parsedAuction.currencyContractAddress);\n    const normalizedMinBidAmount = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b8)(this.contractWrapper.getProvider(), parsedAuction.minimumBidAmount, parsedAuction.currencyContractAddress);\n    const block = await this.contractWrapper.getProvider().getBlock(\"latest\");\n    const blockTime = block.timestamp;\n    if (parsedAuction.startTimestamp.lt(blockTime)) {\n      parsedAuction.startTimestamp = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(blockTime);\n    }\n    const receipt = await this.contractWrapper.sendTransaction(\"createAuction\", [{\n      assetContract: parsedAuction.assetContractAddress,\n      tokenId: parsedAuction.tokenId,\n      quantity: parsedAuction.quantity,\n      currency: (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cT)(parsedAuction.currencyContractAddress),\n      minimumBidAmount: normalizedMinBidAmount,\n      buyoutBidAmount: normalizedBuyoutAmount,\n      timeBufferInSeconds: parsedAuction.timeBufferInSeconds,\n      bidBufferBps: parsedAuction.bidBufferBps,\n      startTimestamp: parsedAuction.startTimestamp,\n      endTimestamp: parsedAuction.endTimestamp\n    }], {\n      // Higher gas limit for create auction\n      gasLimit: 500000\n    });\n    const event = this.contractWrapper.parseLogs(\"NewAuction\", receipt?.logs);\n    return {\n      id: event[0].args.auctionId,\n      receipt\n    };\n  }\n\n  /**\n   * Buyout Auction\n   *\n   * @remarks Buy a specific auction from the marketplace.\n   *\n   * @example\n   * ```javascript\n   * // The auction ID of the asset you want to buy\n   * const auctionId = 0;\n   *\n   * await contract.englishAuctions.buyoutAuction(auctionId);\n   * ```\n   */\n  async buyoutAuction(auctionId) {\n    const auction = await this.validateAuction(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auctionId));\n    const currencyMetadata = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b7)(this.contractWrapper.getProvider(), auction.currencyContractAddress);\n    return this.makeBid(auctionId, ethers__WEBPACK_IMPORTED_MODULE_69__.ethers.utils.formatUnits(auction.buyoutBidAmount, currencyMetadata.decimals));\n  }\n\n  /**\n   * Bid On Auction\n   *\n   * @remarks Make a bid on an auction\n   *\n   * @example\n   * ```javascript\n   * // The auction ID of the asset you want to bid on\n   * const auctionId = 0;\n   * // The total amount you are willing to bid for auctioned tokens\n   * const bidAmount = 1;\n   *\n   * await contract.englishAuctions.makeBid(auctionId, bidAmount);\n   * ```\n   */\n  async makeBid(auctionId, bidAmount) {\n    const auction = await this.validateAuction(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auctionId));\n    const normalizedBidAmount = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b8)(this.contractWrapper.getProvider(), bidAmount, auction.currencyContractAddress);\n    if (normalizedBidAmount.eq(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(0))) {\n      throw new Error(\"Cannot make a bid with 0 value\");\n    }\n    if (ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auction.buyoutBidAmount).gt(0) && normalizedBidAmount.gt(auction.buyoutBidAmount)) {\n      throw new Error(\"Bid amount must be less than or equal to buyoutBidAmount\");\n    }\n    const winningBid = await this.getWinningBid(auctionId);\n    if (winningBid) {\n      const isWinnner = await this.isWinningBid(auctionId, normalizedBidAmount);\n      (0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(isWinnner, \"Bid price is too low based on the current winning bid and the bid buffer\");\n    } else {\n      const tokenPrice = normalizedBidAmount;\n      const minimumBidAmount = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auction.minimumBidAmount);\n      (0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(tokenPrice.gte(minimumBidAmount), \"Bid price is too low based on minimum bid amount\");\n    }\n    const overrides = (await this.contractWrapper.getCallOverrides()) || {};\n    await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cU)(this.contractWrapper, normalizedBidAmount, auction.currencyContractAddress, overrides);\n    return {\n      receipt: await this.contractWrapper.sendTransaction(\"bidInAuction\", [auctionId, normalizedBidAmount], overrides)\n    };\n  }\n\n  /**\n   * Cancel Auction\n   *\n   * @remarks Cancel an auction on the marketplace\n   *\n   * @example\n   * ```javascript\n   * // The ID of the auction you want to cancel\n   * const auctionId = \"0\";\n   *\n   * await contract.englishAuctions.cancelAuction(auctionId);\n   * ```\n   */\n  async cancelAuction(auctionId) {\n    const winningBid = await this.getWinningBid(auctionId);\n    if (winningBid) {\n      throw new Error(`Bids already made.`);\n    }\n    return {\n      receipt: await this.contractWrapper.sendTransaction(\"cancelAuction\", [auctionId])\n    };\n  }\n\n  /**\n   * Close the Auction for the buyer\n   *\n   * @remarks Closes the Auction and executes the sale for the buyer.\n   *\n   * @example\n   * ```javascript\n   * // The ID of the auction you want to close\n   * const auction = \"0\";\n   * await contract.englishAuctions.closeAuctionForBidder(auctionId);\n   * ```\n   *\n   * @param auctionId - the auction id to close\n   * @param closeFor - optionally pass the winning bid offeror address to close the auction on their behalf\n   */\n  async closeAuctionForBidder(auctionId, closeFor) {\n    if (!closeFor) {\n      closeFor = await this.contractWrapper.getSignerAddress();\n    }\n    const auction = await this.validateAuction(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auctionId));\n    try {\n      return {\n        receipt: await this.contractWrapper.sendTransaction(\"collectAuctionTokens\", [ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auctionId)])\n      };\n    } catch (err) {\n      if (err.message.includes(\"Marketplace: auction still active.\")) {\n        throw new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.bt(auctionId.toString(), auction.endTimeInSeconds.toString());\n      } else {\n        throw err;\n      }\n    }\n  }\n\n  /**\n   * Close the Auction for the seller, i.e. the auction creator\n   *\n   * @remarks Closes the Auction and executes the sale for the seller.\n   *\n   * @example\n   * ```javascript\n   * // The ID of the auction you want to close\n   * const auctionId = \"0\";\n   * await contract.englishAuctions.closeAuctionForSeller(auctionId);\n   * ```\n   *\n   * @param auctionId - the auction id to close\n   */\n  async closeAuctionForSeller(auctionId) {\n    const auction = await this.validateAuction(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auctionId));\n    try {\n      return {\n        receipt: await this.contractWrapper.sendTransaction(\"collectAuctionPayout\", [ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auctionId)])\n      };\n    } catch (err) {\n      if (err.message.includes(\"Marketplace: auction still active.\")) {\n        throw new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.bt(auctionId.toString(), auction.endTimeInSeconds.toString());\n      } else {\n        throw err;\n      }\n    }\n  }\n\n  /**\n   * Execute the Auction Sale\n   *\n   * @remarks Closes the Auction and executes the sale for both parties.\n   *\n   * @example\n   * ```javascript\n   * // The ID of the auction you want to close\n   * const auction = \"0\";\n   * await contract.englishAuctions.executeSale(auctionId);\n   * ```\n   *\n   * @param auctionId - the auction to close\n   */\n  async executeSale(auctionId) {\n    const auction = await this.validateAuction(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auctionId));\n    try {\n      const winningBid = await this.getWinningBid(auctionId);\n      (0,tiny_invariant__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(winningBid, \"No winning bid found\");\n      const closeForSeller = this.encoder.encode(\"collectAuctionPayout\", [auctionId]);\n      const closeForBuyer = this.encoder.encode(\"collectAuctionTokens\", [auctionId]);\n      return await this.contractWrapper.multiCall([closeForSeller, closeForBuyer]);\n    } catch (err) {\n      if (err.message.includes(\"Marketplace: auction still active.\")) {\n        throw new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.bt(auctionId.toString(), auction.endTimeInSeconds.toString());\n      } else {\n        throw err;\n      }\n    }\n  }\n\n  /**\n   * Get the buffer in basis points between bids for an auction.\n   *\n   * @param auctionId - id of the auction\n   */\n  async getBidBufferBps(auctionId) {\n    return (await this.getAuction(auctionId)).bidBufferBps;\n  }\n\n  /**\n   * returns the minimum bid a user can place to outbid the previous highest bid\n   * @param auctionId - id of the auction\n   */\n  async getMinimumNextBid(auctionId) {\n    // we can fetch all of these at the same time using promise.all\n    const [currentBidBufferBps, winningBid, auction] = await Promise.all([this.getBidBufferBps(auctionId), this.getWinningBid(auctionId), await this.validateAuction(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auctionId))]);\n    const currentBidOrReservePrice = winningBid ?\n    // if there is a winning bid use the value of it\n    ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(winningBid.bidAmount) :\n    // if there is no winning bid use the reserve price\n    ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auction.minimumBidAmount);\n    const minimumNextBid = currentBidOrReservePrice.add(\n    // the addition of the current bid and the buffer\n    // (have to divide by 10000 to get the fraction of the buffer (since it's in basis points))\n    currentBidOrReservePrice.mul(currentBidBufferBps).div(10000));\n\n    // it's more useful to return a currency value here\n    return (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b6)(this.contractWrapper.getProvider(), auction.currencyContractAddress, minimumNextBid);\n  }\n\n  /** ******************************\n   * PRIVATE FUNCTIONS\n   *******************************/\n\n  /**\n   * Throws error if auction could not be found\n   *\n   * @param auctionId - Auction to check for\n   */\n  async validateAuction(auctionId) {\n    try {\n      return await this.getAuction(auctionId);\n    } catch (err) {\n      console.error(`Error getting the auction with id ${auctionId}`);\n      throw err;\n    }\n  }\n\n  /**\n   * Helper method maps the auction to the auction interface.\n   *\n   * @internal\n   * @param auction - The auction to map, as returned from the contract.\n   * @returns - The mapped interface.\n   */\n  async mapAuction(auction) {\n    let status = _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.UNSET;\n    const block = await this.contractWrapper.getProvider().getBlock(\"latest\");\n    const blockTime = block.timestamp;\n    switch (auction.status) {\n      case 1:\n        status = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auction.startTimestamp).gt(blockTime) ? _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Created : ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auction.endTimestamp).lt(blockTime) ? _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Expired : _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Active;\n        break;\n      case 2:\n        status = _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Completed;\n        break;\n      case 3:\n        status = _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Cancelled;\n        break;\n    }\n    return {\n      id: auction.auctionId.toString(),\n      creatorAddress: auction.auctionCreator,\n      assetContractAddress: auction.assetContract,\n      tokenId: auction.tokenId.toString(),\n      quantity: auction.quantity.toString(),\n      currencyContractAddress: auction.currency,\n      minimumBidAmount: auction.minimumBidAmount.toString(),\n      minimumBidCurrencyValue: await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b6)(this.contractWrapper.getProvider(), auction.currency, auction.minimumBidAmount),\n      buyoutBidAmount: auction.buyoutBidAmount.toString(),\n      buyoutCurrencyValue: await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b6)(this.contractWrapper.getProvider(), auction.currency, auction.buyoutBidAmount),\n      timeBufferInSeconds: ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auction.timeBufferInSeconds).toNumber(),\n      bidBufferBps: ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auction.bidBufferBps).toNumber(),\n      startTimeInSeconds: ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auction.startTimestamp).toNumber(),\n      endTimeInSeconds: ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(auction.endTimestamp).toNumber(),\n      asset: await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cV)(auction.assetContract, this.contractWrapper.getProvider(), auction.tokenId, this.storage),\n      status: status\n    };\n  }\n\n  /**\n   * Maps an auction-bid to the strict interface\n   *\n   * @internal\n   * @param bid\n   * @returns - A `Bid` object\n   */\n  async mapBid(auctionId, bidderAddress, currencyContractAddress, bidAmount) {\n    return {\n      auctionId,\n      bidderAddress,\n      currencyContractAddress,\n      bidAmount,\n      bidAmountCurrencyValue: await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b6)(this.contractWrapper.getProvider(), currencyContractAddress, bidAmount)\n    };\n  }\n  applyFilter(auctions, filter) {\n    let rawAuctions = [...auctions];\n    if (filter) {\n      if (filter.seller) {\n        rawAuctions = rawAuctions.filter(seller => seller.auctionCreator.toString().toLowerCase() === filter?.seller?.toString().toLowerCase());\n      }\n      if (filter.tokenContract) {\n        rawAuctions = rawAuctions.filter(tokenContract => tokenContract.assetContract.toString().toLowerCase() === filter?.tokenContract?.toString().toLowerCase());\n      }\n      if (filter.tokenId !== undefined) {\n        rawAuctions = rawAuctions.filter(tokenContract => tokenContract.tokenId.toString() === filter?.tokenId?.toString());\n      }\n    }\n    return filter?.count && filter.count < rawAuctions.length ? rawAuctions.slice(0, filter.count) : rawAuctions;\n  }\n}\n\n/**\n * @internal\n */\nconst OfferInputParamsSchema = zod__WEBPACK_IMPORTED_MODULE_66__.z.object({\n  /**\n   * The address of the asset being sought.\n   */\n  assetContractAddress: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ad,\n  /**\n   * The ID of the token.\n   */\n  tokenId: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ab,\n  /**\n   * The quantity of tokens to buy.\n   *\n   * For ERC721s, this value should always be 1 (and will be forced internally regardless of what is passed here).\n   */\n  quantity: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ab[\"default\"](1),\n  /**\n   * The address of the currency offered for the NFTs.\n   */\n  currencyContractAddress: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ad[\"default\"](_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cc),\n  /**\n   * The total offer amount for the NFTs.\n   */\n  totalPrice: _QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__.A,\n  /**\n   * The end time of the offer.\n   */\n  endTimestamp: _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ag\n});\n\n/**\n * @public\n */\n\n/**\n * Handles marketplace offers\n * @public\n */\nclass MarketplaceV3Offers {\n  // utilities\n\n  constructor(contractWrapper, storage) {\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"featureName\", _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cY.name);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"contractWrapper\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"storage\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"events\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"interceptor\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"encoder\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"estimator\", void 0);\n    this.contractWrapper = contractWrapper;\n    this.storage = storage;\n    this.events = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aV(this.contractWrapper);\n    this.encoder = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aj(this.contractWrapper);\n    this.interceptor = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aW(this.contractWrapper);\n    this.estimator = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aU(this.contractWrapper);\n  }\n  getAddress() {\n    return this.contractWrapper.readContract.address;\n  }\n\n  /** ******************************\n   * READ FUNCTIONS\n   *******************************/\n\n  /**\n   * Get the total number of offers\n   * @returns Returns the total number of offers created.\n   * @public\n   *\n   * @example\n   * ```javascript\n   * const totalOffers = await contract.offers.getTotalCount();\n   * ```\n   */\n  async getTotalCount() {\n    return await this.contractWrapper.readContract.totalOffers();\n  }\n\n  /**\n   * Get all offers.\n   *\n   * @example\n   * ```javascript\n   * const offers = await contract.offers.getAll();\n   * ```\n   *\n   * @param filter - optional filter parameters\n   * @returns the Offer object array\n   */\n  async getAll(filter) {\n    const totalOffers = await this.getTotalCount();\n    let start = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(filter?.start || 0).toNumber();\n    let end = totalOffers.toNumber();\n    if (end === 0) {\n      throw new Error(`No offers exist on the contract.`);\n    }\n    let rawOffers = [];\n    let batches = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cR)(start, end, this.contractWrapper.readContract.getAllOffers);\n    rawOffers = batches.flat();\n    const filteredOffers = this.applyFilter(rawOffers, filter);\n    return await Promise.all(filteredOffers.map(offer => this.mapOffer(offer)));\n  }\n\n  /**\n   * Get all valid offers.\n   *\n   * @example\n   * ```javascript\n   * const offers = await contract.offers.getAllValid();\n   * ```\n   *\n   * @param filter - optional filter parameters\n   * @returns the Offer object array\n   */\n  async getAllValid(filter) {\n    const totalOffers = await this.getTotalCount();\n    let start = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(filter?.start || 0).toNumber();\n    let end = totalOffers.toNumber();\n    if (end === 0) {\n      throw new Error(`No offers exist on the contract.`);\n    }\n    let rawOffers = [];\n    let batches = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cR)(start, end, this.contractWrapper.readContract.getAllValidOffers);\n    rawOffers = batches.flat();\n    const filteredOffers = this.applyFilter(rawOffers, filter);\n    return await Promise.all(filteredOffers.map(offer => this.mapOffer(offer)));\n  }\n\n  /**\n   * Get a offer by id\n   *\n   * @example\n   * ```javascript\n   * const offerId = 0;\n   * const offer = await contract.offers.getOffer(offerId);\n   * ```\n   *\n   * @param offerId - the listing id\n   * @returns the Direct listing object\n   */\n  async getOffer(offerId) {\n    const offer = await this.contractWrapper.readContract.getOffer(offerId);\n    return await this.mapOffer(offer);\n  }\n\n  /** ******************************\n   * WRITE FUNCTIONS\n   *******************************/\n\n  /**\n   * Make Offer\n   *\n   * @remarks Make an offer on the marketplace for an asset.\n   *\n   * @example\n   * ```javascript\n   * // Data of the offer you want to make\n   * const offer = {\n   *   // address of the contract the asset you want to make an offer for\n   *   assetContractAddress: \"0x...\",\n   *   // token ID of the asset you want to buy\n   *   tokenId: \"0\",\n   *   // how many of the asset you want to buy\n   *   quantity: 1,\n   *   // address of the currency contract that you offer to pay in\n   *   currencyContractAddress: NATIVE_TOKEN_ADDRESS,\n   *   // Total price you offer to pay for the mentioned token(s)\n   *   totalPrice: \"1.5\",\n   *   // Offer valid until\n   *   endTimestamp: new Date(),\n   * }\n   *\n   * const tx = await contract.offers.makeOffer(offer);\n   * const receipt = tx.receipt; // the transaction receipt\n   * const id = tx.id; // the id of the newly created offer\n   * ```\n   */\n  async makeOffer(offer) {\n    const parsedOffer = OfferInputParamsSchema.parse(offer);\n    const chainId = await this.contractWrapper.getChainID();\n    const currency = (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cP)(parsedOffer.currencyContractAddress) ? _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cd[chainId].wrapped.address : parsedOffer.currencyContractAddress;\n    const normalizedTotalPrice = await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b8)(this.contractWrapper.getProvider(), parsedOffer.totalPrice, currency);\n    const overrides = await this.contractWrapper.getCallOverrides();\n    await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cU)(this.contractWrapper, normalizedTotalPrice, currency, overrides);\n    const receipt = await this.contractWrapper.sendTransaction(\"makeOffer\", [{\n      assetContract: parsedOffer.assetContractAddress,\n      tokenId: parsedOffer.tokenId,\n      quantity: parsedOffer.quantity,\n      currency: currency,\n      totalPrice: normalizedTotalPrice,\n      expirationTimestamp: parsedOffer.endTimestamp\n    }], {\n      // Higher gas limit for create listing\n      gasLimit: 500000\n    });\n    const event = this.contractWrapper.parseLogs(\"NewOffer\", receipt?.logs);\n    return {\n      id: event[0].args.offerId,\n      receipt\n    };\n  }\n\n  /**\n   * Cancel Offer\n   *\n   * @remarks Cancel an offer on the marketplace\n   *\n   * @example\n   * ```javascript\n   * // The ID of the offer you want to cancel\n   * const offerId = \"0\";\n   *\n   * await contract.offers.cancelOffer(offerId);\n   * ```\n   */\n  async cancelOffer(offerId) {\n    return {\n      receipt: await this.contractWrapper.sendTransaction(\"cancelOffer\", [offerId])\n    };\n  }\n\n  /**\n   * Accept an offer\n   *\n   * @example\n   * ```javascript\n   * // The ID of the offer you want to accept\n   * const offerId = 0;\n   *\n   * await contract.offers.acceptOffer(offerId);\n   * ```\n   *\n   * @param offerId - The offer id\n   */\n  async acceptOffer(offerId) {\n    const offer = await this.validateOffer(ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(offerId));\n    const {\n      valid,\n      error\n    } = await this.isStillValidOffer(offer);\n    if (!valid) {\n      throw new Error(`Offer ${offerId} is no longer valid. ${error}`);\n    }\n    const overrides = (await this.contractWrapper.getCallOverrides()) || {};\n    await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cS)(this.contractWrapper, this.getAddress(), offer.assetContractAddress, offer.tokenId, await this.contractWrapper.getSignerAddress());\n    return {\n      receipt: await this.contractWrapper.sendTransaction(\"acceptOffer\", [offerId], overrides)\n    };\n  }\n\n  /** ******************************\n   * PRIVATE FUNCTIONS\n   *******************************/\n\n  /**\n   * Throws error if offer could not be found\n   *\n   * @param offerId - offer to check for\n   */\n  async validateOffer(offerId) {\n    try {\n      return await this.getOffer(offerId);\n    } catch (err) {\n      console.error(`Error getting the offer with id ${offerId}`);\n      throw err;\n    }\n  }\n\n  /**\n   * Helper method maps the offer to the offer interface.\n   *\n   * @internal\n   * @param offer - The offer to map, as returned from the contract.\n   * @returns - The mapped interface.\n   */\n  async mapOffer(offer) {\n    let status = _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.UNSET;\n    const block = await this.contractWrapper.getProvider().getBlock(\"latest\");\n    const blockTime = block.timestamp;\n    switch (offer.status) {\n      case 1:\n        status = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(offer.expirationTimestamp).lt(blockTime) ? _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Expired : _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Active;\n        break;\n      case 2:\n        status = _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Completed;\n        break;\n      case 3:\n        status = _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b2.Cancelled;\n        break;\n    }\n    return {\n      id: offer.offerId.toString(),\n      offerorAddress: offer.offeror,\n      assetContractAddress: offer.assetContract,\n      currencyContractAddress: offer.currency,\n      tokenId: offer.tokenId.toString(),\n      quantity: offer.quantity.toString(),\n      totalPrice: offer.totalPrice.toString(),\n      currencyValue: await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.b6)(this.contractWrapper.getProvider(), offer.currency, offer.totalPrice),\n      asset: await (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cV)(offer.assetContract, this.contractWrapper.getProvider(), offer.tokenId, this.storage),\n      endTimeInSeconds: ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(offer.expirationTimestamp).toNumber(),\n      status: status\n    };\n  }\n\n  /**\n   * Use this method to check if an offer is still valid.\n   *\n   * Ways an offer can become invalid:\n   * 1. The offer has expired\n   * 2. The offeror doesn't have enough balance of currency tokens\n   * 3. The offeror removed the approval of currency tokens on the marketplace\n   *\n   * @internal\n   * @param offer - The offer to check.\n   * @returns - True if the offer is valid, false otherwise.\n   */\n  async isStillValidOffer(offer) {\n    const now = ethers__WEBPACK_IMPORTED_MODULE_69__.BigNumber.from(Math.floor(Date.now() / 1000));\n    if (now.gt(offer.endTimeInSeconds)) {\n      return {\n        valid: false,\n        error: `Offer with ID ${offer.id} has expired`\n      };\n    }\n    const chainId = await this.contractWrapper.getChainID();\n    const currency = (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cP)(offer.currencyContractAddress) ? _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cd[chainId].wrapped.address : offer.currencyContractAddress;\n    const provider = this.contractWrapper.getProvider();\n    const erc20 = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cK(provider, currency, _thirdweb_dev_contracts_js_dist_abis_IERC20_json__WEBPACK_IMPORTED_MODULE_4__, {});\n    const offerorBalance = await erc20.readContract.balanceOf(offer.offerorAddress);\n    if (offerorBalance.lt(offer.totalPrice)) {\n      return {\n        valid: false,\n        error: `Offeror ${offer.offerorAddress} doesn't have enough balance of token ${currency}`\n      };\n    }\n    const offerorAllowance = await erc20.readContract.allowance(offer.offerorAddress, this.getAddress());\n    if (offerorAllowance.lt(offer.totalPrice)) {\n      return {\n        valid: false,\n        error: `Offeror ${offer.offerorAddress} hasn't approved enough amount of token ${currency}`\n      };\n    }\n    return {\n      valid: true,\n      error: \"\"\n    };\n  }\n  applyFilter(offers, filter) {\n    let rawOffers = [...offers];\n    if (filter) {\n      if (filter.offeror) {\n        rawOffers = rawOffers.filter(offeror => offeror.offeror.toString().toLowerCase() === filter?.offeror?.toString().toLowerCase());\n      }\n      if (filter.tokenContract) {\n        rawOffers = rawOffers.filter(tokenContract => tokenContract.assetContract.toString().toLowerCase() === filter?.tokenContract?.toString().toLowerCase());\n      }\n      if (filter.tokenId !== undefined) {\n        rawOffers = rawOffers.filter(tokenContract => tokenContract.tokenId.toString() === filter?.tokenId?.toString());\n      }\n    }\n    return filter?.count && filter.count < rawOffers.length ? rawOffers.slice(0, filter.count) : rawOffers;\n  }\n}\n\n/**\n * Create your own whitelabel marketplace that enables users to buy and sell any digital assets.\n *\n * @example\n *\n * ```javascript\n * import { ThirdwebSDK } from \"@thirdweb-dev/sdk\";\n *\n * const sdk = new ThirdwebSDK(\"{{chainName}}\");\n * const contract = await sdk.getContract(\"{{contract_address}}\", \"marketplace\");\n * ```\n *\n * @public\n */\nclass MarketplaceV3 {\n  /**\n   * @internal\n   */\n\n  /**\n   * Direct listings\n   * @remarks Create and manage direct listings in your marketplace.\n   * ```javascript\n   * // Data of the listing you want to create\n   * const listing = {\n   *   // address of the contract the asset you want to list is on\n   *   assetContractAddress: \"0x...\",\n   *   // token ID of the asset you want to list\n   *   tokenId: \"0\",\n   *   // how many of the asset you want to list\n   *   quantity: 1,\n   *   // address of the currency contract that will be used to pay for the listing\n   *   currencyContractAddress: NATIVE_TOKEN_ADDRESS,\n   *   // The price to pay per unit of NFTs listed.\n   *   pricePerToken: 1.5,\n   *   // when should the listing open up for offers\n   *   startTimestamp: new Date(Date.now()),\n   *   // how long the listing will be open for\n   *   endTimestamp: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000),\n   *   // Whether the listing is reserved for a specific set of buyers.\n   *   isReservedListing: false\n   * }\n   *\n   * const tx = await contract.directListings.createListing(listing);\n   * const receipt = tx.receipt; // the transaction receipt\n   * const id = tx.id; // the id of the newly created listing\n   *\n   * // And on the buyers side:\n   * // The ID of the listing you want to buy from\n   * const listingId = 0;\n   * // Quantity of the asset you want to buy\n   * const quantityDesired = 1;\n   *\n   * await contract.directListings.buyFromListing(listingId, quantityDesired);\n   * ```\n   */\n  get directListings() {\n    return (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.bX)(this.detectDirectListings(), _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cQ);\n  }\n  /**\n   * Auctions\n   * @remarks Create and manage auctions in your marketplace.\n   * @example\n   * ```javascript\n   * // Data of the auction you want to create\n   * const auction = {\n   *   // address of the contract of the asset you want to auction\n   *   assetContractAddress: \"0x...\",\n   *   // token ID of the asset you want to auction\n   *   tokenId: \"0\",\n   *   // how many of the asset you want to auction\n   *   quantity: 1,\n   *   // address of the currency contract that will be used to pay for the auctioned tokens\n   *   currencyContractAddress: NATIVE_TOKEN_ADDRESS,\n   *   // the minimum bid that will be accepted for the token\n   *   minimumBidAmount: \"1.5\",\n   *   // how much people would have to bid to instantly buy the asset\n   *   buyoutBidAmount: \"10\",\n   *   // If a bid is made less than these many seconds before expiration, the expiration time is increased by this.\n   *   timeBufferInSeconds: \"1000\",\n   *   // A bid must be at least this much bps greater than the current winning bid\n   *   bidBufferBps: \"100\", // 100 bps stands for 1%\n   *   // when should the auction open up for bidding\n   *   startTimestamp: new Date(Date.now()),\n   *   // end time of auction\n   *   endTimestamp: new Date(Date.now() + 5 * 24 * 60 * 60 * 1000),\n   * }\n   *\n   * const tx = await contract.englishAuctions.createAuction(auction);\n   * const receipt = tx.receipt; // the transaction receipt\n   * const id = tx.id; // the id of the newly created auction\n   *\n   * // And on the buyers side:\n   * // The auction ID of the asset you want to bid on\n   * const auctionId = 0;\n   * // The total amount you are willing to bid for auctioned tokens\n   * const bidAmount = 1;\n   *\n   * await contract.englishAuctions.makeBid(auctionId, bidAmount);\n   * ```\n   */\n  get englishAuctions() {\n    return (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.bX)(this.detectEnglishAuctions(), _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cX);\n  }\n\n  /**\n   * Offers\n   * @remarks Make and manage offers.\n   * @example\n   * ```javascript\n   * // Data of the offer you want to make\n   * const offer = {\n   *   // address of the contract the asset you want to make an offer for\n   *   assetContractAddress: \"0x...\",\n   *   // token ID of the asset you want to buy\n   *   tokenId: \"0\",\n   *   // how many of the asset you want to buy\n   *   quantity: 1,\n   *   // address of the currency contract that you offer to pay in\n   *   currencyContractAddress: NATIVE_TOKEN_ADDRESS,\n   *   // Total price you offer to pay for the mentioned token(s)\n   *   totalPrice: \"1.5\",\n   *   // Offer valid until\n   *   endTimestamp: new Date(),\n   * }\n   *\n   * const tx = await contract.offers.makeOffer(offer);\n   * const receipt = tx.receipt; // the transaction receipt\n   * const id = tx.id; // the id of the newly created offer\n   *\n   * // And on the seller's side:\n   * // The ID of the offer you want to accept\n   * const offerId = 0;\n   * await contract.offers.acceptOffer(offerId);\n   * ```\n   */\n  get offers() {\n    return (0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.bX)(this.detectOffers(), _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cY);\n  }\n  get chainId() {\n    return this._chainId;\n  }\n  constructor(network, address, storage) {\n    let options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    let abi = arguments.length > 4 ? arguments[4] : undefined;\n    let chainId = arguments.length > 5 ? arguments[5] : undefined;\n    let contractWrapper = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cK(network, address, abi, options);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"abi\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"contractWrapper\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"storage\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"encoder\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"events\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"estimator\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"platformFees\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"metadata\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"roles\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"interceptor\", void 0);\n    (0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(this, \"_chainId\", void 0);\n    this._chainId = chainId;\n    this.abi = abi;\n    this.contractWrapper = contractWrapper;\n    this.storage = storage;\n    this.metadata = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.ak(this.contractWrapper, _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.cN, this.storage);\n    this.roles = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.al(this.contractWrapper, MarketplaceV3.contractRoles);\n    this.encoder = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aj(this.contractWrapper);\n    this.estimator = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aU(this.contractWrapper);\n    this.events = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aV(this.contractWrapper);\n    this.platformFees = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aX(this.contractWrapper);\n    this.interceptor = new _thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.aW(this.contractWrapper);\n  }\n  onNetworkUpdated(network) {\n    this.contractWrapper.updateSignerOrProvider(network);\n  }\n  getAddress() {\n    return this.contractWrapper.readContract.address;\n  }\n\n  /**\n   * @internal\n   */\n  async call(functionName) {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n    return this.contractWrapper.call(functionName, ...args);\n  }\n\n  /** ********************\n   * FEATURE DETECTION\n   * ********************/\n\n  detectDirectListings() {\n    if ((0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.bY)(this.contractWrapper, \"DirectListings\")) {\n      return new MarketplaceV3DirectListings(this.contractWrapper, this.storage);\n    }\n    return undefined;\n  }\n  detectEnglishAuctions() {\n    if ((0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.bY)(this.contractWrapper, \"EnglishAuctions\")) {\n      return new MarketplaceV3EnglishAuctions(this.contractWrapper, this.storage);\n    }\n    return undefined;\n  }\n  detectOffers() {\n    if ((0,_thirdweb_checkout_33f13955_esm_js__WEBPACK_IMPORTED_MODULE_67__.bY)(this.contractWrapper, \"Offers\")) {\n      return new MarketplaceV3Offers(this.contractWrapper, this.storage);\n    }\n    return undefined;\n  }\n}\n(0,_QueryParams_da88d27c_esm_js__WEBPACK_IMPORTED_MODULE_68__._)(MarketplaceV3, \"contractRoles\", [\"admin\", \"lister\", \"asset\"]);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvQHRoaXJkd2ViLWRldi9zZGsvZGlzdC9tYXJrZXRwbGFjZXYzLTRiN2I5Mzc2LmVzbS5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXdGO0FBQ3UwQjtBQUN2NEI7QUFDa0Q7QUFDQTtBQUNFO0FBQ1o7QUFDekI7QUFDaUM7QUFDekQ7QUFDbUQ7QUFDVDtBQUNRO0FBQ0c7QUFDRztBQUNMO0FBQ0o7QUFDUztBQUNKO0FBQ0M7QUFDRjtBQUNBO0FBQ0c7QUFDSjtBQUNKO0FBQ007QUFDSztBQUNHO0FBQ1A7QUFDQTtBQUNDO0FBQ1I7QUFDTTtBQUNLO0FBQ0c7QUFDTDtBQUNGO0FBQ0s7QUFDUDtBQUNQO0FBQ1U7QUFDRjtBQUNDO0FBQ1Q7QUFDTztBQUNGO0FBQ1U7QUFDVjtBQUNBO0FBQ0w7QUFDQztBQUNEO0FBQ3RDO0FBQ1M7QUFDUDtBQUNzQztBQUM5QjtBQUNtQztBQUNSO0FBQ1c7QUFDL0M7QUFDRztBQUNYO0FBQ3FEO0FBQ0M7QUFDUTtBQUNmO0FBQ0M7QUFDTztBQUNRO0FBQ0M7QUFDaEU7O0FBRWQ7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLDBDQUFRO0FBQy9DO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixtRUFBYTtBQUNyQztBQUNBO0FBQ0E7QUFDQSxXQUFXLG1FQUFrQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSw4RUFBMEI7QUFDdEM7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLDhFQUFxQixDQUFDLG1FQUFvQjtBQUNyRTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsNERBQVk7QUFDN0I7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDhFQUFxQjtBQUN2QztBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsbUVBQWE7QUFDN0I7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLDJDQUFTO0FBQzlCLENBQUM7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dEMseUJBQXlCLG1FQUFnQjtBQUN6QyxzQkFBc0IsbUVBQWM7QUFDcEMsNEJBQTRCLG1FQUFtQjtBQUMvQywyQkFBMkIsbUVBQW1CO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkZBQTJGLGFBQWE7QUFDeEc7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsUUFBUSx1RUFBcUI7QUFDN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdUVBQXFCO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVFQUFxQjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0VBQWU7O0FBRVUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vbm9kZV9tb2R1bGVzL0B0aGlyZHdlYi1kZXYvc2RrL2Rpc3QvbWFya2V0cGxhY2V2My00YjdiOTM3Ni5lc20uanM/MGUwYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBIGFzIEFtb3VudFNjaGVtYSwgXyBhcyBfZGVmaW5lUHJvcGVydHkgfSBmcm9tICcuL1F1ZXJ5UGFyYW1zLWRhODhkMjdjLmVzbS5qcyc7XG5pbXBvcnQgeyBhZCBhcyBBZGRyZXNzU2NoZW1hLCBhYiBhcyBCaWdOdW1iZXJpc2hTY2hlbWEsIGNjIGFzIE5BVElWRV9UT0tFTl9BRERSRVNTLCBhZSBhcyBSYXdEYXRlU2NoZW1hLCBhZyBhcyBFbmREYXRlU2NoZW1hLCBjUSBhcyBGRUFUVVJFX0RJUkVDVF9MSVNUSU5HUywgYVYgYXMgQ29udHJhY3RFdmVudHMsIGFqIGFzIENvbnRyYWN0RW5jb2RlciwgYVcgYXMgQ29udHJhY3RJbnRlcmNlcHRvciwgYVUgYXMgR2FzQ29zdEVzdGltYXRvciwgY1IgYXMgZ2V0QWxsSW5CYXRjaGVzLCBjUyBhcyBoYW5kbGVUb2tlbkFwcHJvdmFsLCBiOCBhcyBub3JtYWxpemVQcmljZVZhbHVlLCBjVCBhcyBjbGVhbkN1cnJlbmN5QWRkcmVzcywgY1UgYXMgc2V0RXJjMjBBbGxvd2FuY2UsIGIyIGFzIFN0YXR1cywgYjYgYXMgZmV0Y2hDdXJyZW5jeVZhbHVlLCBjViBhcyBmZXRjaFRva2VuTWV0YWRhdGFGb3JDb250cmFjdCwgY1cgYXMgaXNUb2tlbkFwcHJvdmVkRm9yVHJhbnNmZXIsIGNhIGFzIEludGVyZmFjZUlkX0lFUkM3MjEsIGNiIGFzIEludGVyZmFjZUlkX0lFUkMxMTU1LCBjWCBhcyBGRUFUVVJFX0VOR0xJU0hfQVVDVElPTlMsIGI3IGFzIGZldGNoQ3VycmVuY3lNZXRhZGF0YSwgYnQgYXMgQXVjdGlvbkhhc05vdEVuZGVkRXJyb3IsIGNZIGFzIEZFQVRVUkVfT0ZGRVJTLCBjUCBhcyBpc05hdGl2ZVRva2VuLCBjZCBhcyBOQVRJVkVfVE9LRU5TLCBjSyBhcyBDb250cmFjdFdyYXBwZXIsIGJYIGFzIGFzc2VydEVuYWJsZWQsIGFrIGFzIENvbnRyYWN0TWV0YWRhdGEsIGNOIGFzIE1hcmtldHBsYWNlQ29udHJhY3RTY2hlbWEsIGFsIGFzIENvbnRyYWN0Um9sZXMsIGFYIGFzIENvbnRyYWN0UGxhdGZvcm1GZWUsIGJZIGFzIGRldGVjdENvbnRyYWN0RmVhdHVyZSB9IGZyb20gJy4vdGhpcmR3ZWItY2hlY2tvdXQtMzNmMTM5NTUuZXNtLmpzJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuaW1wb3J0IEVSQzE2NUFiaSBmcm9tICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSUVSQzE2NS5qc29uJztcbmltcG9ydCBFcmM3MjFBYmkgZnJvbSAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lFUkM3MjEuanNvbic7XG5pbXBvcnQgRXJjMTE1NUFiaSBmcm9tICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSUVSQzExNTUuanNvbic7XG5pbXBvcnQgeyBCaWdOdW1iZXIsIENvbnRyYWN0LCBjb25zdGFudHMsIGV0aGVycyB9IGZyb20gJ2V0aGVycyc7XG5pbXBvcnQgaW52YXJpYW50IGZyb20gJ3RpbnktaW52YXJpYW50JztcbmltcG9ydCBFUkMyMEFiaSBmcm9tICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSUVSQzIwLmpzb24nO1xuaW1wb3J0ICdibi5qcyc7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JQnVybmFibGVFUkMyMC5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lEcm9wLmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSURyb3BFUkMyMF9WMi5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lEcm9wU2luZ2xlUGhhc2UuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JRHJvcFNpbmdsZVBoYXNlX1YxLmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSU1pbnRhYmxlRVJDMjAuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JTXVsdGljYWxsLmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSVNpZ25hdHVyZU1pbnRFUkMyMC5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lCdXJuYWJsZUVSQzcyMS5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lDbGFpbWFibGVFUkM3MjEuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JRGVsYXllZFJldmVhbC5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lEcm9wRVJDNzIxX1YzLmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSUVSQzcyMUVudW1lcmFibGUuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JRVJDNzIxU3VwcGx5Lmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSUxhenlNaW50Lmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSU1pbnRhYmxlRVJDNzIxLmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSVNpZ25hdHVyZU1pbnRFUkM3MjEuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JU2lnbmF0dXJlTWludEVSQzcyMV9WMS5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0xhenlNaW50V2l0aFRpZXIuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JQnVybmFibGVFUkMxMTU1Lmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSUNsYWltYWJsZUVSQzExNTUuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JRHJvcDExNTUuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JRHJvcEVSQzExNTVfVjIuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JRHJvcFNpbmdsZVBoYXNlMTE1NS5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lEcm9wU2luZ2xlUGhhc2UxMTU1X1YxLmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSUVSQzExNTVFbnVtZXJhYmxlLmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSU1pbnRhYmxlRVJDMTE1NS5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lTaWduYXR1cmVNaW50RVJDMTE1NS5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0VSQzI3NzFDb250ZXh0Lmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSUFwcFVSSS5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lDb250cmFjdE1ldGFkYXRhLmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSURpcmVjdExpc3RpbmdzLmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSUVuZ2xpc2hBdWN0aW9ucy5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lPZmZlcnMuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JUGFja1ZSRkRpcmVjdC5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lQZXJtaXNzaW9ucy5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lQZXJtaXNzaW9uc0VudW1lcmFibGUuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JUGxhdGZvcm1GZWUuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JUHJpbWFyeVNhbGUuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JUm91dGVyLmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvSVJveWFsdHkuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9Pd25hYmxlLmpzb24nO1xuaW1wb3J0ICdjcm9zcy1mZXRjaCc7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY2hhaW5zJztcbmltcG9ydCAnZXZlbnRlbWl0dGVyMyc7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9Gb3J3YXJkZXIuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvc3RvcmFnZSc7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JRVJDMjBNZXRhZGF0YS5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL1JvdXRlci5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lUaGlyZHdlYkNvbnRyYWN0Lmpzb24nO1xuaW1wb3J0ICdtZXJrbGV0cmVlanMnO1xuaW1wb3J0ICdmYXN0LWRlZXAtZXF1YWwnO1xuaW1wb3J0ICd1dWlkJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lFUkM3MjFNZXRhZGF0YS5qc29uJztcbmltcG9ydCAnQHRoaXJkd2ViLWRldi9jb250cmFjdHMtanMvZGlzdC9hYmlzL0lFUkMxMTU1TWV0YWRhdGEuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9JRGVsYXllZFJldmVhbERlcHJlY2F0ZWQuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9UV0ZhY3RvcnkuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9UV1JlZ2lzdHJ5Lmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvQ29udHJhY3RQdWJsaXNoZXIuanNvbic7XG5pbXBvcnQgJ0B0aGlyZHdlYi1kZXYvY29udHJhY3RzLWpzL2Rpc3QvYWJpcy9UV011bHRpY2hhaW5SZWdpc3RyeUxvZ2ljLmpzb24nO1xuaW1wb3J0ICdAdGhpcmR3ZWItZGV2L2NvbnRyYWN0cy1qcy9kaXN0L2FiaXMvVFdNdWx0aWNoYWluUmVnaXN0cnlSb3V0ZXIuanNvbic7XG5pbXBvcnQgJ2JzNTgnO1xuXG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5jb25zdCBEaXJlY3RMaXN0aW5nSW5wdXRQYXJhbXNTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIC8qKlxuICAgKiBUaGUgYWRkcmVzcyBvZiB0aGUgYXNzZXQgYmVpbmcgbGlzdGVkLlxuICAgKi9cbiAgYXNzZXRDb250cmFjdEFkZHJlc3M6IEFkZHJlc3NTY2hlbWEsXG4gIC8qKlxuICAgKiBUaGUgSUQgb2YgdGhlIHRva2VuIHRvIGxpc3QuXG4gICAqL1xuICB0b2tlbklkOiBCaWdOdW1iZXJpc2hTY2hlbWEsXG4gIC8qKlxuICAgKiBUaGUgcXVhbnRpdHkgb2YgdG9rZW5zIHRvIGluY2x1ZGUgaW4gdGhlIGxpc3RpbmcuXG4gICAqXG4gICAqIEZvciBFUkM3MjFzLCB0aGlzIHZhbHVlIHNob3VsZCBhbHdheXMgYmUgMSAoYW5kIHdpbGwgYmUgZm9yY2VkIGludGVybmFsbHkgcmVnYXJkbGVzcyBvZiB3aGF0IGlzIHBhc3NlZCBoZXJlKS5cbiAgICovXG4gIHF1YW50aXR5OiBCaWdOdW1iZXJpc2hTY2hlbWEuZGVmYXVsdCgxKSxcbiAgLyoqXG4gICAqIFRoZSBhZGRyZXNzIG9mIHRoZSBjdXJyZW5jeSB0byBhY2NlcHQgZm9yIHRoZSBsaXN0aW5nLlxuICAgKi9cbiAgY3VycmVuY3lDb250cmFjdEFkZHJlc3M6IEFkZHJlc3NTY2hlbWEuZGVmYXVsdChOQVRJVkVfVE9LRU5fQUREUkVTUyksXG4gIC8qKlxuICAgKiBUaGUgcHJpY2UgdG8gcGF5IHBlciB1bml0IG9mIE5GVHMgbGlzdGVkLlxuICAgKi9cbiAgcHJpY2VQZXJUb2tlbjogQW1vdW50U2NoZW1hLFxuICAvKipcbiAgICogVGhlIHN0YXJ0IHRpbWUgb2YgdGhlIGxpc3RpbmcuXG4gICAqL1xuICBzdGFydFRpbWVzdGFtcDogUmF3RGF0ZVNjaGVtYS5kZWZhdWx0KG5ldyBEYXRlKCkpLFxuICAvKipcbiAgICogVGhlIGVuZCB0aW1lIG9mIHRoZSBsaXN0aW5nLlxuICAgKi9cbiAgZW5kVGltZXN0YW1wOiBFbmREYXRlU2NoZW1hLFxuICAvKipcbiAgICogV2hldGhlciB0aGUgbGlzdGluZyBpcyByZXNlcnZlZCB0byBiZSBib3VnaHQgZnJvbSBhIHNwZWNpZmljIHNldCBvZiBidXllcnMuXG4gICAqL1xuICBpc1Jlc2VydmVkTGlzdGluZzogei5ib29sZWFuKCkuZGVmYXVsdChmYWxzZSlcbn0pO1xuXG4vKipcbiAqIEBwdWJsaWNcbiAqL1xuXG4vKipcbiAqIEhhbmRsZXMgZGlyZWN0IGxpc3RpbmdzXG4gKiBAcHVibGljXG4gKi9cbmNsYXNzIE1hcmtldHBsYWNlVjNEaXJlY3RMaXN0aW5ncyB7XG4gIC8vIHV0aWxpdGllc1xuXG4gIGNvbnN0cnVjdG9yKGNvbnRyYWN0V3JhcHBlciwgc3RvcmFnZSkge1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImZlYXR1cmVOYW1lXCIsIEZFQVRVUkVfRElSRUNUX0xJU1RJTkdTLm5hbWUpO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNvbnRyYWN0V3JhcHBlclwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInN0b3JhZ2VcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJldmVudHNcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJpbnRlcmNlcHRvclwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImVuY29kZXJcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJlc3RpbWF0b3JcIiwgdm9pZCAwKTtcbiAgICB0aGlzLmNvbnRyYWN0V3JhcHBlciA9IGNvbnRyYWN0V3JhcHBlcjtcbiAgICB0aGlzLnN0b3JhZ2UgPSBzdG9yYWdlO1xuICAgIHRoaXMuZXZlbnRzID0gbmV3IENvbnRyYWN0RXZlbnRzKHRoaXMuY29udHJhY3RXcmFwcGVyKTtcbiAgICB0aGlzLmVuY29kZXIgPSBuZXcgQ29udHJhY3RFbmNvZGVyKHRoaXMuY29udHJhY3RXcmFwcGVyKTtcbiAgICB0aGlzLmludGVyY2VwdG9yID0gbmV3IENvbnRyYWN0SW50ZXJjZXB0b3IodGhpcy5jb250cmFjdFdyYXBwZXIpO1xuICAgIHRoaXMuZXN0aW1hdG9yID0gbmV3IEdhc0Nvc3RFc3RpbWF0b3IodGhpcy5jb250cmFjdFdyYXBwZXIpO1xuICB9XG4gIGdldEFkZHJlc3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29udHJhY3RXcmFwcGVyLnJlYWRDb250cmFjdC5hZGRyZXNzO1xuICB9XG5cbiAgLyoqICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgKiBSRUFEIEZVTkNUSU9OU1xuICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAvKipcbiAgICogR2V0IHRoZSB0b3RhbCBudW1iZXIgb2YgZGlyZWN0IGxpc3RpbmdzLlxuICAgKiBAcmV0dXJucyBSZXR1cm5zIHRoZSB0b3RhbCBudW1iZXIgb2YgZGlyZWN0IGxpc3RpbmdzIGNyZWF0ZWQuXG4gICAqIEBwdWJsaWNcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiBjb25zdCB0b3RhbExpc3RpbmdzID0gYXdhaXQgY29udHJhY3QuZGlyZWN0TGlzdGluZ3MuZ2V0VG90YWxDb3VudCgpO1xuICAgKiBgYGBcbiAgICovXG4gIGFzeW5jIGdldFRvdGFsQ291bnQoKSB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuY29udHJhY3RXcmFwcGVyLnJlYWRDb250cmFjdC50b3RhbExpc3RpbmdzKCk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFsbCBkaXJlY3QgbGlzdGluZ3MuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGphdmFzY3JpcHRcbiAgICogY29uc3QgbGlzdGluZ3MgPSBhd2FpdCBjb250cmFjdC5kaXJlY3RMaXN0aW5ncy5nZXRBbGwoKTtcbiAgICogY29uc3QgcHJpY2VPZkZpcnN0TGlzdGluZyA9IGxpc3RpbmdzWzBdLnByaWNlO1xuICAgKiBgYGBcbiAgICpcbiAgICogQHBhcmFtIGZpbHRlciAtIG9wdGlvbmFsIGZpbHRlciBwYXJhbWV0ZXJzXG4gICAqIEByZXR1cm5zIHRoZSBEaXJlY3QgbGlzdGluZyBvYmplY3QgYXJyYXlcbiAgICovXG4gIGFzeW5jIGdldEFsbChmaWx0ZXIpIHtcbiAgICBjb25zdCB0b3RhbExpc3RpbmdzID0gYXdhaXQgdGhpcy5nZXRUb3RhbENvdW50KCk7XG4gICAgbGV0IHN0YXJ0ID0gQmlnTnVtYmVyLmZyb20oZmlsdGVyPy5zdGFydCB8fCAwKS50b051bWJlcigpO1xuICAgIGxldCBlbmQgPSB0b3RhbExpc3RpbmdzLnRvTnVtYmVyKCk7XG4gICAgaWYgKGVuZCA9PT0gMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBObyBsaXN0aW5ncyBleGlzdCBvbiB0aGUgY29udHJhY3QuYCk7XG4gICAgfVxuICAgIGxldCByYXdMaXN0aW5ncyA9IFtdO1xuICAgIGxldCBiYXRjaGVzID0gYXdhaXQgZ2V0QWxsSW5CYXRjaGVzKHN0YXJ0LCBlbmQsIHRoaXMuY29udHJhY3RXcmFwcGVyLnJlYWRDb250cmFjdC5nZXRBbGxMaXN0aW5ncyk7XG4gICAgcmF3TGlzdGluZ3MgPSBiYXRjaGVzLmZsYXQoKTtcbiAgICBjb25zdCBmaWx0ZXJlZExpc3RpbmdzID0gdGhpcy5hcHBseUZpbHRlcihyYXdMaXN0aW5ncywgZmlsdGVyKTtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwoZmlsdGVyZWRMaXN0aW5ncy5tYXAobGlzdGluZyA9PiB0aGlzLm1hcExpc3RpbmcobGlzdGluZykpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIHZhbGlkIGRpcmVjdCBsaXN0aW5ncy5cbiAgICpcbiAgICogQSB2YWxpZCBsaXN0aW5nIGlzIHdoZXJlIHRoZSBsaXN0aW5nIGlzIGFjdGl2ZSxcbiAgICogYW5kIHRoZSBjcmVhdG9yIHN0aWxsIG93bnMgJiBoYXMgYXBwcm92ZWQgTWFya2V0cGxhY2UgdG8gdHJhbnNmZXIgdGhlIGxpc3RlZCBORlRzLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIGNvbnN0IGxpc3RpbmdzID0gYXdhaXQgY29udHJhY3QuZGlyZWN0TGlzdGluZ3MuZ2V0QWxsVmFsaWQoKTtcbiAgICogY29uc3QgcHJpY2VPZkZpcnN0TGlzdGluZyA9IGxpc3RpbmdzWzBdLnByaWNlO1xuICAgKiBgYGBcbiAgICpcbiAgICogQHBhcmFtIGZpbHRlciAtIG9wdGlvbmFsIGZpbHRlciBwYXJhbWV0ZXJzXG4gICAqIEByZXR1cm5zIHRoZSBEaXJlY3QgbGlzdGluZyBvYmplY3QgYXJyYXlcbiAgICovXG4gIGFzeW5jIGdldEFsbFZhbGlkKGZpbHRlcikge1xuICAgIGNvbnN0IHRvdGFsTGlzdGluZ3MgPSBhd2FpdCB0aGlzLmdldFRvdGFsQ291bnQoKTtcbiAgICBsZXQgc3RhcnQgPSBCaWdOdW1iZXIuZnJvbShmaWx0ZXI/LnN0YXJ0IHx8IDApLnRvTnVtYmVyKCk7XG4gICAgbGV0IGVuZCA9IHRvdGFsTGlzdGluZ3MudG9OdW1iZXIoKTtcbiAgICBpZiAoZW5kID09PSAwKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYE5vIGxpc3RpbmdzIGV4aXN0IG9uIHRoZSBjb250cmFjdC5gKTtcbiAgICB9XG4gICAgbGV0IHJhd0xpc3RpbmdzID0gW107XG4gICAgbGV0IGJhdGNoZXMgPSBhd2FpdCBnZXRBbGxJbkJhdGNoZXMoc3RhcnQsIGVuZCwgdGhpcy5jb250cmFjdFdyYXBwZXIucmVhZENvbnRyYWN0LmdldEFsbFZhbGlkTGlzdGluZ3MpO1xuICAgIHJhd0xpc3RpbmdzID0gYmF0Y2hlcy5mbGF0KCk7XG4gICAgY29uc3QgZmlsdGVyZWRMaXN0aW5ncyA9IHRoaXMuYXBwbHlGaWx0ZXIocmF3TGlzdGluZ3MsIGZpbHRlcik7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UuYWxsKGZpbHRlcmVkTGlzdGluZ3MubWFwKGxpc3RpbmcgPT4gdGhpcy5tYXBMaXN0aW5nKGxpc3RpbmcpKSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgZGlyZWN0IGxpc3RpbmcgYnkgaWQuXG4gICAqXG4gICAqIEBwYXJhbSBsaXN0aW5nSWQgLSB0aGUgbGlzdGluZyBpZFxuICAgKiBAcmV0dXJucyB0aGUgRGlyZWN0IGxpc3Rpbmcgb2JqZWN0XG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGphdmFzY3JpcHRcbiAgICogY29uc3QgbGlzdGluZ0lkID0gMDtcbiAgICogY29uc3QgbGlzdGluZyA9IGF3YWl0IGNvbnRyYWN0LmRpcmVjdExpc3RpbmdzLmdldExpc3RpbmcobGlzdGluZ0lkKTtcbiAgICogYGBgXG4gICAqL1xuICBhc3luYyBnZXRMaXN0aW5nKGxpc3RpbmdJZCkge1xuICAgIGNvbnN0IGxpc3RpbmcgPSBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5yZWFkQ29udHJhY3QuZ2V0TGlzdGluZyhsaXN0aW5nSWQpO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLm1hcExpc3RpbmcobGlzdGluZyk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2sgd2hldGhlciBhIGJ1eWVyIGlzIGFwcHJvdmVkIGZvciBhIHJlc2VydmVkIGxpc3RpbmcuXG4gICAqXG4gICAqIEBwYXJhbSBsaXN0aW5nSWQgLSB0aGUgbGlzdGluZyBpZFxuICAgKiBAcGFyYW0gYnV5ZXIgLSBidXllciBhZGRyZXNzXG4gICAqL1xuICBhc3luYyBpc0J1eWVyQXBwcm92ZWRGb3JMaXN0aW5nKGxpc3RpbmdJZCwgYnV5ZXIpIHtcbiAgICBjb25zdCBsaXN0aW5nID0gYXdhaXQgdGhpcy52YWxpZGF0ZUxpc3RpbmcoQmlnTnVtYmVyLmZyb20obGlzdGluZ0lkKSk7XG4gICAgaWYgKCFsaXN0aW5nLmlzUmVzZXJ2ZWRMaXN0aW5nKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYExpc3RpbmcgJHtsaXN0aW5nSWR9IGlzIG5vdCBhIHJlc2VydmVkIGxpc3RpbmcuYCk7XG4gICAgfVxuICAgIHJldHVybiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5yZWFkQ29udHJhY3QuaXNCdXllckFwcHJvdmVkRm9yTGlzdGluZyhsaXN0aW5nSWQsIGJ1eWVyKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayB3aGV0aGVyIGEgY3VycmVuY3kgaXMgYXBwcm92ZWQgZm9yIGEgbGlzdGluZy5cbiAgICpcbiAgICogQHBhcmFtIGxpc3RpbmdJZCAtIHRoZSBsaXN0aW5nIGlkXG4gICAqIEBwYXJhbSBjdXJyZW5jeSAtIGN1cnJlbmN5IGFkZHJlc3NcbiAgICovXG4gIGFzeW5jIGlzQ3VycmVuY3lBcHByb3ZlZEZvckxpc3RpbmcobGlzdGluZ0lkLCBjdXJyZW5jeSkge1xuICAgIGF3YWl0IHRoaXMudmFsaWRhdGVMaXN0aW5nKEJpZ051bWJlci5mcm9tKGxpc3RpbmdJZCkpO1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5yZWFkQ29udHJhY3QuaXNDdXJyZW5jeUFwcHJvdmVkRm9yTGlzdGluZyhsaXN0aW5nSWQsIGN1cnJlbmN5KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBwcmljZSBwZXIgdG9rZW4gZm9yIGFuIGFwcHJvdmVkIGN1cnJlbmN5LlxuICAgKlxuICAgKiBAcGFyYW0gbGlzdGluZ0lkIC0gdGhlIGxpc3RpbmcgaWRcbiAgICogQHBhcmFtIGN1cnJlbmN5Q29udHJhY3RBZGRyZXNzIC0gY3VycmVuY3kgY29udHJhY3QgYWRkcmVzc1xuICAgKi9cbiAgYXN5bmMgY3VycmVuY3lQcmljZUZvckxpc3RpbmcobGlzdGluZ0lkLCBjdXJyZW5jeUNvbnRyYWN0QWRkcmVzcykge1xuICAgIGNvbnN0IGxpc3RpbmcgPSBhd2FpdCB0aGlzLnZhbGlkYXRlTGlzdGluZyhCaWdOdW1iZXIuZnJvbShsaXN0aW5nSWQpKTtcbiAgICBpZiAoY3VycmVuY3lDb250cmFjdEFkZHJlc3MgPT09IGxpc3RpbmcuY3VycmVuY3lDb250cmFjdEFkZHJlc3MpIHtcbiAgICAgIHJldHVybiBsaXN0aW5nLnByaWNlUGVyVG9rZW47XG4gICAgfVxuICAgIGNvbnN0IGlzQXBwcm92ZWRDdXJyZW5jeSA9IGF3YWl0IHRoaXMuaXNDdXJyZW5jeUFwcHJvdmVkRm9yTGlzdGluZyhsaXN0aW5nSWQsIGN1cnJlbmN5Q29udHJhY3RBZGRyZXNzKTtcbiAgICBpZiAoIWlzQXBwcm92ZWRDdXJyZW5jeSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDdXJyZW5jeSAke2N1cnJlbmN5Q29udHJhY3RBZGRyZXNzfSBpcyBub3QgYXBwcm92ZWQgZm9yIExpc3RpbmcgJHtsaXN0aW5nSWR9LmApO1xuICAgIH1cbiAgICByZXR1cm4gYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIucmVhZENvbnRyYWN0LmN1cnJlbmN5UHJpY2VGb3JMaXN0aW5nKGxpc3RpbmdJZCwgY3VycmVuY3lDb250cmFjdEFkZHJlc3MpO1xuICB9XG5cbiAgLyoqICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgKiBXUklURSBGVU5DVElPTlNcbiAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgLyoqXG4gICAqIENyZWF0ZSBEaXJlY3QgTGlzdGluZ1xuICAgKlxuICAgKiBAcmVtYXJrcyBDcmVhdGUgYSBuZXcgbGlzdGluZyBvbiB0aGUgbWFya2V0cGxhY2Ugd2hlcmUgcGVvcGxlIGNhbiBidXkgYW4gYXNzZXQgZGlyZWN0bHkuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGphdmFzY3JpcHRcbiAgICogLy8gRGF0YSBvZiB0aGUgbGlzdGluZyB5b3Ugd2FudCB0byBjcmVhdGVcbiAgICogY29uc3QgbGlzdGluZyA9IHtcbiAgICogICAvLyBhZGRyZXNzIG9mIHRoZSBjb250cmFjdCB0aGUgYXNzZXQgeW91IHdhbnQgdG8gbGlzdCBpcyBvblxuICAgKiAgIGFzc2V0Q29udHJhY3RBZGRyZXNzOiBcIjB4Li4uXCIsXG4gICAqICAgLy8gdG9rZW4gSUQgb2YgdGhlIGFzc2V0IHlvdSB3YW50IHRvIGxpc3RcbiAgICogICB0b2tlbklkOiBcIjBcIixcbiAgICogICAvLyBob3cgbWFueSBvZiB0aGUgYXNzZXQgeW91IHdhbnQgdG8gbGlzdFxuICAgKiAgIHF1YW50aXR5OiAxLFxuICAgKiAgIC8vIGFkZHJlc3Mgb2YgdGhlIGN1cnJlbmN5IGNvbnRyYWN0IHRoYXQgd2lsbCBiZSB1c2VkIHRvIHBheSBmb3IgdGhlIGxpc3RpbmdcbiAgICogICBjdXJyZW5jeUNvbnRyYWN0QWRkcmVzczogTkFUSVZFX1RPS0VOX0FERFJFU1MsXG4gICAqICAgLy8gVGhlIHByaWNlIHRvIHBheSBwZXIgdW5pdCBvZiBORlRzIGxpc3RlZC5cbiAgICogICBwcmljZVBlclRva2VuOiAxLjUsXG4gICAqICAgLy8gd2hlbiBzaG91bGQgdGhlIGxpc3Rpbmcgb3BlbiB1cCBmb3Igb2ZmZXJzXG4gICAqICAgc3RhcnRUaW1lc3RhbXA6IG5ldyBEYXRlKERhdGUubm93KCkpLFxuICAgKiAgIC8vIGhvdyBsb25nIHRoZSBsaXN0aW5nIHdpbGwgYmUgb3BlbiBmb3JcbiAgICogICBlbmRUaW1lc3RhbXA6IG5ldyBEYXRlKERhdGUubm93KCkgKyA1ICogMjQgKiA2MCAqIDYwICogMTAwMCksXG4gICAqICAgLy8gV2hldGhlciB0aGUgbGlzdGluZyBpcyByZXNlcnZlZCBmb3IgYSBzcGVjaWZpYyBzZXQgb2YgYnV5ZXJzLlxuICAgKiAgIGlzUmVzZXJ2ZWRMaXN0aW5nOiBmYWxzZVxuICAgKiB9XG4gICAqXG4gICAqIGNvbnN0IHR4ID0gYXdhaXQgY29udHJhY3QuZGlyZWN0TGlzdGluZ3MuY3JlYXRlTGlzdGluZyhsaXN0aW5nKTtcbiAgICogY29uc3QgcmVjZWlwdCA9IHR4LnJlY2VpcHQ7IC8vIHRoZSB0cmFuc2FjdGlvbiByZWNlaXB0XG4gICAqIGNvbnN0IGlkID0gdHguaWQ7IC8vIHRoZSBpZCBvZiB0aGUgbmV3bHkgY3JlYXRlZCBsaXN0aW5nXG4gICAqIGBgYFxuICAgKi9cbiAgYXN5bmMgY3JlYXRlTGlzdGluZyhsaXN0aW5nKSB7XG4gICAgY29uc3QgcGFyc2VkTGlzdGluZyA9IERpcmVjdExpc3RpbmdJbnB1dFBhcmFtc1NjaGVtYS5wYXJzZShsaXN0aW5nKTtcbiAgICBhd2FpdCBoYW5kbGVUb2tlbkFwcHJvdmFsKHRoaXMuY29udHJhY3RXcmFwcGVyLCB0aGlzLmdldEFkZHJlc3MoKSwgcGFyc2VkTGlzdGluZy5hc3NldENvbnRyYWN0QWRkcmVzcywgcGFyc2VkTGlzdGluZy50b2tlbklkLCBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5nZXRTaWduZXJBZGRyZXNzKCkpO1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRQcmljZVBlclRva2VuID0gYXdhaXQgbm9ybWFsaXplUHJpY2VWYWx1ZSh0aGlzLmNvbnRyYWN0V3JhcHBlci5nZXRQcm92aWRlcigpLCBwYXJzZWRMaXN0aW5nLnByaWNlUGVyVG9rZW4sIHBhcnNlZExpc3RpbmcuY3VycmVuY3lDb250cmFjdEFkZHJlc3MpO1xuICAgIGNvbnN0IGJsb2NrID0gYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0UHJvdmlkZXIoKS5nZXRCbG9jayhcImxhdGVzdFwiKTtcbiAgICBjb25zdCBibG9ja1RpbWUgPSBibG9jay50aW1lc3RhbXA7XG4gICAgaWYgKHBhcnNlZExpc3Rpbmcuc3RhcnRUaW1lc3RhbXAubHQoYmxvY2tUaW1lKSkge1xuICAgICAgcGFyc2VkTGlzdGluZy5zdGFydFRpbWVzdGFtcCA9IEJpZ051bWJlci5mcm9tKGJsb2NrVGltZSk7XG4gICAgfVxuICAgIGNvbnN0IHJlY2VpcHQgPSBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5zZW5kVHJhbnNhY3Rpb24oXCJjcmVhdGVMaXN0aW5nXCIsIFt7XG4gICAgICBhc3NldENvbnRyYWN0OiBwYXJzZWRMaXN0aW5nLmFzc2V0Q29udHJhY3RBZGRyZXNzLFxuICAgICAgdG9rZW5JZDogcGFyc2VkTGlzdGluZy50b2tlbklkLFxuICAgICAgcXVhbnRpdHk6IHBhcnNlZExpc3RpbmcucXVhbnRpdHksXG4gICAgICBjdXJyZW5jeTogY2xlYW5DdXJyZW5jeUFkZHJlc3MocGFyc2VkTGlzdGluZy5jdXJyZW5jeUNvbnRyYWN0QWRkcmVzcyksXG4gICAgICBwcmljZVBlclRva2VuOiBub3JtYWxpemVkUHJpY2VQZXJUb2tlbixcbiAgICAgIHN0YXJ0VGltZXN0YW1wOiBwYXJzZWRMaXN0aW5nLnN0YXJ0VGltZXN0YW1wLFxuICAgICAgZW5kVGltZXN0YW1wOiBwYXJzZWRMaXN0aW5nLmVuZFRpbWVzdGFtcCxcbiAgICAgIHJlc2VydmVkOiBwYXJzZWRMaXN0aW5nLmlzUmVzZXJ2ZWRMaXN0aW5nXG4gICAgfV0sIHtcbiAgICAgIC8vIEhpZ2hlciBnYXMgbGltaXQgZm9yIGNyZWF0ZSBsaXN0aW5nXG4gICAgICBnYXNMaW1pdDogNTAwMDAwXG4gICAgfSk7XG4gICAgY29uc3QgZXZlbnQgPSB0aGlzLmNvbnRyYWN0V3JhcHBlci5wYXJzZUxvZ3MoXCJOZXdMaXN0aW5nXCIsIHJlY2VpcHQ/LmxvZ3MpO1xuICAgIHJldHVybiB7XG4gICAgICBpZDogZXZlbnRbMF0uYXJncy5saXN0aW5nSWQsXG4gICAgICByZWNlaXB0XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVcGRhdGUgYSBEaXJlY3QgbGlzdGluZyB3aXRoIG5ldyBtZXRhZGF0YS5cbiAgICpcbiAgICogTm90ZTogY2Fubm90IHVwZGF0ZSBhIGxpc3Rpbmcgd2l0aCBhIG5ldyBxdWFudGl0eSBvZiAwLiBVc2UgYGNhbmNlbERpcmVjdExpc3RpbmdgIHRvIHJlbW92ZSBhIGxpc3RpbmcgaW5zdGVhZC5cbiAgICpcbiAgICogQHBhcmFtIGxpc3RpbmcgLSB0aGUgbmV3IGxpc3RpbmcgaW5mb3JtYXRpb25cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiAvLyBEYXRhIG9mIHRoZSBsaXN0aW5nIHlvdSB3YW50IHRvIHVwZGF0ZVxuICAgKlxuICAgKiBjb25zdCBsaXN0aW5nSWQgPSAwOyAvLyBJRCBvZiB0aGUgbGlzdGluZyB5b3Ugd2FudCB0byB1cGRhdGVcbiAgICpcbiAgICogY29uc3QgbGlzdGluZyA9IHtcbiAgICogICAvLyBhZGRyZXNzIG9mIHRoZSBjb250cmFjdCB0aGUgYXNzZXQgeW91IHdhbnQgdG8gbGlzdCBpcyBvblxuICAgKiAgIGFzc2V0Q29udHJhY3RBZGRyZXNzOiBcIjB4Li4uXCIsIC8vIHNob3VsZCBiZSBzYW1lIGFzIG9yaWdpbmFsIGxpc3RpbmdcbiAgICogICAvLyB0b2tlbiBJRCBvZiB0aGUgYXNzZXQgeW91IHdhbnQgdG8gbGlzdFxuICAgKiAgIHRva2VuSWQ6IFwiMFwiLCAvLyBzaG91bGQgYmUgc2FtZSBhcyBvcmlnaW5hbCBsaXN0aW5nXG4gICAqICAgLy8gaG93IG1hbnkgb2YgdGhlIGFzc2V0IHlvdSB3YW50IHRvIGxpc3RcbiAgICogICBxdWFudGl0eTogMSxcbiAgICogICAvLyBhZGRyZXNzIG9mIHRoZSBjdXJyZW5jeSBjb250cmFjdCB0aGF0IHdpbGwgYmUgdXNlZCB0byBwYXkgZm9yIHRoZSBsaXN0aW5nXG4gICAqICAgY3VycmVuY3lDb250cmFjdEFkZHJlc3M6IE5BVElWRV9UT0tFTl9BRERSRVNTLFxuICAgKiAgIC8vIFRoZSBwcmljZSB0byBwYXkgcGVyIHVuaXQgb2YgTkZUcyBsaXN0ZWQuXG4gICAqICAgcHJpY2VQZXJUb2tlbjogMS41LFxuICAgKiAgIC8vIHdoZW4gc2hvdWxkIHRoZSBsaXN0aW5nIG9wZW4gdXAgZm9yIG9mZmVyc1xuICAgKiAgIHN0YXJ0VGltZXN0YW1wOiBuZXcgRGF0ZShEYXRlLm5vdygpKSwgLy8gY2FuJ3QgY2hhbmdlIHRoaXMgaWYgbGlzdGluZyBhbHJlYWR5IGFjdGl2ZVxuICAgKiAgIC8vIGhvdyBsb25nIHRoZSBsaXN0aW5nIHdpbGwgYmUgb3BlbiBmb3JcbiAgICogICBlbmRUaW1lc3RhbXA6IG5ldyBEYXRlKERhdGUubm93KCkgKyA1ICogMjQgKiA2MCAqIDYwICogMTAwMCksXG4gICAqICAgLy8gV2hldGhlciB0aGUgbGlzdGluZyBpcyByZXNlcnZlZCBmb3IgYSBzcGVjaWZpYyBzZXQgb2YgYnV5ZXJzLlxuICAgKiAgIGlzUmVzZXJ2ZWRMaXN0aW5nOiBmYWxzZVxuICAgKiB9XG4gICAqXG4gICAqIGNvbnN0IHR4ID0gYXdhaXQgY29udHJhY3QuZGlyZWN0TGlzdGluZ3MudXBkYXRlTGlzdGluZyhsaXN0aW5nSWQsIGxpc3RpbmcpO1xuICAgKiBjb25zdCByZWNlaXB0ID0gdHgucmVjZWlwdDsgLy8gdGhlIHRyYW5zYWN0aW9uIHJlY2VpcHRcbiAgICogY29uc3QgaWQgPSB0eC5pZDsgLy8gdGhlIGlkIG9mIHRoZSBuZXdseSBjcmVhdGVkIGxpc3RpbmdcbiAgICogYGBgXG4gICAqL1xuICBhc3luYyB1cGRhdGVMaXN0aW5nKGxpc3RpbmdJZCwgbGlzdGluZykge1xuICAgIGNvbnN0IHBhcnNlZExpc3RpbmcgPSBEaXJlY3RMaXN0aW5nSW5wdXRQYXJhbXNTY2hlbWEucGFyc2UobGlzdGluZyk7XG4gICAgYXdhaXQgaGFuZGxlVG9rZW5BcHByb3ZhbCh0aGlzLmNvbnRyYWN0V3JhcHBlciwgdGhpcy5nZXRBZGRyZXNzKCksIHBhcnNlZExpc3RpbmcuYXNzZXRDb250cmFjdEFkZHJlc3MsIHBhcnNlZExpc3RpbmcudG9rZW5JZCwgYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0U2lnbmVyQWRkcmVzcygpKTtcbiAgICBjb25zdCBub3JtYWxpemVkUHJpY2VQZXJUb2tlbiA9IGF3YWl0IG5vcm1hbGl6ZVByaWNlVmFsdWUodGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0UHJvdmlkZXIoKSwgcGFyc2VkTGlzdGluZy5wcmljZVBlclRva2VuLCBwYXJzZWRMaXN0aW5nLmN1cnJlbmN5Q29udHJhY3RBZGRyZXNzKTtcbiAgICBjb25zdCByZWNlaXB0ID0gYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIuc2VuZFRyYW5zYWN0aW9uKFwidXBkYXRlTGlzdGluZ1wiLCBbbGlzdGluZ0lkLCB7XG4gICAgICBhc3NldENvbnRyYWN0OiBwYXJzZWRMaXN0aW5nLmFzc2V0Q29udHJhY3RBZGRyZXNzLFxuICAgICAgdG9rZW5JZDogcGFyc2VkTGlzdGluZy50b2tlbklkLFxuICAgICAgcXVhbnRpdHk6IHBhcnNlZExpc3RpbmcucXVhbnRpdHksXG4gICAgICBjdXJyZW5jeTogY2xlYW5DdXJyZW5jeUFkZHJlc3MocGFyc2VkTGlzdGluZy5jdXJyZW5jeUNvbnRyYWN0QWRkcmVzcyksXG4gICAgICBwcmljZVBlclRva2VuOiBub3JtYWxpemVkUHJpY2VQZXJUb2tlbixcbiAgICAgIHN0YXJ0VGltZXN0YW1wOiBwYXJzZWRMaXN0aW5nLnN0YXJ0VGltZXN0YW1wLFxuICAgICAgZW5kVGltZXN0YW1wOiBwYXJzZWRMaXN0aW5nLmVuZFRpbWVzdGFtcCxcbiAgICAgIHJlc2VydmVkOiBwYXJzZWRMaXN0aW5nLmlzUmVzZXJ2ZWRMaXN0aW5nXG4gICAgfV0sIHtcbiAgICAgIC8vIEhpZ2hlciBnYXMgbGltaXQgZm9yIGNyZWF0ZSBsaXN0aW5nXG4gICAgICBnYXNMaW1pdDogNTAwMDAwXG4gICAgfSk7XG4gICAgY29uc3QgZXZlbnQgPSB0aGlzLmNvbnRyYWN0V3JhcHBlci5wYXJzZUxvZ3MoXCJVcGRhdGVkTGlzdGluZ1wiLCByZWNlaXB0Py5sb2dzKTtcbiAgICByZXR1cm4ge1xuICAgICAgaWQ6IGV2ZW50WzBdLmFyZ3MubGlzdGluZ0lkLFxuICAgICAgcmVjZWlwdFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2FuY2VsIERpcmVjdCBMaXN0aW5nXG4gICAqXG4gICAqIEByZW1hcmtzIENhbmNlbCBhIGRpcmVjdCBsaXN0aW5nIG9uIHRoZSBtYXJrZXRwbGFjZVxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIC8vIFRoZSBsaXN0aW5nIElEIG9mIHRoZSBkaXJlY3QgbGlzdGluZyB5b3Ugd2FudCB0byBjYW5jZWxcbiAgICogY29uc3QgbGlzdGluZ0lkID0gMDtcbiAgICpcbiAgICogYXdhaXQgY29udHJhY3QuZGlyZWN0TGlzdGluZ3MuY2FuY2VsTGlzdGluZyhsaXN0aW5nSWQpO1xuICAgKiBgYGBcbiAgICovXG4gIGFzeW5jIGNhbmNlbExpc3RpbmcobGlzdGluZ0lkKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHJlY2VpcHQ6IGF3YWl0IHRoaXMuY29udHJhY3RXcmFwcGVyLnNlbmRUcmFuc2FjdGlvbihcImNhbmNlbExpc3RpbmdcIiwgW2xpc3RpbmdJZF0pXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBCdXkgZnJvbSBhIExpc3RpbmdcbiAgICpcbiAgICogQHJlbWFya3MgQnV5IGZyb20gYSBzcGVjaWZpYyBkaXJlY3QgbGlzdGluZyBmcm9tIHRoZSBtYXJrZXRwbGFjZS5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiAvLyBUaGUgSUQgb2YgdGhlIGxpc3RpbmcgeW91IHdhbnQgdG8gYnV5IGZyb21cbiAgICogY29uc3QgbGlzdGluZ0lkID0gMDtcbiAgICogLy8gUXVhbnRpdHkgb2YgdGhlIGFzc2V0IHlvdSB3YW50IHRvIGJ1eVxuICAgKiBjb25zdCBxdWFudGl0eURlc2lyZWQgPSAxO1xuICAgKlxuICAgKiBhd2FpdCBjb250cmFjdC5kaXJlY3RMaXN0aW5ncy5idXlGcm9tTGlzdGluZyhsaXN0aW5nSWQsIHF1YW50aXR5RGVzaXJlZCk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gbGlzdGluZ0lkIC0gVGhlIGxpc3RpbmcgaWQgdG8gYnV5XG4gICAqIEBwYXJhbSBxdWFudGl0eURlc2lyZWQgLSB0aGUgcXVhbnRpdHkgdG8gYnV5XG4gICAqIEBwYXJhbSByZWNlaXZlciAtIG9wdGlvbmFsIHJlY2VpdmVyIG9mIHRoZSBib3VnaHQgbGlzdGluZyBpZiBkaWZmZXJlbnQgZnJvbSB0aGUgY29ubmVjdGVkIHdhbGxldFxuICAgKi9cbiAgYXN5bmMgYnV5RnJvbUxpc3RpbmcobGlzdGluZ0lkLCBxdWFudGl0eURlc2lyZWQsIHJlY2VpdmVyKSB7XG4gICAgY29uc3QgbGlzdGluZyA9IGF3YWl0IHRoaXMudmFsaWRhdGVMaXN0aW5nKEJpZ051bWJlci5mcm9tKGxpc3RpbmdJZCkpO1xuICAgIGNvbnN0IHtcbiAgICAgIHZhbGlkLFxuICAgICAgZXJyb3JcbiAgICB9ID0gYXdhaXQgdGhpcy5pc1N0aWxsVmFsaWRMaXN0aW5nKGxpc3RpbmcsIHF1YW50aXR5RGVzaXJlZCk7XG4gICAgaWYgKCF2YWxpZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBMaXN0aW5nICR7bGlzdGluZ0lkfSBpcyBubyBsb25nZXIgdmFsaWQuICR7ZXJyb3J9YCk7XG4gICAgfVxuICAgIGNvbnN0IGJ1eUZvciA9IHJlY2VpdmVyID8gcmVjZWl2ZXIgOiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5nZXRTaWduZXJBZGRyZXNzKCk7XG4gICAgY29uc3QgcXVhbnRpdHkgPSBCaWdOdW1iZXIuZnJvbShxdWFudGl0eURlc2lyZWQpO1xuICAgIGNvbnN0IHZhbHVlID0gQmlnTnVtYmVyLmZyb20obGlzdGluZy5wcmljZVBlclRva2VuKS5tdWwocXVhbnRpdHkpO1xuICAgIGNvbnN0IG92ZXJyaWRlcyA9IChhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5nZXRDYWxsT3ZlcnJpZGVzKCkpIHx8IHt9O1xuICAgIGF3YWl0IHNldEVyYzIwQWxsb3dhbmNlKHRoaXMuY29udHJhY3RXcmFwcGVyLCB2YWx1ZSwgbGlzdGluZy5jdXJyZW5jeUNvbnRyYWN0QWRkcmVzcywgb3ZlcnJpZGVzKTtcbiAgICByZXR1cm4ge1xuICAgICAgcmVjZWlwdDogYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIuc2VuZFRyYW5zYWN0aW9uKFwiYnV5RnJvbUxpc3RpbmdcIiwgW2xpc3RpbmdJZCwgYnV5Rm9yLCBxdWFudGl0eSwgbGlzdGluZy5jdXJyZW5jeUNvbnRyYWN0QWRkcmVzcywgdmFsdWVdLCBvdmVycmlkZXMpXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBcHByb3ZlIGJ1eWVyIGZvciByZXNlcnZlZCBsaXN0aW5nLlxuICAgKlxuICAgKiBAcmVtYXJrcyBBcHByb3ZlIGEgYnV5ZXIgdG8gYnV5IGZyb20gYSByZXNlcnZlZCBsaXN0aW5nLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIC8vIFRoZSBsaXN0aW5nIElEIG9mIHRoZSBkaXJlY3QgbGlzdGluZyB5b3Ugd2FudCBhcHByb3ZlIGJ1eWVyIGZvclxuICAgKiBjb25zdCBsaXN0aW5nSWQgPSBcIjBcIjtcbiAgICpcbiAgICogYXdhaXQgY29udHJhY3QuZGlyZWN0TGlzdGluZ3MuYXBwcm92ZUJ1eWVyRm9yUmVzZXJ2ZWRMaXN0aW5nKGxpc3RpbmdJZCwgYnV5ZXIpO1xuICAgKiBgYGBcbiAgICpcbiAgICogQHBhcmFtIGxpc3RpbmdJZCAtIFRoZSBsaXN0aW5nIGlkIHRvIGJ1eVxuICAgKiBAcGFyYW0gYnV5ZXIgLSBBZGRyZXNzIG9mIGJ1eWVyIGJlaW5nIGFwcHJvdmVkXG4gICAqL1xuICBhc3luYyBhcHByb3ZlQnV5ZXJGb3JSZXNlcnZlZExpc3RpbmcobGlzdGluZ0lkLCBidXllcikge1xuICAgIGNvbnN0IGlzQXBwcm92ZWQgPSBhd2FpdCB0aGlzLmlzQnV5ZXJBcHByb3ZlZEZvckxpc3RpbmcobGlzdGluZ0lkLCBidXllcik7XG4gICAgaWYgKCFpc0FwcHJvdmVkKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZWNlaXB0OiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5zZW5kVHJhbnNhY3Rpb24oXCJhcHByb3ZlQnV5ZXJGb3JMaXN0aW5nXCIsIFtsaXN0aW5nSWQsIGJ1eWVyLCB0cnVlXSlcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQnV5ZXIgJHtidXllcn0gYWxyZWFkeSBhcHByb3ZlZCBmb3IgbGlzdGluZyAke2xpc3RpbmdJZH0uYCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldm9rZSBhcHByb3ZhbCBvZiBhIGJ1eWVyIGZvciByZXNlcnZlZCBsaXN0aW5nLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIC8vIFRoZSBsaXN0aW5nIElEIG9mIHRoZSBkaXJlY3QgbGlzdGluZyB5b3Ugd2FudCBhcHByb3ZlIGJ1eWVyIGZvclxuICAgKiBjb25zdCBsaXN0aW5nSWQgPSBcIjBcIjtcbiAgICpcbiAgICogYXdhaXQgY29udHJhY3QuZGlyZWN0TGlzdGluZ3MucmV2b2tlQnV5ZXJBcHByb3ZhbEZvclJlc2VydmVkTGlzdGluZyhsaXN0aW5nSWQsIGJ1eWVyKTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSBsaXN0aW5nSWQgLSBUaGUgbGlzdGluZyBpZCB0byBidXlcbiAgICogQHBhcmFtIGJ1eWVyIC0gQWRkcmVzcyBvZiBidXllciBiZWluZyBhcHByb3ZlZFxuICAgKi9cbiAgYXN5bmMgcmV2b2tlQnV5ZXJBcHByb3ZhbEZvclJlc2VydmVkTGlzdGluZyhsaXN0aW5nSWQsIGJ1eWVyKSB7XG4gICAgY29uc3QgaXNBcHByb3ZlZCA9IGF3YWl0IHRoaXMuaXNCdXllckFwcHJvdmVkRm9yTGlzdGluZyhsaXN0aW5nSWQsIGJ1eWVyKTtcbiAgICBpZiAoaXNBcHByb3ZlZCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcmVjZWlwdDogYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIuc2VuZFRyYW5zYWN0aW9uKFwiYXBwcm92ZUJ1eWVyRm9yTGlzdGluZ1wiLCBbbGlzdGluZ0lkLCBidXllciwgZmFsc2VdKVxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBCdXllciAke2J1eWVyfSBub3QgYXBwcm92ZWQgZm9yIGxpc3RpbmcgJHtsaXN0aW5nSWR9LmApO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBcHByb3ZlIGEgY3VycmVuY3kgZm9yIGEgbGlzdGluZy5cbiAgICpcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiAvLyBUaGUgbGlzdGluZyBJRCBvZiB0aGUgZGlyZWN0IGxpc3RpbmcgeW91IHdhbnQgYXBwcm92ZSBjdXJyZW5jeSBmb3JcbiAgICogY29uc3QgbGlzdGluZ0lkID0gXCIwXCI7XG4gICAqXG4gICAqIGF3YWl0IGNvbnRyYWN0LmRpcmVjdExpc3RpbmdzLmFwcHJvdmVDdXJyZW5jeUZvckxpc3RpbmcobGlzdGluZ0lkLCBjdXJyZW5jeUNvbnRyYWN0QWRkcmVzcywgcHJpY2VQZXJUb2tlbkluQ3VycmVuY3kpO1xuICAgKiBgYGBcbiAgICpcbiAgICogQHBhcmFtIGxpc3RpbmdJZCAtIFRoZSBsaXN0aW5nIGlkIHRvIGJ1eVxuICAgKiBAcGFyYW0gY3VycmVuY3lDb250cmFjdEFkZHJlc3MgLSBBZGRyZXNzIG9mIGN1cnJlbmN5IGJlaW5nIGFwcHJvdmVkXG4gICAqIEBwYXJhbSBwcmljZVBlclRva2VuSW5DdXJyZW5jeSAtIFByaWNlIHBlciB0b2tlbiBpbiB0aGUgY3VycmVuY3lcbiAgICovXG4gIGFzeW5jIGFwcHJvdmVDdXJyZW5jeUZvckxpc3RpbmcobGlzdGluZ0lkLCBjdXJyZW5jeUNvbnRyYWN0QWRkcmVzcywgcHJpY2VQZXJUb2tlbkluQ3VycmVuY3kpIHtcbiAgICBjb25zdCBsaXN0aW5nID0gYXdhaXQgdGhpcy52YWxpZGF0ZUxpc3RpbmcoQmlnTnVtYmVyLmZyb20obGlzdGluZ0lkKSk7XG4gICAgaWYgKGN1cnJlbmN5Q29udHJhY3RBZGRyZXNzID09PSBsaXN0aW5nLmN1cnJlbmN5Q29udHJhY3RBZGRyZXNzKSB7XG4gICAgICBpbnZhcmlhbnQocHJpY2VQZXJUb2tlbkluQ3VycmVuY3kgPT09IGxpc3RpbmcucHJpY2VQZXJUb2tlbiwgXCJBcHByb3ZpbmcgbGlzdGluZyBjdXJyZW5jeSB3aXRoIGEgZGlmZmVyZW50IHByaWNlLlwiKTtcbiAgICB9XG4gICAgY29uc3QgY3VycmVuY3lQcmljZSA9IGF3YWl0IHRoaXMuY29udHJhY3RXcmFwcGVyLnJlYWRDb250cmFjdC5jdXJyZW5jeVByaWNlRm9yTGlzdGluZyhsaXN0aW5nSWQsIGN1cnJlbmN5Q29udHJhY3RBZGRyZXNzKTtcbiAgICBpbnZhcmlhbnQocHJpY2VQZXJUb2tlbkluQ3VycmVuY3kgPT09IGN1cnJlbmN5UHJpY2UsIFwiQ3VycmVuY3kgYWxyZWFkeSBhcHByb3ZlZCB3aXRoIHRoaXMgcHJpY2UuXCIpO1xuICAgIHJldHVybiB7XG4gICAgICByZWNlaXB0OiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5zZW5kVHJhbnNhY3Rpb24oXCJhcHByb3ZlQ3VycmVuY3lGb3JMaXN0aW5nXCIsIFtsaXN0aW5nSWQsIGN1cnJlbmN5Q29udHJhY3RBZGRyZXNzLCBwcmljZVBlclRva2VuSW5DdXJyZW5jeV0pXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXZva2UgYXBwcm92YWwgb2YgYSBjdXJyZW5jeSBmcm9tIGEgbGlzdGluZy5cbiAgICpcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiAvLyBUaGUgbGlzdGluZyBJRCBvZiB0aGUgZGlyZWN0IGxpc3RpbmcgeW91IHdhbnQgdG8gcmV2b2tlIGN1cnJlbmN5IGZvclxuICAgKiBjb25zdCBsaXN0aW5nSWQgPSBcIjBcIjtcbiAgICpcbiAgICogYXdhaXQgY29udHJhY3QuZGlyZWN0TGlzdGluZ3MucmV2b2tlQ3VycmVuY3lBcHByb3ZhbEZvckxpc3RpbmcobGlzdGluZ0lkLCBjdXJyZW5jeUNvbnRyYWN0QWRkcmVzcyk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gbGlzdGluZ0lkIC0gVGhlIGxpc3RpbmcgaWQgdG8gYnV5XG4gICAqIEBwYXJhbSBjdXJyZW5jeUNvbnRyYWN0QWRkcmVzcyAtIEFkZHJlc3Mgb2YgY3VycmVuY3lcbiAgICovXG4gIGFzeW5jIHJldm9rZUN1cnJlbmN5QXBwcm92YWxGb3JMaXN0aW5nKGxpc3RpbmdJZCwgY3VycmVuY3lDb250cmFjdEFkZHJlc3MpIHtcbiAgICBjb25zdCBsaXN0aW5nID0gYXdhaXQgdGhpcy52YWxpZGF0ZUxpc3RpbmcoQmlnTnVtYmVyLmZyb20obGlzdGluZ0lkKSk7XG4gICAgaWYgKGN1cnJlbmN5Q29udHJhY3RBZGRyZXNzID09PSBsaXN0aW5nLmN1cnJlbmN5Q29udHJhY3RBZGRyZXNzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbid0IHJldm9rZSBhcHByb3ZhbCBmb3IgbWFpbiBsaXN0aW5nIGN1cnJlbmN5LmApO1xuICAgIH1cbiAgICBjb25zdCBjdXJyZW5jeVByaWNlID0gYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIucmVhZENvbnRyYWN0LmN1cnJlbmN5UHJpY2VGb3JMaXN0aW5nKGxpc3RpbmdJZCwgY3VycmVuY3lDb250cmFjdEFkZHJlc3MpO1xuICAgIGludmFyaWFudCghY3VycmVuY3lQcmljZS5pc1plcm8oKSwgXCJDdXJyZW5jeSBub3QgYXBwcm92ZWQuXCIpO1xuICAgIHJldHVybiB7XG4gICAgICByZWNlaXB0OiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5zZW5kVHJhbnNhY3Rpb24oXCJhcHByb3ZlQ3VycmVuY3lGb3JMaXN0aW5nXCIsIFtsaXN0aW5nSWQsIGN1cnJlbmN5Q29udHJhY3RBZGRyZXNzLCBCaWdOdW1iZXIuZnJvbSgwKV0pXG4gICAgfTtcbiAgfVxuXG4gIC8qKiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICogUFJJVkFURSBGVU5DVElPTlNcbiAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgLyoqXG4gICAqIFRocm93cyBlcnJvciBpZiBsaXN0aW5nIGNvdWxkIG5vdCBiZSBmb3VuZFxuICAgKlxuICAgKiBAcGFyYW0gbGlzdGluZ0lkIC0gTGlzdGluZyB0byBjaGVjayBmb3JcbiAgICovXG4gIGFzeW5jIHZhbGlkYXRlTGlzdGluZyhsaXN0aW5nSWQpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0TGlzdGluZyhsaXN0aW5nSWQpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZ2V0dGluZyB0aGUgbGlzdGluZyB3aXRoIGlkICR7bGlzdGluZ0lkfWApO1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBIZWxwZXIgbWV0aG9kIG1hcHMgdGhlIGF1Y3Rpb24gbGlzdGluZyB0byB0aGUgZGlyZWN0IGxpc3RpbmcgaW50ZXJmYWNlLlxuICAgKlxuICAgKiBAaW50ZXJuYWxcbiAgICogQHBhcmFtIGxpc3RpbmcgLSBUaGUgbGlzdGluZyB0byBtYXAsIGFzIHJldHVybmVkIGZyb20gdGhlIGNvbnRyYWN0LlxuICAgKiBAcmV0dXJucyAtIFRoZSBtYXBwZWQgaW50ZXJmYWNlLlxuICAgKi9cbiAgYXN5bmMgbWFwTGlzdGluZyhsaXN0aW5nKSB7XG4gICAgbGV0IHN0YXR1cyA9IFN0YXR1cy5VTlNFVDtcbiAgICBjb25zdCBibG9jayA9IGF3YWl0IHRoaXMuY29udHJhY3RXcmFwcGVyLmdldFByb3ZpZGVyKCkuZ2V0QmxvY2soXCJsYXRlc3RcIik7XG4gICAgY29uc3QgYmxvY2tUaW1lID0gYmxvY2sudGltZXN0YW1wO1xuICAgIHN3aXRjaCAobGlzdGluZy5zdGF0dXMpIHtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgc3RhdHVzID0gQmlnTnVtYmVyLmZyb20obGlzdGluZy5zdGFydFRpbWVzdGFtcCkuZ3QoYmxvY2tUaW1lKSA/IFN0YXR1cy5DcmVhdGVkIDogQmlnTnVtYmVyLmZyb20obGlzdGluZy5lbmRUaW1lc3RhbXApLmx0KGJsb2NrVGltZSkgPyBTdGF0dXMuRXhwaXJlZCA6IFN0YXR1cy5BY3RpdmU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyOlxuICAgICAgICBzdGF0dXMgPSBTdGF0dXMuQ29tcGxldGVkO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgc3RhdHVzID0gU3RhdHVzLkNhbmNlbGxlZDtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBhc3NldENvbnRyYWN0QWRkcmVzczogbGlzdGluZy5hc3NldENvbnRyYWN0LFxuICAgICAgY3VycmVuY3lDb250cmFjdEFkZHJlc3M6IGxpc3RpbmcuY3VycmVuY3ksXG4gICAgICBwcmljZVBlclRva2VuOiBsaXN0aW5nLnByaWNlUGVyVG9rZW4udG9TdHJpbmcoKSxcbiAgICAgIGN1cnJlbmN5VmFsdWVQZXJUb2tlbjogYXdhaXQgZmV0Y2hDdXJyZW5jeVZhbHVlKHRoaXMuY29udHJhY3RXcmFwcGVyLmdldFByb3ZpZGVyKCksIGxpc3RpbmcuY3VycmVuY3ksIGxpc3RpbmcucHJpY2VQZXJUb2tlbiksXG4gICAgICBpZDogbGlzdGluZy5saXN0aW5nSWQudG9TdHJpbmcoKSxcbiAgICAgIHRva2VuSWQ6IGxpc3RpbmcudG9rZW5JZC50b1N0cmluZygpLFxuICAgICAgcXVhbnRpdHk6IGxpc3RpbmcucXVhbnRpdHkudG9TdHJpbmcoKSxcbiAgICAgIHN0YXJ0VGltZUluU2Vjb25kczogQmlnTnVtYmVyLmZyb20obGlzdGluZy5zdGFydFRpbWVzdGFtcCkudG9OdW1iZXIoKSxcbiAgICAgIGFzc2V0OiBhd2FpdCBmZXRjaFRva2VuTWV0YWRhdGFGb3JDb250cmFjdChsaXN0aW5nLmFzc2V0Q29udHJhY3QsIHRoaXMuY29udHJhY3RXcmFwcGVyLmdldFByb3ZpZGVyKCksIGxpc3RpbmcudG9rZW5JZCwgdGhpcy5zdG9yYWdlKSxcbiAgICAgIGVuZFRpbWVJblNlY29uZHM6IEJpZ051bWJlci5mcm9tKGxpc3RpbmcuZW5kVGltZXN0YW1wKS50b051bWJlcigpLFxuICAgICAgY3JlYXRvckFkZHJlc3M6IGxpc3RpbmcubGlzdGluZ0NyZWF0b3IsXG4gICAgICBpc1Jlc2VydmVkTGlzdGluZzogbGlzdGluZy5yZXNlcnZlZCxcbiAgICAgIHN0YXR1czogc3RhdHVzXG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBVc2UgdGhpcyBtZXRob2QgdG8gY2hlY2sgaWYgYSBkaXJlY3QgbGlzdGluZyBpcyBzdGlsbCB2YWxpZC5cbiAgICpcbiAgICogV2F5cyBhIGRpcmVjdCBsaXN0aW5nIGNhbiBiZWNvbWUgaW52YWxpZDpcbiAgICogMS4gVGhlIGFzc2V0IGhvbGRlciB0cmFuc2ZlcnJlZCB0aGUgYXNzZXQgdG8gYW5vdGhlciB3YWxsZXRcbiAgICogMi4gVGhlIGFzc2V0IGhvbGRlciBidXJuZWQgdGhlIGFzc2V0XG4gICAqIDMuIFRoZSBhc3NldCBob2xkZXIgcmVtb3ZlZCB0aGUgYXBwcm92YWwgb24gdGhlIG1hcmtldHBsYWNlXG4gICAqXG4gICAqIEBpbnRlcm5hbFxuICAgKiBAcGFyYW0gbGlzdGluZyAtIFRoZSBsaXN0aW5nIHRvIGNoZWNrLlxuICAgKiBAcmV0dXJucyAtIFRydWUgaWYgdGhlIGxpc3RpbmcgaXMgdmFsaWQsIGZhbHNlIG90aGVyd2lzZS5cbiAgICovXG4gIGFzeW5jIGlzU3RpbGxWYWxpZExpc3RpbmcobGlzdGluZywgcXVhbnRpdHkpIHtcbiAgICBjb25zdCBhcHByb3ZlZCA9IGF3YWl0IGlzVG9rZW5BcHByb3ZlZEZvclRyYW5zZmVyKHRoaXMuY29udHJhY3RXcmFwcGVyLmdldFByb3ZpZGVyKCksIHRoaXMuZ2V0QWRkcmVzcygpLCBsaXN0aW5nLmFzc2V0Q29udHJhY3RBZGRyZXNzLCBsaXN0aW5nLnRva2VuSWQsIGxpc3RpbmcuY3JlYXRvckFkZHJlc3MpO1xuICAgIGlmICghYXBwcm92ZWQpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGBUb2tlbiAnJHtsaXN0aW5nLnRva2VuSWR9JyBmcm9tIGNvbnRyYWN0ICcke2xpc3RpbmcuYXNzZXRDb250cmFjdEFkZHJlc3N9JyBpcyBub3QgYXBwcm92ZWQgZm9yIHRyYW5zZmVyYFxuICAgICAgfTtcbiAgICB9XG4gICAgY29uc3QgcHJvdmlkZXIgPSB0aGlzLmNvbnRyYWN0V3JhcHBlci5nZXRQcm92aWRlcigpO1xuICAgIGNvbnN0IGVyYzE2NSA9IG5ldyBDb250cmFjdChsaXN0aW5nLmFzc2V0Q29udHJhY3RBZGRyZXNzLCBFUkMxNjVBYmksIHByb3ZpZGVyKTtcbiAgICBjb25zdCBpc0VSQzcyMSA9IGF3YWl0IGVyYzE2NS5zdXBwb3J0c0ludGVyZmFjZShJbnRlcmZhY2VJZF9JRVJDNzIxKTtcbiAgICBjb25zdCBpc0VSQzExNTUgPSBhd2FpdCBlcmMxNjUuc3VwcG9ydHNJbnRlcmZhY2UoSW50ZXJmYWNlSWRfSUVSQzExNTUpO1xuICAgIGlmIChpc0VSQzcyMSkge1xuICAgICAgY29uc3QgYXNzZXQgPSBuZXcgQ29udHJhY3QobGlzdGluZy5hc3NldENvbnRyYWN0QWRkcmVzcywgRXJjNzIxQWJpLCBwcm92aWRlcik7XG4gICAgICBjb25zdCB2YWxpZCA9IChhd2FpdCBhc3NldC5vd25lck9mKGxpc3RpbmcudG9rZW5JZCkpLnRvTG93ZXJDYXNlKCkgPT09IGxpc3RpbmcuY3JlYXRvckFkZHJlc3MudG9Mb3dlckNhc2UoKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbGlkLFxuICAgICAgICBlcnJvcjogdmFsaWQgPyB1bmRlZmluZWQgOiBgU2VsbGVyIGlzIG5vdCB0aGUgb3duZXIgb2YgVG9rZW4gJyR7bGlzdGluZy50b2tlbklkfScgZnJvbSBjb250cmFjdCAnJHtsaXN0aW5nLmFzc2V0Q29udHJhY3RBZGRyZXNzfSBhbnltb3JlJ2BcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmIChpc0VSQzExNTUpIHtcbiAgICAgIGNvbnN0IGFzc2V0ID0gbmV3IENvbnRyYWN0KGxpc3RpbmcuYXNzZXRDb250cmFjdEFkZHJlc3MsIEVyYzExNTVBYmksIHByb3ZpZGVyKTtcbiAgICAgIGNvbnN0IGJhbGFuY2UgPSBhd2FpdCBhc3NldC5iYWxhbmNlT2YobGlzdGluZy5jcmVhdG9yQWRkcmVzcywgbGlzdGluZy50b2tlbklkKTtcbiAgICAgIGNvbnN0IHZhbGlkID0gYmFsYW5jZS5ndGUocXVhbnRpdHkgfHwgbGlzdGluZy5xdWFudGl0eSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZCxcbiAgICAgICAgZXJyb3I6IHZhbGlkID8gdW5kZWZpbmVkIDogYFNlbGxlciBkb2VzIG5vdCBoYXZlIGVub3VnaCBiYWxhbmNlIG9mIFRva2VuICcke2xpc3RpbmcudG9rZW5JZH0nIGZyb20gY29udHJhY3QgJyR7bGlzdGluZy5hc3NldENvbnRyYWN0QWRkcmVzc30gdG8gZnVsZmlsbCB0aGUgbGlzdGluZ2BcbiAgICAgIH07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IFwiQ29udHJhY3QgZG9lcyBub3QgaW1wbGVtZW50IEVSQyAxMTU1IG9yIEVSQyA3MjEuXCJcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIGFwcGx5RmlsdGVyKGxpc3RpbmdzLCBmaWx0ZXIpIHtcbiAgICBsZXQgcmF3TGlzdGluZ3MgPSBbLi4ubGlzdGluZ3NdO1xuICAgIGlmIChmaWx0ZXIpIHtcbiAgICAgIGlmIChmaWx0ZXIuc2VsbGVyKSB7XG4gICAgICAgIHJhd0xpc3RpbmdzID0gcmF3TGlzdGluZ3MuZmlsdGVyKHNlbGxlciA9PiBzZWxsZXIubGlzdGluZ0NyZWF0b3IudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpID09PSBmaWx0ZXI/LnNlbGxlcj8udG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgIH1cbiAgICAgIGlmIChmaWx0ZXIudG9rZW5Db250cmFjdCkge1xuICAgICAgICByYXdMaXN0aW5ncyA9IHJhd0xpc3RpbmdzLmZpbHRlcih0b2tlbkNvbnRyYWN0ID0+IHRva2VuQ29udHJhY3QuYXNzZXRDb250cmFjdC50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkgPT09IGZpbHRlcj8udG9rZW5Db250cmFjdD8udG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgIH1cbiAgICAgIGlmIChmaWx0ZXIudG9rZW5JZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJhd0xpc3RpbmdzID0gcmF3TGlzdGluZ3MuZmlsdGVyKHRva2VuQ29udHJhY3QgPT4gdG9rZW5Db250cmFjdC50b2tlbklkLnRvU3RyaW5nKCkgPT09IGZpbHRlcj8udG9rZW5JZD8udG9TdHJpbmcoKSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmaWx0ZXI/LmNvdW50ICYmIGZpbHRlci5jb3VudCA8IHJhd0xpc3RpbmdzLmxlbmd0aCA/IHJhd0xpc3RpbmdzLnNsaWNlKDAsIGZpbHRlci5jb3VudCkgOiByYXdMaXN0aW5ncztcbiAgfVxufVxuXG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5jb25zdCBFbmdsaXNoQXVjdGlvbklucHV0UGFyYW1zU2NoZW1hID0gei5vYmplY3Qoe1xuICAvKipcbiAgICogVGhlIGFkZHJlc3Mgb2YgdGhlIGFzc2V0IGJlaW5nIGF1Y3Rpb25lZC5cbiAgICovXG4gIGFzc2V0Q29udHJhY3RBZGRyZXNzOiBBZGRyZXNzU2NoZW1hLFxuICAvKipcbiAgICogVGhlIElEIG9mIHRoZSB0b2tlbiB0byBhdWN0aW9uLlxuICAgKi9cbiAgdG9rZW5JZDogQmlnTnVtYmVyaXNoU2NoZW1hLFxuICAvKipcbiAgICogVGhlIHF1YW50aXR5IG9mIHRva2VucyB0byBpbmNsdWRlIGluIHRoZSBsaXN0aW5nLlxuICAgKlxuICAgKiBGb3IgRVJDNzIxcywgdGhpcyB2YWx1ZSBzaG91bGQgYWx3YXlzIGJlIDEgKGFuZCB3aWxsIGJlIGZvcmNlZCBpbnRlcm5hbGx5IHJlZ2FyZGxlc3Mgb2Ygd2hhdCBpcyBwYXNzZWQgaGVyZSkuXG4gICAqL1xuICBxdWFudGl0eTogQmlnTnVtYmVyaXNoU2NoZW1hLmRlZmF1bHQoMSksXG4gIC8qKlxuICAgKiBUaGUgYWRkcmVzcyBvZiB0aGUgY3VycmVuY3kgdG8gYWNjZXB0IGZvciB0aGUgbGlzdGluZy5cbiAgICovXG4gIGN1cnJlbmN5Q29udHJhY3RBZGRyZXNzOiBBZGRyZXNzU2NoZW1hLmRlZmF1bHQoTkFUSVZFX1RPS0VOX0FERFJFU1MpLFxuICAvKipcbiAgICogVGhlIG1pbmltdW0gcHJpY2UgdGhhdCBhIGJpZCBtdXN0IGJlIGluIG9yZGVyIHRvIGJlIGFjY2VwdGVkLlxuICAgKi9cbiAgbWluaW11bUJpZEFtb3VudDogQW1vdW50U2NoZW1hLFxuICAvKipcbiAgICogVGhlIGJ1eW91dCBwcmljZSBvZiB0aGUgYXVjdGlvbi5cbiAgICovXG4gIGJ1eW91dEJpZEFtb3VudDogQW1vdW50U2NoZW1hLFxuICAvKipcbiAgICogVGhpcyBpcyBhIGJ1ZmZlciBlLmcuIHggc2Vjb25kcy5cbiAgICpcbiAgICogSWYgYSBuZXcgd2lubmluZyBiaWQgaXMgbWFkZSBsZXNzIHRoYW4geCBzZWNvbmRzIGJlZm9yZSBleHBpcmF0aW9uVGltZXN0YW1wLCB0aGVcbiAgICogZXhwaXJhdGlvblRpbWVzdGFtcCBpcyBpbmNyZWFzZWQgYnkgeCBzZWNvbmRzLlxuICAgKi9cbiAgdGltZUJ1ZmZlckluU2Vjb25kczogQmlnTnVtYmVyaXNoU2NoZW1hLmRlZmF1bHQoOTAwKSxcbiAgLy8gMTUgbWludXRlcyBieSBkZWZhdWx0XG5cbiAgLyoqXG4gICAqIFRoaXMgaXMgYSBidWZmZXIgaW4gYmFzaXMgcG9pbnRzIGUuZy4geCUuXG4gICAqXG4gICAqIFRvIGJlIGNvbnNpZGVyZWQgYXMgYSBuZXcgd2lubmluZyBiaWQsIGEgYmlkIG11c3QgYmUgYXQgbGVhc3QgeCUgZ3JlYXRlciB0aGFuXG4gICAqIHRoZSBjdXJyZW50IHdpbm5pbmcgYmlkLlxuICAgKi9cbiAgYmlkQnVmZmVyQnBzOiBCaWdOdW1iZXJpc2hTY2hlbWEuZGVmYXVsdCg1MDApLFxuICAvLyA1JSBieSBkZWZhdWx0XG5cbiAgLyoqXG4gICAqIFRoZSBzdGFydCB0aW1lIG9mIHRoZSBhdWN0aW9uLlxuICAgKi9cbiAgc3RhcnRUaW1lc3RhbXA6IFJhd0RhdGVTY2hlbWEuZGVmYXVsdChuZXcgRGF0ZSgpKSxcbiAgLyoqXG4gICAqIFRoZSBlbmQgdGltZSBvZiB0aGUgYXVjdGlvbi5cbiAgICovXG4gIGVuZFRpbWVzdGFtcDogRW5kRGF0ZVNjaGVtYVxufSk7XG5cbi8qKlxuICogQHB1YmxpY1xuICovXG5cbi8qKlxuICogSGFuZGxlcyBhdWN0aW9uc1xuICogQHB1YmxpY1xuICovXG5jbGFzcyBNYXJrZXRwbGFjZVYzRW5nbGlzaEF1Y3Rpb25zIHtcbiAgLy8gdXRpbGl0aWVzXG5cbiAgY29uc3RydWN0b3IoY29udHJhY3RXcmFwcGVyLCBzdG9yYWdlKSB7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwiZmVhdHVyZU5hbWVcIiwgRkVBVFVSRV9FTkdMSVNIX0FVQ1RJT05TLm5hbWUpO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNvbnRyYWN0V3JhcHBlclwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInN0b3JhZ2VcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJldmVudHNcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJpbnRlcmNlcHRvclwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImVuY29kZXJcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJlc3RpbWF0b3JcIiwgdm9pZCAwKTtcbiAgICB0aGlzLmNvbnRyYWN0V3JhcHBlciA9IGNvbnRyYWN0V3JhcHBlcjtcbiAgICB0aGlzLnN0b3JhZ2UgPSBzdG9yYWdlO1xuICAgIHRoaXMuZXZlbnRzID0gbmV3IENvbnRyYWN0RXZlbnRzKHRoaXMuY29udHJhY3RXcmFwcGVyKTtcbiAgICB0aGlzLmVuY29kZXIgPSBuZXcgQ29udHJhY3RFbmNvZGVyKHRoaXMuY29udHJhY3RXcmFwcGVyKTtcbiAgICB0aGlzLmludGVyY2VwdG9yID0gbmV3IENvbnRyYWN0SW50ZXJjZXB0b3IodGhpcy5jb250cmFjdFdyYXBwZXIpO1xuICAgIHRoaXMuZXN0aW1hdG9yID0gbmV3IEdhc0Nvc3RFc3RpbWF0b3IodGhpcy5jb250cmFjdFdyYXBwZXIpO1xuICB9XG4gIGdldEFkZHJlc3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29udHJhY3RXcmFwcGVyLnJlYWRDb250cmFjdC5hZGRyZXNzO1xuICB9XG5cbiAgLyoqICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgKiBSRUFEIEZVTkNUSU9OU1xuICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAvKipcbiAgICogR2V0IHRoZSB0b3RhbCBudW1iZXIgb2YgZW5nbGlzaCBhdWN0aW9ucy5cbiAgICogQHJldHVybnMgUmV0dXJucyB0aGUgdG90YWwgbnVtYmVyIG9mIGF1Y3Rpb25zIGNyZWF0ZWQuXG4gICAqIEBwdWJsaWNcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiBjb25zdCB0b3RhbEF1Y3Rpb25zID0gYXdhaXQgY29udHJhY3QuZW5nbGlzaEF1Y3Rpb25zLmdldFRvdGFsQ291bnQoKTtcbiAgICogYGBgXG4gICAqL1xuICBhc3luYyBnZXRUb3RhbENvdW50KCkge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5yZWFkQ29udHJhY3QudG90YWxBdWN0aW9ucygpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbGwgYXVjdGlvbnMuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGphdmFzY3JpcHRcbiAgICogY29uc3QgYXVjdGlvbnMgPSBhd2FpdCBjb250cmFjdC5lbmdsaXNoQXVjdGlvbnMuZ2V0QWxsKCk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gZmlsdGVyIC0gb3B0aW9uYWwgZmlsdGVyIHBhcmFtZXRlcnNcbiAgICogQHJldHVybnMgdGhlIEF1Y3Rpb24gb2JqZWN0IGFycmF5XG4gICAqL1xuICBhc3luYyBnZXRBbGwoZmlsdGVyKSB7XG4gICAgY29uc3QgdG90YWxBdWN0aW9ucyA9IGF3YWl0IHRoaXMuZ2V0VG90YWxDb3VudCgpO1xuICAgIGxldCBzdGFydCA9IEJpZ051bWJlci5mcm9tKGZpbHRlcj8uc3RhcnQgfHwgMCkudG9OdW1iZXIoKTtcbiAgICBsZXQgZW5kID0gdG90YWxBdWN0aW9ucy50b051bWJlcigpO1xuICAgIGlmIChlbmQgPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gYXVjdGlvbnMgZXhpc3Qgb24gdGhlIGNvbnRyYWN0LmApO1xuICAgIH1cbiAgICBsZXQgcmF3QXVjdGlvbnMgPSBbXTtcbiAgICBsZXQgYmF0Y2hlcyA9IGF3YWl0IGdldEFsbEluQmF0Y2hlcyhzdGFydCwgZW5kLCB0aGlzLmNvbnRyYWN0V3JhcHBlci5yZWFkQ29udHJhY3QuZ2V0QWxsQXVjdGlvbnMpO1xuICAgIHJhd0F1Y3Rpb25zID0gYmF0Y2hlcy5mbGF0KCk7XG4gICAgY29uc3QgZmlsdGVyZWRBdWN0aW9ucyA9IHRoaXMuYXBwbHlGaWx0ZXIocmF3QXVjdGlvbnMsIGZpbHRlcik7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UuYWxsKGZpbHRlcmVkQXVjdGlvbnMubWFwKGF1Y3Rpb24gPT4gdGhpcy5tYXBBdWN0aW9uKGF1Y3Rpb24pKSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFsbCB2YWxpZCBhdWN0aW9ucy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiBjb25zdCBhdWN0aW9ucyA9IGF3YWl0IGNvbnRyYWN0LmVuZ2xpc2hBdWN0aW9ucy5nZXRBbGxWYWxpZCgpO1xuICAgKiBgYGBcbiAgICpcbiAgICogQHBhcmFtIGZpbHRlciAtIG9wdGlvbmFsIGZpbHRlciBwYXJhbWV0ZXJzXG4gICAqIEByZXR1cm5zIHRoZSBBdWN0aW9uIG9iamVjdCBhcnJheVxuICAgKi9cbiAgYXN5bmMgZ2V0QWxsVmFsaWQoZmlsdGVyKSB7XG4gICAgY29uc3QgdG90YWxBdWN0aW9ucyA9IGF3YWl0IHRoaXMuZ2V0VG90YWxDb3VudCgpO1xuICAgIGxldCBzdGFydCA9IEJpZ051bWJlci5mcm9tKGZpbHRlcj8uc3RhcnQgfHwgMCkudG9OdW1iZXIoKTtcbiAgICBsZXQgZW5kID0gdG90YWxBdWN0aW9ucy50b051bWJlcigpO1xuICAgIGlmIChlbmQgPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gYXVjdGlvbnMgZXhpc3Qgb24gdGhlIGNvbnRyYWN0LmApO1xuICAgIH1cbiAgICBsZXQgcmF3QXVjdGlvbnMgPSBbXTtcbiAgICBsZXQgYmF0Y2hlcyA9IGF3YWl0IGdldEFsbEluQmF0Y2hlcyhzdGFydCwgZW5kLCB0aGlzLmNvbnRyYWN0V3JhcHBlci5yZWFkQ29udHJhY3QuZ2V0QWxsVmFsaWRBdWN0aW9ucyk7XG4gICAgcmF3QXVjdGlvbnMgPSBiYXRjaGVzLmZsYXQoKTtcbiAgICBjb25zdCBmaWx0ZXJlZEF1Y3Rpb25zID0gdGhpcy5hcHBseUZpbHRlcihyYXdBdWN0aW9ucywgZmlsdGVyKTtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwoZmlsdGVyZWRBdWN0aW9ucy5tYXAoYXVjdGlvbiA9PiB0aGlzLm1hcEF1Y3Rpb24oYXVjdGlvbikpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYW4gQXVjdGlvbiBieSBpZC5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiBjb25zdCBhdWN0aW9uSWQgPSAwO1xuICAgKiBjb25zdCBhdWN0aW9uID0gYXdhaXQgY29udHJhY3QuZW5nbGlzaEF1Y3Rpb25zLmdldEF1Y3Rpb24oYXVjdGlvbklkKTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSBhdWN0aW9uSWQgLSB0aGUgYXVjdGlvbiBJZFxuICAgKiBAcmV0dXJucyB0aGUgQXVjdGlvbiBvYmplY3RcbiAgICovXG4gIGFzeW5jIGdldEF1Y3Rpb24oYXVjdGlvbklkKSB7XG4gICAgY29uc3QgYXVjdGlvbiA9IGF3YWl0IHRoaXMuY29udHJhY3RXcmFwcGVyLnJlYWRDb250cmFjdC5nZXRBdWN0aW9uKGF1Y3Rpb25JZCk7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMubWFwQXVjdGlvbihhdWN0aW9uKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgSGlnaGVzdCBCaWRcbiAgICpcbiAgICogQHJlbWFya3MgR2V0IHRoZSBjdXJyZW50IGhpZ2hlc3QgYmlkIG9mIGFuIGFjdGl2ZSBhdWN0aW9uLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIC8vIFRoZSBJRCBvZiB0aGUgYXVjdGlvblxuICAgKiBjb25zdCBhdWN0aW9uSWQgPSAwO1xuICAgKlxuICAgKiBjb250cmFjdC5lbmdsaXNoQXVjdGlvbnMuXG4gICAqICAgLmdldFdpbm5pbmdCaWQoYXVjdGlvbklkKVxuICAgKiAgIC50aGVuKChiaWQpID0+IGNvbnNvbGUubG9nKGJpZCkpXG4gICAqICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XG4gICAqIGBgYFxuICAgKi9cbiAgYXN5bmMgZ2V0V2lubmluZ0JpZChhdWN0aW9uSWQpIHtcbiAgICBhd2FpdCB0aGlzLnZhbGlkYXRlQXVjdGlvbihCaWdOdW1iZXIuZnJvbShhdWN0aW9uSWQpKTtcbiAgICBjb25zdCBiaWQgPSBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5yZWFkQ29udHJhY3QuZ2V0V2lubmluZ0JpZChhdWN0aW9uSWQpO1xuICAgIGlmIChiaWQuX2JpZGRlciA9PT0gY29uc3RhbnRzLkFkZHJlc3NaZXJvKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gYXdhaXQgdGhpcy5tYXBCaWQoYXVjdGlvbklkLnRvU3RyaW5nKCksIGJpZC5fYmlkZGVyLCBiaWQuX2N1cnJlbmN5LCBiaWQuX2JpZEFtb3VudC50b1N0cmluZygpKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBpZiBhIGJpZC1hbW91bnQgaXMvd2lsbCBiZSBhIHdpbm5pbmcgYmlkLlxuICAgKlxuICAgKiBAcGFyYW0gYXVjdGlvbklkIC0gQXVjdGlvbiBJZFxuICAgKiBAcGFyYW0gYmlkQW1vdW50IC0gQW1vdW50IHRvIGJpZFxuICAgKiBAcmV0dXJucyB0aGUgQXVjdGlvbiBvYmplY3RcbiAgICovXG4gIGFzeW5jIGlzV2lubmluZ0JpZChhdWN0aW9uSWQsIGJpZEFtb3VudCkge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5yZWFkQ29udHJhY3QuaXNOZXdXaW5uaW5nQmlkKGF1Y3Rpb25JZCwgYmlkQW1vdW50KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgQXVjdGlvbiBXaW5uZXJcbiAgICpcbiAgICogQHJlbWFya3MgR2V0IHRoZSB3aW5uZXIgb2YgdGhlIGF1Y3Rpb24gYWZ0ZXIgYW4gYXVjdGlvbiBlbmRzLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIC8vIFRoZSBhdWN0aW9uIElEIG9mIHRoZSBhdWN0aW9uIHRoYXQgY2xvc2VkXG4gICAqIGNvbnN0IGF1Y3Rpb25JZCA9IDA7XG4gICAqXG4gICAqIGNvbnRyYWN0LmVuZ2xpc2hBdWN0aW9ucy5cbiAgICogICAuZ2V0V2lubmVyKGF1Y3Rpb25JZClcbiAgICogICAudGhlbigoYXVjdGlvbldpbm5lcikgPT4gY29uc29sZS5sb2coYXVjdGlvbldpbm5lcikpXG4gICAqICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XG4gICAqIGBgYFxuICAgKi9cbiAgYXN5bmMgZ2V0V2lubmVyKGF1Y3Rpb25JZCkge1xuICAgIGNvbnN0IGF1Y3Rpb24gPSBhd2FpdCB0aGlzLnZhbGlkYXRlQXVjdGlvbihCaWdOdW1iZXIuZnJvbShhdWN0aW9uSWQpKTtcbiAgICBjb25zdCBiaWQgPSBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5yZWFkQ29udHJhY3QuZ2V0V2lubmluZ0JpZChhdWN0aW9uSWQpO1xuICAgIGNvbnN0IG5vdyA9IEJpZ051bWJlci5mcm9tKE1hdGguZmxvb3IoRGF0ZS5ub3coKSAvIDEwMDApKTtcbiAgICBjb25zdCBlbmRUaW1lID0gQmlnTnVtYmVyLmZyb20oYXVjdGlvbi5lbmRUaW1lSW5TZWNvbmRzKTtcblxuICAgIC8vIGlmIHdlIGhhdmUgYSB3aW5uZXIgaW4gdGhlIG1hcCBhbmQgdGhlIGN1cnJlbnQgdGltZSBpcyBwYXN0IHRoZSBlbmR0aW1lIG9mIHRoZSBhdWN0aW9uIHJldHVybiB0aGUgYWRkcmVzcyBvZiB0aGUgd2lubmVyXG4gICAgaWYgKG5vdy5ndChlbmRUaW1lKSAmJiBiaWQuX2JpZGRlciAhPT0gY29uc3RhbnRzLkFkZHJlc3NaZXJvKSB7XG4gICAgICByZXR1cm4gYmlkLl9iaWRkZXI7XG4gICAgfVxuICAgIC8vIG90aGVyd2lzZSBmYWxsIGJhY2sgdG8gcXVlcnkgZmlsdGVyIHRoaW5nc1xuXG4gICAgLy8gVE9ETyB0aGlzIHNob3VsZCBiZSB2aWEgaW5kZXhlciBvciBkaXJlY3QgY29udHJhY3QgY2FsbFxuICAgIGNvbnN0IGNsb3NlZEF1Y3Rpb25zID0gYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIucmVhZENvbnRyYWN0LnF1ZXJ5RmlsdGVyKHRoaXMuY29udHJhY3RXcmFwcGVyLnJlYWRDb250cmFjdC5maWx0ZXJzLkF1Y3Rpb25DbG9zZWQoKSk7XG4gICAgY29uc3QgY2xvc2VkID0gY2xvc2VkQXVjdGlvbnMuZmluZChhID0+IGEuYXJncy5hdWN0aW9uSWQuZXEoQmlnTnVtYmVyLmZyb20oYXVjdGlvbklkKSkpO1xuICAgIGlmICghY2xvc2VkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBmaW5kIGF1Y3Rpb24gd2l0aCBJRCAke2F1Y3Rpb25JZH0gaW4gY2xvc2VkIGF1Y3Rpb25zYCk7XG4gICAgfVxuICAgIHJldHVybiBjbG9zZWQuYXJncy53aW5uaW5nQmlkZGVyO1xuICB9XG5cbiAgLyoqICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgKiBXUklURSBGVU5DVElPTlNcbiAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgLyoqXG4gICAqIENyZWF0ZSBBdWN0aW9uXG4gICAqXG4gICAqIEByZW1hcmtzIENyZWF0ZSBhIG5ldyBhdWN0aW9uIHdoZXJlIHBlb3BsZSBjYW4gYmlkIG9uIGFuIGFzc2V0LlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIC8vIERhdGEgb2YgdGhlIGF1Y3Rpb24geW91IHdhbnQgdG8gY3JlYXRlXG4gICAqIGNvbnN0IGF1Y3Rpb24gPSB7XG4gICAqICAgLy8gYWRkcmVzcyBvZiB0aGUgY29udHJhY3Qgb2YgdGhlIGFzc2V0IHlvdSB3YW50IHRvIGF1Y3Rpb25cbiAgICogICBhc3NldENvbnRyYWN0QWRkcmVzczogXCIweC4uLlwiLFxuICAgKiAgIC8vIHRva2VuIElEIG9mIHRoZSBhc3NldCB5b3Ugd2FudCB0byBhdWN0aW9uXG4gICAqICAgdG9rZW5JZDogXCIwXCIsXG4gICAqICAgLy8gaG93IG1hbnkgb2YgdGhlIGFzc2V0IHlvdSB3YW50IHRvIGF1Y3Rpb25cbiAgICogICBxdWFudGl0eTogMSxcbiAgICogICAvLyBhZGRyZXNzIG9mIHRoZSBjdXJyZW5jeSBjb250cmFjdCB0aGF0IHdpbGwgYmUgdXNlZCB0byBwYXkgZm9yIHRoZSBhdWN0aW9uZWQgdG9rZW5zXG4gICAqICAgY3VycmVuY3lDb250cmFjdEFkZHJlc3M6IE5BVElWRV9UT0tFTl9BRERSRVNTLFxuICAgKiAgIC8vIHRoZSBtaW5pbXVtIGJpZCB0aGF0IHdpbGwgYmUgYWNjZXB0ZWQgZm9yIHRoZSB0b2tlblxuICAgKiAgIG1pbmltdW1CaWRBbW91bnQ6IFwiMS41XCIsXG4gICAqICAgLy8gaG93IG11Y2ggcGVvcGxlIHdvdWxkIGhhdmUgdG8gYmlkIHRvIGluc3RhbnRseSBidXkgdGhlIGFzc2V0XG4gICAqICAgYnV5b3V0QmlkQW1vdW50OiBcIjEwXCIsXG4gICAqICAgLy8gSWYgYSBiaWQgaXMgbWFkZSBsZXNzIHRoYW4gdGhlc2UgbWFueSBzZWNvbmRzIGJlZm9yZSBleHBpcmF0aW9uLCB0aGUgZXhwaXJhdGlvbiB0aW1lIGlzIGluY3JlYXNlZCBieSB0aGlzLlxuICAgKiAgIHRpbWVCdWZmZXJJblNlY29uZHM6IFwiOTAwXCIsIC8vIDE1IG1pbnV0ZXMgYnkgZGVmYXVsdFxuICAgKiAgIC8vIEEgYmlkIG11c3QgYmUgYXQgbGVhc3QgdGhpcyBtdWNoIGJwcyBncmVhdGVyIHRoYW4gdGhlIGN1cnJlbnQgd2lubmluZyBiaWRcbiAgICogICBiaWRCdWZmZXJCcHM6IFwiNTAwXCIsIC8vIDUlIGJ5IGRlZmF1bHRcbiAgICogICAvLyB3aGVuIHNob3VsZCB0aGUgYXVjdGlvbiBvcGVuIHVwIGZvciBiaWRkaW5nXG4gICAqICAgc3RhcnRUaW1lc3RhbXA6IG5ldyBEYXRlKERhdGUubm93KCkpLFxuICAgKiAgIC8vIGVuZCB0aW1lIG9mIGF1Y3Rpb25cbiAgICogICBlbmRUaW1lc3RhbXA6IG5ldyBEYXRlKERhdGUubm93KCkgKyA1ICogMjQgKiA2MCAqIDYwICogMTAwMCksXG4gICAqIH1cbiAgICpcbiAgICogY29uc3QgdHggPSBhd2FpdCBjb250cmFjdC5lbmdsaXNoQXVjdGlvbnMuY3JlYXRlQXVjdGlvbihhdWN0aW9uKTtcbiAgICogY29uc3QgcmVjZWlwdCA9IHR4LnJlY2VpcHQ7IC8vIHRoZSB0cmFuc2FjdGlvbiByZWNlaXB0XG4gICAqIGNvbnN0IGlkID0gdHguaWQ7IC8vIHRoZSBpZCBvZiB0aGUgbmV3bHkgY3JlYXRlZCBhdWN0aW9uXG4gICAqIGBgYFxuICAgKi9cbiAgYXN5bmMgY3JlYXRlQXVjdGlvbihhdWN0aW9uKSB7XG4gICAgY29uc3QgcGFyc2VkQXVjdGlvbiA9IEVuZ2xpc2hBdWN0aW9uSW5wdXRQYXJhbXNTY2hlbWEucGFyc2UoYXVjdGlvbik7XG4gICAgYXdhaXQgaGFuZGxlVG9rZW5BcHByb3ZhbCh0aGlzLmNvbnRyYWN0V3JhcHBlciwgdGhpcy5nZXRBZGRyZXNzKCksIHBhcnNlZEF1Y3Rpb24uYXNzZXRDb250cmFjdEFkZHJlc3MsIHBhcnNlZEF1Y3Rpb24udG9rZW5JZCwgYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0U2lnbmVyQWRkcmVzcygpKTtcbiAgICBjb25zdCBub3JtYWxpemVkQnV5b3V0QW1vdW50ID0gYXdhaXQgbm9ybWFsaXplUHJpY2VWYWx1ZSh0aGlzLmNvbnRyYWN0V3JhcHBlci5nZXRQcm92aWRlcigpLCBwYXJzZWRBdWN0aW9uLmJ1eW91dEJpZEFtb3VudCwgcGFyc2VkQXVjdGlvbi5jdXJyZW5jeUNvbnRyYWN0QWRkcmVzcyk7XG4gICAgY29uc3Qgbm9ybWFsaXplZE1pbkJpZEFtb3VudCA9IGF3YWl0IG5vcm1hbGl6ZVByaWNlVmFsdWUodGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0UHJvdmlkZXIoKSwgcGFyc2VkQXVjdGlvbi5taW5pbXVtQmlkQW1vdW50LCBwYXJzZWRBdWN0aW9uLmN1cnJlbmN5Q29udHJhY3RBZGRyZXNzKTtcbiAgICBjb25zdCBibG9jayA9IGF3YWl0IHRoaXMuY29udHJhY3RXcmFwcGVyLmdldFByb3ZpZGVyKCkuZ2V0QmxvY2soXCJsYXRlc3RcIik7XG4gICAgY29uc3QgYmxvY2tUaW1lID0gYmxvY2sudGltZXN0YW1wO1xuICAgIGlmIChwYXJzZWRBdWN0aW9uLnN0YXJ0VGltZXN0YW1wLmx0KGJsb2NrVGltZSkpIHtcbiAgICAgIHBhcnNlZEF1Y3Rpb24uc3RhcnRUaW1lc3RhbXAgPSBCaWdOdW1iZXIuZnJvbShibG9ja1RpbWUpO1xuICAgIH1cbiAgICBjb25zdCByZWNlaXB0ID0gYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIuc2VuZFRyYW5zYWN0aW9uKFwiY3JlYXRlQXVjdGlvblwiLCBbe1xuICAgICAgYXNzZXRDb250cmFjdDogcGFyc2VkQXVjdGlvbi5hc3NldENvbnRyYWN0QWRkcmVzcyxcbiAgICAgIHRva2VuSWQ6IHBhcnNlZEF1Y3Rpb24udG9rZW5JZCxcbiAgICAgIHF1YW50aXR5OiBwYXJzZWRBdWN0aW9uLnF1YW50aXR5LFxuICAgICAgY3VycmVuY3k6IGNsZWFuQ3VycmVuY3lBZGRyZXNzKHBhcnNlZEF1Y3Rpb24uY3VycmVuY3lDb250cmFjdEFkZHJlc3MpLFxuICAgICAgbWluaW11bUJpZEFtb3VudDogbm9ybWFsaXplZE1pbkJpZEFtb3VudCxcbiAgICAgIGJ1eW91dEJpZEFtb3VudDogbm9ybWFsaXplZEJ1eW91dEFtb3VudCxcbiAgICAgIHRpbWVCdWZmZXJJblNlY29uZHM6IHBhcnNlZEF1Y3Rpb24udGltZUJ1ZmZlckluU2Vjb25kcyxcbiAgICAgIGJpZEJ1ZmZlckJwczogcGFyc2VkQXVjdGlvbi5iaWRCdWZmZXJCcHMsXG4gICAgICBzdGFydFRpbWVzdGFtcDogcGFyc2VkQXVjdGlvbi5zdGFydFRpbWVzdGFtcCxcbiAgICAgIGVuZFRpbWVzdGFtcDogcGFyc2VkQXVjdGlvbi5lbmRUaW1lc3RhbXBcbiAgICB9XSwge1xuICAgICAgLy8gSGlnaGVyIGdhcyBsaW1pdCBmb3IgY3JlYXRlIGF1Y3Rpb25cbiAgICAgIGdhc0xpbWl0OiA1MDAwMDBcbiAgICB9KTtcbiAgICBjb25zdCBldmVudCA9IHRoaXMuY29udHJhY3RXcmFwcGVyLnBhcnNlTG9ncyhcIk5ld0F1Y3Rpb25cIiwgcmVjZWlwdD8ubG9ncyk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBldmVudFswXS5hcmdzLmF1Y3Rpb25JZCxcbiAgICAgIHJlY2VpcHRcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIEJ1eW91dCBBdWN0aW9uXG4gICAqXG4gICAqIEByZW1hcmtzIEJ1eSBhIHNwZWNpZmljIGF1Y3Rpb24gZnJvbSB0aGUgbWFya2V0cGxhY2UuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGphdmFzY3JpcHRcbiAgICogLy8gVGhlIGF1Y3Rpb24gSUQgb2YgdGhlIGFzc2V0IHlvdSB3YW50IHRvIGJ1eVxuICAgKiBjb25zdCBhdWN0aW9uSWQgPSAwO1xuICAgKlxuICAgKiBhd2FpdCBjb250cmFjdC5lbmdsaXNoQXVjdGlvbnMuYnV5b3V0QXVjdGlvbihhdWN0aW9uSWQpO1xuICAgKiBgYGBcbiAgICovXG4gIGFzeW5jIGJ1eW91dEF1Y3Rpb24oYXVjdGlvbklkKSB7XG4gICAgY29uc3QgYXVjdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVBdWN0aW9uKEJpZ051bWJlci5mcm9tKGF1Y3Rpb25JZCkpO1xuICAgIGNvbnN0IGN1cnJlbmN5TWV0YWRhdGEgPSBhd2FpdCBmZXRjaEN1cnJlbmN5TWV0YWRhdGEodGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0UHJvdmlkZXIoKSwgYXVjdGlvbi5jdXJyZW5jeUNvbnRyYWN0QWRkcmVzcyk7XG4gICAgcmV0dXJuIHRoaXMubWFrZUJpZChhdWN0aW9uSWQsIGV0aGVycy51dGlscy5mb3JtYXRVbml0cyhhdWN0aW9uLmJ1eW91dEJpZEFtb3VudCwgY3VycmVuY3lNZXRhZGF0YS5kZWNpbWFscykpO1xuICB9XG5cbiAgLyoqXG4gICAqIEJpZCBPbiBBdWN0aW9uXG4gICAqXG4gICAqIEByZW1hcmtzIE1ha2UgYSBiaWQgb24gYW4gYXVjdGlvblxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIC8vIFRoZSBhdWN0aW9uIElEIG9mIHRoZSBhc3NldCB5b3Ugd2FudCB0byBiaWQgb25cbiAgICogY29uc3QgYXVjdGlvbklkID0gMDtcbiAgICogLy8gVGhlIHRvdGFsIGFtb3VudCB5b3UgYXJlIHdpbGxpbmcgdG8gYmlkIGZvciBhdWN0aW9uZWQgdG9rZW5zXG4gICAqIGNvbnN0IGJpZEFtb3VudCA9IDE7XG4gICAqXG4gICAqIGF3YWl0IGNvbnRyYWN0LmVuZ2xpc2hBdWN0aW9ucy5tYWtlQmlkKGF1Y3Rpb25JZCwgYmlkQW1vdW50KTtcbiAgICogYGBgXG4gICAqL1xuICBhc3luYyBtYWtlQmlkKGF1Y3Rpb25JZCwgYmlkQW1vdW50KSB7XG4gICAgY29uc3QgYXVjdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVBdWN0aW9uKEJpZ051bWJlci5mcm9tKGF1Y3Rpb25JZCkpO1xuICAgIGNvbnN0IG5vcm1hbGl6ZWRCaWRBbW91bnQgPSBhd2FpdCBub3JtYWxpemVQcmljZVZhbHVlKHRoaXMuY29udHJhY3RXcmFwcGVyLmdldFByb3ZpZGVyKCksIGJpZEFtb3VudCwgYXVjdGlvbi5jdXJyZW5jeUNvbnRyYWN0QWRkcmVzcyk7XG4gICAgaWYgKG5vcm1hbGl6ZWRCaWRBbW91bnQuZXEoQmlnTnVtYmVyLmZyb20oMCkpKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYW5ub3QgbWFrZSBhIGJpZCB3aXRoIDAgdmFsdWVcIik7XG4gICAgfVxuICAgIGlmIChCaWdOdW1iZXIuZnJvbShhdWN0aW9uLmJ1eW91dEJpZEFtb3VudCkuZ3QoMCkgJiYgbm9ybWFsaXplZEJpZEFtb3VudC5ndChhdWN0aW9uLmJ1eW91dEJpZEFtb3VudCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIkJpZCBhbW91bnQgbXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gYnV5b3V0QmlkQW1vdW50XCIpO1xuICAgIH1cbiAgICBjb25zdCB3aW5uaW5nQmlkID0gYXdhaXQgdGhpcy5nZXRXaW5uaW5nQmlkKGF1Y3Rpb25JZCk7XG4gICAgaWYgKHdpbm5pbmdCaWQpIHtcbiAgICAgIGNvbnN0IGlzV2lubm5lciA9IGF3YWl0IHRoaXMuaXNXaW5uaW5nQmlkKGF1Y3Rpb25JZCwgbm9ybWFsaXplZEJpZEFtb3VudCk7XG4gICAgICBpbnZhcmlhbnQoaXNXaW5ubmVyLCBcIkJpZCBwcmljZSBpcyB0b28gbG93IGJhc2VkIG9uIHRoZSBjdXJyZW50IHdpbm5pbmcgYmlkIGFuZCB0aGUgYmlkIGJ1ZmZlclwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgdG9rZW5QcmljZSA9IG5vcm1hbGl6ZWRCaWRBbW91bnQ7XG4gICAgICBjb25zdCBtaW5pbXVtQmlkQW1vdW50ID0gQmlnTnVtYmVyLmZyb20oYXVjdGlvbi5taW5pbXVtQmlkQW1vdW50KTtcbiAgICAgIGludmFyaWFudCh0b2tlblByaWNlLmd0ZShtaW5pbXVtQmlkQW1vdW50KSwgXCJCaWQgcHJpY2UgaXMgdG9vIGxvdyBiYXNlZCBvbiBtaW5pbXVtIGJpZCBhbW91bnRcIik7XG4gICAgfVxuICAgIGNvbnN0IG92ZXJyaWRlcyA9IChhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5nZXRDYWxsT3ZlcnJpZGVzKCkpIHx8IHt9O1xuICAgIGF3YWl0IHNldEVyYzIwQWxsb3dhbmNlKHRoaXMuY29udHJhY3RXcmFwcGVyLCBub3JtYWxpemVkQmlkQW1vdW50LCBhdWN0aW9uLmN1cnJlbmN5Q29udHJhY3RBZGRyZXNzLCBvdmVycmlkZXMpO1xuICAgIHJldHVybiB7XG4gICAgICByZWNlaXB0OiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5zZW5kVHJhbnNhY3Rpb24oXCJiaWRJbkF1Y3Rpb25cIiwgW2F1Y3Rpb25JZCwgbm9ybWFsaXplZEJpZEFtb3VudF0sIG92ZXJyaWRlcylcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIENhbmNlbCBBdWN0aW9uXG4gICAqXG4gICAqIEByZW1hcmtzIENhbmNlbCBhbiBhdWN0aW9uIG9uIHRoZSBtYXJrZXRwbGFjZVxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIC8vIFRoZSBJRCBvZiB0aGUgYXVjdGlvbiB5b3Ugd2FudCB0byBjYW5jZWxcbiAgICogY29uc3QgYXVjdGlvbklkID0gXCIwXCI7XG4gICAqXG4gICAqIGF3YWl0IGNvbnRyYWN0LmVuZ2xpc2hBdWN0aW9ucy5jYW5jZWxBdWN0aW9uKGF1Y3Rpb25JZCk7XG4gICAqIGBgYFxuICAgKi9cbiAgYXN5bmMgY2FuY2VsQXVjdGlvbihhdWN0aW9uSWQpIHtcbiAgICBjb25zdCB3aW5uaW5nQmlkID0gYXdhaXQgdGhpcy5nZXRXaW5uaW5nQmlkKGF1Y3Rpb25JZCk7XG4gICAgaWYgKHdpbm5pbmdCaWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgQmlkcyBhbHJlYWR5IG1hZGUuYCk7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICByZWNlaXB0OiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5zZW5kVHJhbnNhY3Rpb24oXCJjYW5jZWxBdWN0aW9uXCIsIFthdWN0aW9uSWRdKVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQ2xvc2UgdGhlIEF1Y3Rpb24gZm9yIHRoZSBidXllclxuICAgKlxuICAgKiBAcmVtYXJrcyBDbG9zZXMgdGhlIEF1Y3Rpb24gYW5kIGV4ZWN1dGVzIHRoZSBzYWxlIGZvciB0aGUgYnV5ZXIuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGphdmFzY3JpcHRcbiAgICogLy8gVGhlIElEIG9mIHRoZSBhdWN0aW9uIHlvdSB3YW50IHRvIGNsb3NlXG4gICAqIGNvbnN0IGF1Y3Rpb24gPSBcIjBcIjtcbiAgICogYXdhaXQgY29udHJhY3QuZW5nbGlzaEF1Y3Rpb25zLmNsb3NlQXVjdGlvbkZvckJpZGRlcihhdWN0aW9uSWQpO1xuICAgKiBgYGBcbiAgICpcbiAgICogQHBhcmFtIGF1Y3Rpb25JZCAtIHRoZSBhdWN0aW9uIGlkIHRvIGNsb3NlXG4gICAqIEBwYXJhbSBjbG9zZUZvciAtIG9wdGlvbmFsbHkgcGFzcyB0aGUgd2lubmluZyBiaWQgb2ZmZXJvciBhZGRyZXNzIHRvIGNsb3NlIHRoZSBhdWN0aW9uIG9uIHRoZWlyIGJlaGFsZlxuICAgKi9cbiAgYXN5bmMgY2xvc2VBdWN0aW9uRm9yQmlkZGVyKGF1Y3Rpb25JZCwgY2xvc2VGb3IpIHtcbiAgICBpZiAoIWNsb3NlRm9yKSB7XG4gICAgICBjbG9zZUZvciA9IGF3YWl0IHRoaXMuY29udHJhY3RXcmFwcGVyLmdldFNpZ25lckFkZHJlc3MoKTtcbiAgICB9XG4gICAgY29uc3QgYXVjdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVBdWN0aW9uKEJpZ051bWJlci5mcm9tKGF1Y3Rpb25JZCkpO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZWNlaXB0OiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5zZW5kVHJhbnNhY3Rpb24oXCJjb2xsZWN0QXVjdGlvblRva2Vuc1wiLCBbQmlnTnVtYmVyLmZyb20oYXVjdGlvbklkKV0pXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKGVyci5tZXNzYWdlLmluY2x1ZGVzKFwiTWFya2V0cGxhY2U6IGF1Y3Rpb24gc3RpbGwgYWN0aXZlLlwiKSkge1xuICAgICAgICB0aHJvdyBuZXcgQXVjdGlvbkhhc05vdEVuZGVkRXJyb3IoYXVjdGlvbklkLnRvU3RyaW5nKCksIGF1Y3Rpb24uZW5kVGltZUluU2Vjb25kcy50b1N0cmluZygpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ2xvc2UgdGhlIEF1Y3Rpb24gZm9yIHRoZSBzZWxsZXIsIGkuZS4gdGhlIGF1Y3Rpb24gY3JlYXRvclxuICAgKlxuICAgKiBAcmVtYXJrcyBDbG9zZXMgdGhlIEF1Y3Rpb24gYW5kIGV4ZWN1dGVzIHRoZSBzYWxlIGZvciB0aGUgc2VsbGVyLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIC8vIFRoZSBJRCBvZiB0aGUgYXVjdGlvbiB5b3Ugd2FudCB0byBjbG9zZVxuICAgKiBjb25zdCBhdWN0aW9uSWQgPSBcIjBcIjtcbiAgICogYXdhaXQgY29udHJhY3QuZW5nbGlzaEF1Y3Rpb25zLmNsb3NlQXVjdGlvbkZvclNlbGxlcihhdWN0aW9uSWQpO1xuICAgKiBgYGBcbiAgICpcbiAgICogQHBhcmFtIGF1Y3Rpb25JZCAtIHRoZSBhdWN0aW9uIGlkIHRvIGNsb3NlXG4gICAqL1xuICBhc3luYyBjbG9zZUF1Y3Rpb25Gb3JTZWxsZXIoYXVjdGlvbklkKSB7XG4gICAgY29uc3QgYXVjdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVBdWN0aW9uKEJpZ051bWJlci5mcm9tKGF1Y3Rpb25JZCkpO1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByZWNlaXB0OiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5zZW5kVHJhbnNhY3Rpb24oXCJjb2xsZWN0QXVjdGlvblBheW91dFwiLCBbQmlnTnVtYmVyLmZyb20oYXVjdGlvbklkKV0pXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKGVyci5tZXNzYWdlLmluY2x1ZGVzKFwiTWFya2V0cGxhY2U6IGF1Y3Rpb24gc3RpbGwgYWN0aXZlLlwiKSkge1xuICAgICAgICB0aHJvdyBuZXcgQXVjdGlvbkhhc05vdEVuZGVkRXJyb3IoYXVjdGlvbklkLnRvU3RyaW5nKCksIGF1Y3Rpb24uZW5kVGltZUluU2Vjb25kcy50b1N0cmluZygpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IGVycjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXhlY3V0ZSB0aGUgQXVjdGlvbiBTYWxlXG4gICAqXG4gICAqIEByZW1hcmtzIENsb3NlcyB0aGUgQXVjdGlvbiBhbmQgZXhlY3V0ZXMgdGhlIHNhbGUgZm9yIGJvdGggcGFydGllcy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiAvLyBUaGUgSUQgb2YgdGhlIGF1Y3Rpb24geW91IHdhbnQgdG8gY2xvc2VcbiAgICogY29uc3QgYXVjdGlvbiA9IFwiMFwiO1xuICAgKiBhd2FpdCBjb250cmFjdC5lbmdsaXNoQXVjdGlvbnMuZXhlY3V0ZVNhbGUoYXVjdGlvbklkKTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSBhdWN0aW9uSWQgLSB0aGUgYXVjdGlvbiB0byBjbG9zZVxuICAgKi9cbiAgYXN5bmMgZXhlY3V0ZVNhbGUoYXVjdGlvbklkKSB7XG4gICAgY29uc3QgYXVjdGlvbiA9IGF3YWl0IHRoaXMudmFsaWRhdGVBdWN0aW9uKEJpZ051bWJlci5mcm9tKGF1Y3Rpb25JZCkpO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB3aW5uaW5nQmlkID0gYXdhaXQgdGhpcy5nZXRXaW5uaW5nQmlkKGF1Y3Rpb25JZCk7XG4gICAgICBpbnZhcmlhbnQod2lubmluZ0JpZCwgXCJObyB3aW5uaW5nIGJpZCBmb3VuZFwiKTtcbiAgICAgIGNvbnN0IGNsb3NlRm9yU2VsbGVyID0gdGhpcy5lbmNvZGVyLmVuY29kZShcImNvbGxlY3RBdWN0aW9uUGF5b3V0XCIsIFthdWN0aW9uSWRdKTtcbiAgICAgIGNvbnN0IGNsb3NlRm9yQnV5ZXIgPSB0aGlzLmVuY29kZXIuZW5jb2RlKFwiY29sbGVjdEF1Y3Rpb25Ub2tlbnNcIiwgW2F1Y3Rpb25JZF0pO1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuY29udHJhY3RXcmFwcGVyLm11bHRpQ2FsbChbY2xvc2VGb3JTZWxsZXIsIGNsb3NlRm9yQnV5ZXJdKTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGlmIChlcnIubWVzc2FnZS5pbmNsdWRlcyhcIk1hcmtldHBsYWNlOiBhdWN0aW9uIHN0aWxsIGFjdGl2ZS5cIikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEF1Y3Rpb25IYXNOb3RFbmRlZEVycm9yKGF1Y3Rpb25JZC50b1N0cmluZygpLCBhdWN0aW9uLmVuZFRpbWVJblNlY29uZHMudG9TdHJpbmcoKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgYnVmZmVyIGluIGJhc2lzIHBvaW50cyBiZXR3ZWVuIGJpZHMgZm9yIGFuIGF1Y3Rpb24uXG4gICAqXG4gICAqIEBwYXJhbSBhdWN0aW9uSWQgLSBpZCBvZiB0aGUgYXVjdGlvblxuICAgKi9cbiAgYXN5bmMgZ2V0QmlkQnVmZmVyQnBzKGF1Y3Rpb25JZCkge1xuICAgIHJldHVybiAoYXdhaXQgdGhpcy5nZXRBdWN0aW9uKGF1Y3Rpb25JZCkpLmJpZEJ1ZmZlckJwcztcbiAgfVxuXG4gIC8qKlxuICAgKiByZXR1cm5zIHRoZSBtaW5pbXVtIGJpZCBhIHVzZXIgY2FuIHBsYWNlIHRvIG91dGJpZCB0aGUgcHJldmlvdXMgaGlnaGVzdCBiaWRcbiAgICogQHBhcmFtIGF1Y3Rpb25JZCAtIGlkIG9mIHRoZSBhdWN0aW9uXG4gICAqL1xuICBhc3luYyBnZXRNaW5pbXVtTmV4dEJpZChhdWN0aW9uSWQpIHtcbiAgICAvLyB3ZSBjYW4gZmV0Y2ggYWxsIG9mIHRoZXNlIGF0IHRoZSBzYW1lIHRpbWUgdXNpbmcgcHJvbWlzZS5hbGxcbiAgICBjb25zdCBbY3VycmVudEJpZEJ1ZmZlckJwcywgd2lubmluZ0JpZCwgYXVjdGlvbl0gPSBhd2FpdCBQcm9taXNlLmFsbChbdGhpcy5nZXRCaWRCdWZmZXJCcHMoYXVjdGlvbklkKSwgdGhpcy5nZXRXaW5uaW5nQmlkKGF1Y3Rpb25JZCksIGF3YWl0IHRoaXMudmFsaWRhdGVBdWN0aW9uKEJpZ051bWJlci5mcm9tKGF1Y3Rpb25JZCkpXSk7XG4gICAgY29uc3QgY3VycmVudEJpZE9yUmVzZXJ2ZVByaWNlID0gd2lubmluZ0JpZCA/XG4gICAgLy8gaWYgdGhlcmUgaXMgYSB3aW5uaW5nIGJpZCB1c2UgdGhlIHZhbHVlIG9mIGl0XG4gICAgQmlnTnVtYmVyLmZyb20od2lubmluZ0JpZC5iaWRBbW91bnQpIDpcbiAgICAvLyBpZiB0aGVyZSBpcyBubyB3aW5uaW5nIGJpZCB1c2UgdGhlIHJlc2VydmUgcHJpY2VcbiAgICBCaWdOdW1iZXIuZnJvbShhdWN0aW9uLm1pbmltdW1CaWRBbW91bnQpO1xuICAgIGNvbnN0IG1pbmltdW1OZXh0QmlkID0gY3VycmVudEJpZE9yUmVzZXJ2ZVByaWNlLmFkZChcbiAgICAvLyB0aGUgYWRkaXRpb24gb2YgdGhlIGN1cnJlbnQgYmlkIGFuZCB0aGUgYnVmZmVyXG4gICAgLy8gKGhhdmUgdG8gZGl2aWRlIGJ5IDEwMDAwIHRvIGdldCB0aGUgZnJhY3Rpb24gb2YgdGhlIGJ1ZmZlciAoc2luY2UgaXQncyBpbiBiYXNpcyBwb2ludHMpKVxuICAgIGN1cnJlbnRCaWRPclJlc2VydmVQcmljZS5tdWwoY3VycmVudEJpZEJ1ZmZlckJwcykuZGl2KDEwMDAwKSk7XG5cbiAgICAvLyBpdCdzIG1vcmUgdXNlZnVsIHRvIHJldHVybiBhIGN1cnJlbmN5IHZhbHVlIGhlcmVcbiAgICByZXR1cm4gZmV0Y2hDdXJyZW5jeVZhbHVlKHRoaXMuY29udHJhY3RXcmFwcGVyLmdldFByb3ZpZGVyKCksIGF1Y3Rpb24uY3VycmVuY3lDb250cmFjdEFkZHJlc3MsIG1pbmltdW1OZXh0QmlkKTtcbiAgfVxuXG4gIC8qKiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcbiAgICogUFJJVkFURSBGVU5DVElPTlNcbiAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cbiAgLyoqXG4gICAqIFRocm93cyBlcnJvciBpZiBhdWN0aW9uIGNvdWxkIG5vdCBiZSBmb3VuZFxuICAgKlxuICAgKiBAcGFyYW0gYXVjdGlvbklkIC0gQXVjdGlvbiB0byBjaGVjayBmb3JcbiAgICovXG4gIGFzeW5jIHZhbGlkYXRlQXVjdGlvbihhdWN0aW9uSWQpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0QXVjdGlvbihhdWN0aW9uSWQpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZ2V0dGluZyB0aGUgYXVjdGlvbiB3aXRoIGlkICR7YXVjdGlvbklkfWApO1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBIZWxwZXIgbWV0aG9kIG1hcHMgdGhlIGF1Y3Rpb24gdG8gdGhlIGF1Y3Rpb24gaW50ZXJmYWNlLlxuICAgKlxuICAgKiBAaW50ZXJuYWxcbiAgICogQHBhcmFtIGF1Y3Rpb24gLSBUaGUgYXVjdGlvbiB0byBtYXAsIGFzIHJldHVybmVkIGZyb20gdGhlIGNvbnRyYWN0LlxuICAgKiBAcmV0dXJucyAtIFRoZSBtYXBwZWQgaW50ZXJmYWNlLlxuICAgKi9cbiAgYXN5bmMgbWFwQXVjdGlvbihhdWN0aW9uKSB7XG4gICAgbGV0IHN0YXR1cyA9IFN0YXR1cy5VTlNFVDtcbiAgICBjb25zdCBibG9jayA9IGF3YWl0IHRoaXMuY29udHJhY3RXcmFwcGVyLmdldFByb3ZpZGVyKCkuZ2V0QmxvY2soXCJsYXRlc3RcIik7XG4gICAgY29uc3QgYmxvY2tUaW1lID0gYmxvY2sudGltZXN0YW1wO1xuICAgIHN3aXRjaCAoYXVjdGlvbi5zdGF0dXMpIHtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgc3RhdHVzID0gQmlnTnVtYmVyLmZyb20oYXVjdGlvbi5zdGFydFRpbWVzdGFtcCkuZ3QoYmxvY2tUaW1lKSA/IFN0YXR1cy5DcmVhdGVkIDogQmlnTnVtYmVyLmZyb20oYXVjdGlvbi5lbmRUaW1lc3RhbXApLmx0KGJsb2NrVGltZSkgPyBTdGF0dXMuRXhwaXJlZCA6IFN0YXR1cy5BY3RpdmU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAyOlxuICAgICAgICBzdGF0dXMgPSBTdGF0dXMuQ29tcGxldGVkO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzpcbiAgICAgICAgc3RhdHVzID0gU3RhdHVzLkNhbmNlbGxlZDtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBpZDogYXVjdGlvbi5hdWN0aW9uSWQudG9TdHJpbmcoKSxcbiAgICAgIGNyZWF0b3JBZGRyZXNzOiBhdWN0aW9uLmF1Y3Rpb25DcmVhdG9yLFxuICAgICAgYXNzZXRDb250cmFjdEFkZHJlc3M6IGF1Y3Rpb24uYXNzZXRDb250cmFjdCxcbiAgICAgIHRva2VuSWQ6IGF1Y3Rpb24udG9rZW5JZC50b1N0cmluZygpLFxuICAgICAgcXVhbnRpdHk6IGF1Y3Rpb24ucXVhbnRpdHkudG9TdHJpbmcoKSxcbiAgICAgIGN1cnJlbmN5Q29udHJhY3RBZGRyZXNzOiBhdWN0aW9uLmN1cnJlbmN5LFxuICAgICAgbWluaW11bUJpZEFtb3VudDogYXVjdGlvbi5taW5pbXVtQmlkQW1vdW50LnRvU3RyaW5nKCksXG4gICAgICBtaW5pbXVtQmlkQ3VycmVuY3lWYWx1ZTogYXdhaXQgZmV0Y2hDdXJyZW5jeVZhbHVlKHRoaXMuY29udHJhY3RXcmFwcGVyLmdldFByb3ZpZGVyKCksIGF1Y3Rpb24uY3VycmVuY3ksIGF1Y3Rpb24ubWluaW11bUJpZEFtb3VudCksXG4gICAgICBidXlvdXRCaWRBbW91bnQ6IGF1Y3Rpb24uYnV5b3V0QmlkQW1vdW50LnRvU3RyaW5nKCksXG4gICAgICBidXlvdXRDdXJyZW5jeVZhbHVlOiBhd2FpdCBmZXRjaEN1cnJlbmN5VmFsdWUodGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0UHJvdmlkZXIoKSwgYXVjdGlvbi5jdXJyZW5jeSwgYXVjdGlvbi5idXlvdXRCaWRBbW91bnQpLFxuICAgICAgdGltZUJ1ZmZlckluU2Vjb25kczogQmlnTnVtYmVyLmZyb20oYXVjdGlvbi50aW1lQnVmZmVySW5TZWNvbmRzKS50b051bWJlcigpLFxuICAgICAgYmlkQnVmZmVyQnBzOiBCaWdOdW1iZXIuZnJvbShhdWN0aW9uLmJpZEJ1ZmZlckJwcykudG9OdW1iZXIoKSxcbiAgICAgIHN0YXJ0VGltZUluU2Vjb25kczogQmlnTnVtYmVyLmZyb20oYXVjdGlvbi5zdGFydFRpbWVzdGFtcCkudG9OdW1iZXIoKSxcbiAgICAgIGVuZFRpbWVJblNlY29uZHM6IEJpZ051bWJlci5mcm9tKGF1Y3Rpb24uZW5kVGltZXN0YW1wKS50b051bWJlcigpLFxuICAgICAgYXNzZXQ6IGF3YWl0IGZldGNoVG9rZW5NZXRhZGF0YUZvckNvbnRyYWN0KGF1Y3Rpb24uYXNzZXRDb250cmFjdCwgdGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0UHJvdmlkZXIoKSwgYXVjdGlvbi50b2tlbklkLCB0aGlzLnN0b3JhZ2UpLFxuICAgICAgc3RhdHVzOiBzdGF0dXNcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIE1hcHMgYW4gYXVjdGlvbi1iaWQgdG8gdGhlIHN0cmljdCBpbnRlcmZhY2VcbiAgICpcbiAgICogQGludGVybmFsXG4gICAqIEBwYXJhbSBiaWRcbiAgICogQHJldHVybnMgLSBBIGBCaWRgIG9iamVjdFxuICAgKi9cbiAgYXN5bmMgbWFwQmlkKGF1Y3Rpb25JZCwgYmlkZGVyQWRkcmVzcywgY3VycmVuY3lDb250cmFjdEFkZHJlc3MsIGJpZEFtb3VudCkge1xuICAgIHJldHVybiB7XG4gICAgICBhdWN0aW9uSWQsXG4gICAgICBiaWRkZXJBZGRyZXNzLFxuICAgICAgY3VycmVuY3lDb250cmFjdEFkZHJlc3MsXG4gICAgICBiaWRBbW91bnQsXG4gICAgICBiaWRBbW91bnRDdXJyZW5jeVZhbHVlOiBhd2FpdCBmZXRjaEN1cnJlbmN5VmFsdWUodGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0UHJvdmlkZXIoKSwgY3VycmVuY3lDb250cmFjdEFkZHJlc3MsIGJpZEFtb3VudClcbiAgICB9O1xuICB9XG4gIGFwcGx5RmlsdGVyKGF1Y3Rpb25zLCBmaWx0ZXIpIHtcbiAgICBsZXQgcmF3QXVjdGlvbnMgPSBbLi4uYXVjdGlvbnNdO1xuICAgIGlmIChmaWx0ZXIpIHtcbiAgICAgIGlmIChmaWx0ZXIuc2VsbGVyKSB7XG4gICAgICAgIHJhd0F1Y3Rpb25zID0gcmF3QXVjdGlvbnMuZmlsdGVyKHNlbGxlciA9PiBzZWxsZXIuYXVjdGlvbkNyZWF0b3IudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpID09PSBmaWx0ZXI/LnNlbGxlcj8udG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgIH1cbiAgICAgIGlmIChmaWx0ZXIudG9rZW5Db250cmFjdCkge1xuICAgICAgICByYXdBdWN0aW9ucyA9IHJhd0F1Y3Rpb25zLmZpbHRlcih0b2tlbkNvbnRyYWN0ID0+IHRva2VuQ29udHJhY3QuYXNzZXRDb250cmFjdC50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkgPT09IGZpbHRlcj8udG9rZW5Db250cmFjdD8udG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgIH1cbiAgICAgIGlmIChmaWx0ZXIudG9rZW5JZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHJhd0F1Y3Rpb25zID0gcmF3QXVjdGlvbnMuZmlsdGVyKHRva2VuQ29udHJhY3QgPT4gdG9rZW5Db250cmFjdC50b2tlbklkLnRvU3RyaW5nKCkgPT09IGZpbHRlcj8udG9rZW5JZD8udG9TdHJpbmcoKSk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmaWx0ZXI/LmNvdW50ICYmIGZpbHRlci5jb3VudCA8IHJhd0F1Y3Rpb25zLmxlbmd0aCA/IHJhd0F1Y3Rpb25zLnNsaWNlKDAsIGZpbHRlci5jb3VudCkgOiByYXdBdWN0aW9ucztcbiAgfVxufVxuXG4vKipcbiAqIEBpbnRlcm5hbFxuICovXG5jb25zdCBPZmZlcklucHV0UGFyYW1zU2NoZW1hID0gei5vYmplY3Qoe1xuICAvKipcbiAgICogVGhlIGFkZHJlc3Mgb2YgdGhlIGFzc2V0IGJlaW5nIHNvdWdodC5cbiAgICovXG4gIGFzc2V0Q29udHJhY3RBZGRyZXNzOiBBZGRyZXNzU2NoZW1hLFxuICAvKipcbiAgICogVGhlIElEIG9mIHRoZSB0b2tlbi5cbiAgICovXG4gIHRva2VuSWQ6IEJpZ051bWJlcmlzaFNjaGVtYSxcbiAgLyoqXG4gICAqIFRoZSBxdWFudGl0eSBvZiB0b2tlbnMgdG8gYnV5LlxuICAgKlxuICAgKiBGb3IgRVJDNzIxcywgdGhpcyB2YWx1ZSBzaG91bGQgYWx3YXlzIGJlIDEgKGFuZCB3aWxsIGJlIGZvcmNlZCBpbnRlcm5hbGx5IHJlZ2FyZGxlc3Mgb2Ygd2hhdCBpcyBwYXNzZWQgaGVyZSkuXG4gICAqL1xuICBxdWFudGl0eTogQmlnTnVtYmVyaXNoU2NoZW1hLmRlZmF1bHQoMSksXG4gIC8qKlxuICAgKiBUaGUgYWRkcmVzcyBvZiB0aGUgY3VycmVuY3kgb2ZmZXJlZCBmb3IgdGhlIE5GVHMuXG4gICAqL1xuICBjdXJyZW5jeUNvbnRyYWN0QWRkcmVzczogQWRkcmVzc1NjaGVtYS5kZWZhdWx0KE5BVElWRV9UT0tFTl9BRERSRVNTKSxcbiAgLyoqXG4gICAqIFRoZSB0b3RhbCBvZmZlciBhbW91bnQgZm9yIHRoZSBORlRzLlxuICAgKi9cbiAgdG90YWxQcmljZTogQW1vdW50U2NoZW1hLFxuICAvKipcbiAgICogVGhlIGVuZCB0aW1lIG9mIHRoZSBvZmZlci5cbiAgICovXG4gIGVuZFRpbWVzdGFtcDogRW5kRGF0ZVNjaGVtYVxufSk7XG5cbi8qKlxuICogQHB1YmxpY1xuICovXG5cbi8qKlxuICogSGFuZGxlcyBtYXJrZXRwbGFjZSBvZmZlcnNcbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgTWFya2V0cGxhY2VWM09mZmVycyB7XG4gIC8vIHV0aWxpdGllc1xuXG4gIGNvbnN0cnVjdG9yKGNvbnRyYWN0V3JhcHBlciwgc3RvcmFnZSkge1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImZlYXR1cmVOYW1lXCIsIEZFQVRVUkVfT0ZGRVJTLm5hbWUpO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNvbnRyYWN0V3JhcHBlclwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInN0b3JhZ2VcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJldmVudHNcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJpbnRlcmNlcHRvclwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImVuY29kZXJcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJlc3RpbWF0b3JcIiwgdm9pZCAwKTtcbiAgICB0aGlzLmNvbnRyYWN0V3JhcHBlciA9IGNvbnRyYWN0V3JhcHBlcjtcbiAgICB0aGlzLnN0b3JhZ2UgPSBzdG9yYWdlO1xuICAgIHRoaXMuZXZlbnRzID0gbmV3IENvbnRyYWN0RXZlbnRzKHRoaXMuY29udHJhY3RXcmFwcGVyKTtcbiAgICB0aGlzLmVuY29kZXIgPSBuZXcgQ29udHJhY3RFbmNvZGVyKHRoaXMuY29udHJhY3RXcmFwcGVyKTtcbiAgICB0aGlzLmludGVyY2VwdG9yID0gbmV3IENvbnRyYWN0SW50ZXJjZXB0b3IodGhpcy5jb250cmFjdFdyYXBwZXIpO1xuICAgIHRoaXMuZXN0aW1hdG9yID0gbmV3IEdhc0Nvc3RFc3RpbWF0b3IodGhpcy5jb250cmFjdFdyYXBwZXIpO1xuICB9XG4gIGdldEFkZHJlc3MoKSB7XG4gICAgcmV0dXJuIHRoaXMuY29udHJhY3RXcmFwcGVyLnJlYWRDb250cmFjdC5hZGRyZXNzO1xuICB9XG5cbiAgLyoqICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgKiBSRUFEIEZVTkNUSU9OU1xuICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAvKipcbiAgICogR2V0IHRoZSB0b3RhbCBudW1iZXIgb2Ygb2ZmZXJzXG4gICAqIEByZXR1cm5zIFJldHVybnMgdGhlIHRvdGFsIG51bWJlciBvZiBvZmZlcnMgY3JlYXRlZC5cbiAgICogQHB1YmxpY1xuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIGNvbnN0IHRvdGFsT2ZmZXJzID0gYXdhaXQgY29udHJhY3Qub2ZmZXJzLmdldFRvdGFsQ291bnQoKTtcbiAgICogYGBgXG4gICAqL1xuICBhc3luYyBnZXRUb3RhbENvdW50KCkge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5yZWFkQ29udHJhY3QudG90YWxPZmZlcnMoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgYWxsIG9mZmVycy5cbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiBjb25zdCBvZmZlcnMgPSBhd2FpdCBjb250cmFjdC5vZmZlcnMuZ2V0QWxsKCk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gZmlsdGVyIC0gb3B0aW9uYWwgZmlsdGVyIHBhcmFtZXRlcnNcbiAgICogQHJldHVybnMgdGhlIE9mZmVyIG9iamVjdCBhcnJheVxuICAgKi9cbiAgYXN5bmMgZ2V0QWxsKGZpbHRlcikge1xuICAgIGNvbnN0IHRvdGFsT2ZmZXJzID0gYXdhaXQgdGhpcy5nZXRUb3RhbENvdW50KCk7XG4gICAgbGV0IHN0YXJ0ID0gQmlnTnVtYmVyLmZyb20oZmlsdGVyPy5zdGFydCB8fCAwKS50b051bWJlcigpO1xuICAgIGxldCBlbmQgPSB0b3RhbE9mZmVycy50b051bWJlcigpO1xuICAgIGlmIChlbmQgPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gb2ZmZXJzIGV4aXN0IG9uIHRoZSBjb250cmFjdC5gKTtcbiAgICB9XG4gICAgbGV0IHJhd09mZmVycyA9IFtdO1xuICAgIGxldCBiYXRjaGVzID0gYXdhaXQgZ2V0QWxsSW5CYXRjaGVzKHN0YXJ0LCBlbmQsIHRoaXMuY29udHJhY3RXcmFwcGVyLnJlYWRDb250cmFjdC5nZXRBbGxPZmZlcnMpO1xuICAgIHJhd09mZmVycyA9IGJhdGNoZXMuZmxhdCgpO1xuICAgIGNvbnN0IGZpbHRlcmVkT2ZmZXJzID0gdGhpcy5hcHBseUZpbHRlcihyYXdPZmZlcnMsIGZpbHRlcik7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UuYWxsKGZpbHRlcmVkT2ZmZXJzLm1hcChvZmZlciA9PiB0aGlzLm1hcE9mZmVyKG9mZmVyKSkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBhbGwgdmFsaWQgb2ZmZXJzLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIGNvbnN0IG9mZmVycyA9IGF3YWl0IGNvbnRyYWN0Lm9mZmVycy5nZXRBbGxWYWxpZCgpO1xuICAgKiBgYGBcbiAgICpcbiAgICogQHBhcmFtIGZpbHRlciAtIG9wdGlvbmFsIGZpbHRlciBwYXJhbWV0ZXJzXG4gICAqIEByZXR1cm5zIHRoZSBPZmZlciBvYmplY3QgYXJyYXlcbiAgICovXG4gIGFzeW5jIGdldEFsbFZhbGlkKGZpbHRlcikge1xuICAgIGNvbnN0IHRvdGFsT2ZmZXJzID0gYXdhaXQgdGhpcy5nZXRUb3RhbENvdW50KCk7XG4gICAgbGV0IHN0YXJ0ID0gQmlnTnVtYmVyLmZyb20oZmlsdGVyPy5zdGFydCB8fCAwKS50b051bWJlcigpO1xuICAgIGxldCBlbmQgPSB0b3RhbE9mZmVycy50b051bWJlcigpO1xuICAgIGlmIChlbmQgPT09IDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgTm8gb2ZmZXJzIGV4aXN0IG9uIHRoZSBjb250cmFjdC5gKTtcbiAgICB9XG4gICAgbGV0IHJhd09mZmVycyA9IFtdO1xuICAgIGxldCBiYXRjaGVzID0gYXdhaXQgZ2V0QWxsSW5CYXRjaGVzKHN0YXJ0LCBlbmQsIHRoaXMuY29udHJhY3RXcmFwcGVyLnJlYWRDb250cmFjdC5nZXRBbGxWYWxpZE9mZmVycyk7XG4gICAgcmF3T2ZmZXJzID0gYmF0Y2hlcy5mbGF0KCk7XG4gICAgY29uc3QgZmlsdGVyZWRPZmZlcnMgPSB0aGlzLmFwcGx5RmlsdGVyKHJhd09mZmVycywgZmlsdGVyKTtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5hbGwoZmlsdGVyZWRPZmZlcnMubWFwKG9mZmVyID0+IHRoaXMubWFwT2ZmZXIob2ZmZXIpKSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGEgb2ZmZXIgYnkgaWRcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiBjb25zdCBvZmZlcklkID0gMDtcbiAgICogY29uc3Qgb2ZmZXIgPSBhd2FpdCBjb250cmFjdC5vZmZlcnMuZ2V0T2ZmZXIob2ZmZXJJZCk7XG4gICAqIGBgYFxuICAgKlxuICAgKiBAcGFyYW0gb2ZmZXJJZCAtIHRoZSBsaXN0aW5nIGlkXG4gICAqIEByZXR1cm5zIHRoZSBEaXJlY3QgbGlzdGluZyBvYmplY3RcbiAgICovXG4gIGFzeW5jIGdldE9mZmVyKG9mZmVySWQpIHtcbiAgICBjb25zdCBvZmZlciA9IGF3YWl0IHRoaXMuY29udHJhY3RXcmFwcGVyLnJlYWRDb250cmFjdC5nZXRPZmZlcihvZmZlcklkKTtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy5tYXBPZmZlcihvZmZlcik7XG4gIH1cblxuICAvKiogKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAqIFdSSVRFIEZVTkNUSU9OU1xuICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAvKipcbiAgICogTWFrZSBPZmZlclxuICAgKlxuICAgKiBAcmVtYXJrcyBNYWtlIGFuIG9mZmVyIG9uIHRoZSBtYXJrZXRwbGFjZSBmb3IgYW4gYXNzZXQuXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGphdmFzY3JpcHRcbiAgICogLy8gRGF0YSBvZiB0aGUgb2ZmZXIgeW91IHdhbnQgdG8gbWFrZVxuICAgKiBjb25zdCBvZmZlciA9IHtcbiAgICogICAvLyBhZGRyZXNzIG9mIHRoZSBjb250cmFjdCB0aGUgYXNzZXQgeW91IHdhbnQgdG8gbWFrZSBhbiBvZmZlciBmb3JcbiAgICogICBhc3NldENvbnRyYWN0QWRkcmVzczogXCIweC4uLlwiLFxuICAgKiAgIC8vIHRva2VuIElEIG9mIHRoZSBhc3NldCB5b3Ugd2FudCB0byBidXlcbiAgICogICB0b2tlbklkOiBcIjBcIixcbiAgICogICAvLyBob3cgbWFueSBvZiB0aGUgYXNzZXQgeW91IHdhbnQgdG8gYnV5XG4gICAqICAgcXVhbnRpdHk6IDEsXG4gICAqICAgLy8gYWRkcmVzcyBvZiB0aGUgY3VycmVuY3kgY29udHJhY3QgdGhhdCB5b3Ugb2ZmZXIgdG8gcGF5IGluXG4gICAqICAgY3VycmVuY3lDb250cmFjdEFkZHJlc3M6IE5BVElWRV9UT0tFTl9BRERSRVNTLFxuICAgKiAgIC8vIFRvdGFsIHByaWNlIHlvdSBvZmZlciB0byBwYXkgZm9yIHRoZSBtZW50aW9uZWQgdG9rZW4ocylcbiAgICogICB0b3RhbFByaWNlOiBcIjEuNVwiLFxuICAgKiAgIC8vIE9mZmVyIHZhbGlkIHVudGlsXG4gICAqICAgZW5kVGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgKiB9XG4gICAqXG4gICAqIGNvbnN0IHR4ID0gYXdhaXQgY29udHJhY3Qub2ZmZXJzLm1ha2VPZmZlcihvZmZlcik7XG4gICAqIGNvbnN0IHJlY2VpcHQgPSB0eC5yZWNlaXB0OyAvLyB0aGUgdHJhbnNhY3Rpb24gcmVjZWlwdFxuICAgKiBjb25zdCBpZCA9IHR4LmlkOyAvLyB0aGUgaWQgb2YgdGhlIG5ld2x5IGNyZWF0ZWQgb2ZmZXJcbiAgICogYGBgXG4gICAqL1xuICBhc3luYyBtYWtlT2ZmZXIob2ZmZXIpIHtcbiAgICBjb25zdCBwYXJzZWRPZmZlciA9IE9mZmVySW5wdXRQYXJhbXNTY2hlbWEucGFyc2Uob2ZmZXIpO1xuICAgIGNvbnN0IGNoYWluSWQgPSBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5nZXRDaGFpbklEKCk7XG4gICAgY29uc3QgY3VycmVuY3kgPSBpc05hdGl2ZVRva2VuKHBhcnNlZE9mZmVyLmN1cnJlbmN5Q29udHJhY3RBZGRyZXNzKSA/IE5BVElWRV9UT0tFTlNbY2hhaW5JZF0ud3JhcHBlZC5hZGRyZXNzIDogcGFyc2VkT2ZmZXIuY3VycmVuY3lDb250cmFjdEFkZHJlc3M7XG4gICAgY29uc3Qgbm9ybWFsaXplZFRvdGFsUHJpY2UgPSBhd2FpdCBub3JtYWxpemVQcmljZVZhbHVlKHRoaXMuY29udHJhY3RXcmFwcGVyLmdldFByb3ZpZGVyKCksIHBhcnNlZE9mZmVyLnRvdGFsUHJpY2UsIGN1cnJlbmN5KTtcbiAgICBjb25zdCBvdmVycmlkZXMgPSBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5nZXRDYWxsT3ZlcnJpZGVzKCk7XG4gICAgYXdhaXQgc2V0RXJjMjBBbGxvd2FuY2UodGhpcy5jb250cmFjdFdyYXBwZXIsIG5vcm1hbGl6ZWRUb3RhbFByaWNlLCBjdXJyZW5jeSwgb3ZlcnJpZGVzKTtcbiAgICBjb25zdCByZWNlaXB0ID0gYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIuc2VuZFRyYW5zYWN0aW9uKFwibWFrZU9mZmVyXCIsIFt7XG4gICAgICBhc3NldENvbnRyYWN0OiBwYXJzZWRPZmZlci5hc3NldENvbnRyYWN0QWRkcmVzcyxcbiAgICAgIHRva2VuSWQ6IHBhcnNlZE9mZmVyLnRva2VuSWQsXG4gICAgICBxdWFudGl0eTogcGFyc2VkT2ZmZXIucXVhbnRpdHksXG4gICAgICBjdXJyZW5jeTogY3VycmVuY3ksXG4gICAgICB0b3RhbFByaWNlOiBub3JtYWxpemVkVG90YWxQcmljZSxcbiAgICAgIGV4cGlyYXRpb25UaW1lc3RhbXA6IHBhcnNlZE9mZmVyLmVuZFRpbWVzdGFtcFxuICAgIH1dLCB7XG4gICAgICAvLyBIaWdoZXIgZ2FzIGxpbWl0IGZvciBjcmVhdGUgbGlzdGluZ1xuICAgICAgZ2FzTGltaXQ6IDUwMDAwMFxuICAgIH0pO1xuICAgIGNvbnN0IGV2ZW50ID0gdGhpcy5jb250cmFjdFdyYXBwZXIucGFyc2VMb2dzKFwiTmV3T2ZmZXJcIiwgcmVjZWlwdD8ubG9ncyk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBldmVudFswXS5hcmdzLm9mZmVySWQsXG4gICAgICByZWNlaXB0XG4gICAgfTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYW5jZWwgT2ZmZXJcbiAgICpcbiAgICogQHJlbWFya3MgQ2FuY2VsIGFuIG9mZmVyIG9uIHRoZSBtYXJrZXRwbGFjZVxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiBgYGBqYXZhc2NyaXB0XG4gICAqIC8vIFRoZSBJRCBvZiB0aGUgb2ZmZXIgeW91IHdhbnQgdG8gY2FuY2VsXG4gICAqIGNvbnN0IG9mZmVySWQgPSBcIjBcIjtcbiAgICpcbiAgICogYXdhaXQgY29udHJhY3Qub2ZmZXJzLmNhbmNlbE9mZmVyKG9mZmVySWQpO1xuICAgKiBgYGBcbiAgICovXG4gIGFzeW5jIGNhbmNlbE9mZmVyKG9mZmVySWQpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcmVjZWlwdDogYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIuc2VuZFRyYW5zYWN0aW9uKFwiY2FuY2VsT2ZmZXJcIiwgW29mZmVySWRdKVxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogQWNjZXB0IGFuIG9mZmVyXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGphdmFzY3JpcHRcbiAgICogLy8gVGhlIElEIG9mIHRoZSBvZmZlciB5b3Ugd2FudCB0byBhY2NlcHRcbiAgICogY29uc3Qgb2ZmZXJJZCA9IDA7XG4gICAqXG4gICAqIGF3YWl0IGNvbnRyYWN0Lm9mZmVycy5hY2NlcHRPZmZlcihvZmZlcklkKTtcbiAgICogYGBgXG4gICAqXG4gICAqIEBwYXJhbSBvZmZlcklkIC0gVGhlIG9mZmVyIGlkXG4gICAqL1xuICBhc3luYyBhY2NlcHRPZmZlcihvZmZlcklkKSB7XG4gICAgY29uc3Qgb2ZmZXIgPSBhd2FpdCB0aGlzLnZhbGlkYXRlT2ZmZXIoQmlnTnVtYmVyLmZyb20ob2ZmZXJJZCkpO1xuICAgIGNvbnN0IHtcbiAgICAgIHZhbGlkLFxuICAgICAgZXJyb3JcbiAgICB9ID0gYXdhaXQgdGhpcy5pc1N0aWxsVmFsaWRPZmZlcihvZmZlcik7XG4gICAgaWYgKCF2YWxpZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBPZmZlciAke29mZmVySWR9IGlzIG5vIGxvbmdlciB2YWxpZC4gJHtlcnJvcn1gKTtcbiAgICB9XG4gICAgY29uc3Qgb3ZlcnJpZGVzID0gKGF3YWl0IHRoaXMuY29udHJhY3RXcmFwcGVyLmdldENhbGxPdmVycmlkZXMoKSkgfHwge307XG4gICAgYXdhaXQgaGFuZGxlVG9rZW5BcHByb3ZhbCh0aGlzLmNvbnRyYWN0V3JhcHBlciwgdGhpcy5nZXRBZGRyZXNzKCksIG9mZmVyLmFzc2V0Q29udHJhY3RBZGRyZXNzLCBvZmZlci50b2tlbklkLCBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5nZXRTaWduZXJBZGRyZXNzKCkpO1xuICAgIHJldHVybiB7XG4gICAgICByZWNlaXB0OiBhd2FpdCB0aGlzLmNvbnRyYWN0V3JhcHBlci5zZW5kVHJhbnNhY3Rpb24oXCJhY2NlcHRPZmZlclwiLCBbb2ZmZXJJZF0sIG92ZXJyaWRlcylcbiAgICB9O1xuICB9XG5cbiAgLyoqICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgKiBQUklWQVRFIEZVTkNUSU9OU1xuICAgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cblxuICAvKipcbiAgICogVGhyb3dzIGVycm9yIGlmIG9mZmVyIGNvdWxkIG5vdCBiZSBmb3VuZFxuICAgKlxuICAgKiBAcGFyYW0gb2ZmZXJJZCAtIG9mZmVyIHRvIGNoZWNrIGZvclxuICAgKi9cbiAgYXN5bmMgdmFsaWRhdGVPZmZlcihvZmZlcklkKSB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLmdldE9mZmVyKG9mZmVySWQpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZ2V0dGluZyB0aGUgb2ZmZXIgd2l0aCBpZCAke29mZmVySWR9YCk7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhlbHBlciBtZXRob2QgbWFwcyB0aGUgb2ZmZXIgdG8gdGhlIG9mZmVyIGludGVyZmFjZS5cbiAgICpcbiAgICogQGludGVybmFsXG4gICAqIEBwYXJhbSBvZmZlciAtIFRoZSBvZmZlciB0byBtYXAsIGFzIHJldHVybmVkIGZyb20gdGhlIGNvbnRyYWN0LlxuICAgKiBAcmV0dXJucyAtIFRoZSBtYXBwZWQgaW50ZXJmYWNlLlxuICAgKi9cbiAgYXN5bmMgbWFwT2ZmZXIob2ZmZXIpIHtcbiAgICBsZXQgc3RhdHVzID0gU3RhdHVzLlVOU0VUO1xuICAgIGNvbnN0IGJsb2NrID0gYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0UHJvdmlkZXIoKS5nZXRCbG9jayhcImxhdGVzdFwiKTtcbiAgICBjb25zdCBibG9ja1RpbWUgPSBibG9jay50aW1lc3RhbXA7XG4gICAgc3dpdGNoIChvZmZlci5zdGF0dXMpIHtcbiAgICAgIGNhc2UgMTpcbiAgICAgICAgc3RhdHVzID0gQmlnTnVtYmVyLmZyb20ob2ZmZXIuZXhwaXJhdGlvblRpbWVzdGFtcCkubHQoYmxvY2tUaW1lKSA/IFN0YXR1cy5FeHBpcmVkIDogU3RhdHVzLkFjdGl2ZTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIDI6XG4gICAgICAgIHN0YXR1cyA9IFN0YXR1cy5Db21wbGV0ZWQ7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAzOlxuICAgICAgICBzdGF0dXMgPSBTdGF0dXMuQ2FuY2VsbGVkO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGlkOiBvZmZlci5vZmZlcklkLnRvU3RyaW5nKCksXG4gICAgICBvZmZlcm9yQWRkcmVzczogb2ZmZXIub2ZmZXJvcixcbiAgICAgIGFzc2V0Q29udHJhY3RBZGRyZXNzOiBvZmZlci5hc3NldENvbnRyYWN0LFxuICAgICAgY3VycmVuY3lDb250cmFjdEFkZHJlc3M6IG9mZmVyLmN1cnJlbmN5LFxuICAgICAgdG9rZW5JZDogb2ZmZXIudG9rZW5JZC50b1N0cmluZygpLFxuICAgICAgcXVhbnRpdHk6IG9mZmVyLnF1YW50aXR5LnRvU3RyaW5nKCksXG4gICAgICB0b3RhbFByaWNlOiBvZmZlci50b3RhbFByaWNlLnRvU3RyaW5nKCksXG4gICAgICBjdXJyZW5jeVZhbHVlOiBhd2FpdCBmZXRjaEN1cnJlbmN5VmFsdWUodGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0UHJvdmlkZXIoKSwgb2ZmZXIuY3VycmVuY3ksIG9mZmVyLnRvdGFsUHJpY2UpLFxuICAgICAgYXNzZXQ6IGF3YWl0IGZldGNoVG9rZW5NZXRhZGF0YUZvckNvbnRyYWN0KG9mZmVyLmFzc2V0Q29udHJhY3QsIHRoaXMuY29udHJhY3RXcmFwcGVyLmdldFByb3ZpZGVyKCksIG9mZmVyLnRva2VuSWQsIHRoaXMuc3RvcmFnZSksXG4gICAgICBlbmRUaW1lSW5TZWNvbmRzOiBCaWdOdW1iZXIuZnJvbShvZmZlci5leHBpcmF0aW9uVGltZXN0YW1wKS50b051bWJlcigpLFxuICAgICAgc3RhdHVzOiBzdGF0dXNcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFVzZSB0aGlzIG1ldGhvZCB0byBjaGVjayBpZiBhbiBvZmZlciBpcyBzdGlsbCB2YWxpZC5cbiAgICpcbiAgICogV2F5cyBhbiBvZmZlciBjYW4gYmVjb21lIGludmFsaWQ6XG4gICAqIDEuIFRoZSBvZmZlciBoYXMgZXhwaXJlZFxuICAgKiAyLiBUaGUgb2ZmZXJvciBkb2Vzbid0IGhhdmUgZW5vdWdoIGJhbGFuY2Ugb2YgY3VycmVuY3kgdG9rZW5zXG4gICAqIDMuIFRoZSBvZmZlcm9yIHJlbW92ZWQgdGhlIGFwcHJvdmFsIG9mIGN1cnJlbmN5IHRva2VucyBvbiB0aGUgbWFya2V0cGxhY2VcbiAgICpcbiAgICogQGludGVybmFsXG4gICAqIEBwYXJhbSBvZmZlciAtIFRoZSBvZmZlciB0byBjaGVjay5cbiAgICogQHJldHVybnMgLSBUcnVlIGlmIHRoZSBvZmZlciBpcyB2YWxpZCwgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgKi9cbiAgYXN5bmMgaXNTdGlsbFZhbGlkT2ZmZXIob2ZmZXIpIHtcbiAgICBjb25zdCBub3cgPSBCaWdOdW1iZXIuZnJvbShNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSk7XG4gICAgaWYgKG5vdy5ndChvZmZlci5lbmRUaW1lSW5TZWNvbmRzKSkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgICBlcnJvcjogYE9mZmVyIHdpdGggSUQgJHtvZmZlci5pZH0gaGFzIGV4cGlyZWRgXG4gICAgICB9O1xuICAgIH1cbiAgICBjb25zdCBjaGFpbklkID0gYXdhaXQgdGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0Q2hhaW5JRCgpO1xuICAgIGNvbnN0IGN1cnJlbmN5ID0gaXNOYXRpdmVUb2tlbihvZmZlci5jdXJyZW5jeUNvbnRyYWN0QWRkcmVzcykgPyBOQVRJVkVfVE9LRU5TW2NoYWluSWRdLndyYXBwZWQuYWRkcmVzcyA6IG9mZmVyLmN1cnJlbmN5Q29udHJhY3RBZGRyZXNzO1xuICAgIGNvbnN0IHByb3ZpZGVyID0gdGhpcy5jb250cmFjdFdyYXBwZXIuZ2V0UHJvdmlkZXIoKTtcbiAgICBjb25zdCBlcmMyMCA9IG5ldyBDb250cmFjdFdyYXBwZXIocHJvdmlkZXIsIGN1cnJlbmN5LCBFUkMyMEFiaSwge30pO1xuICAgIGNvbnN0IG9mZmVyb3JCYWxhbmNlID0gYXdhaXQgZXJjMjAucmVhZENvbnRyYWN0LmJhbGFuY2VPZihvZmZlci5vZmZlcm9yQWRkcmVzcyk7XG4gICAgaWYgKG9mZmVyb3JCYWxhbmNlLmx0KG9mZmVyLnRvdGFsUHJpY2UpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiBgT2ZmZXJvciAke29mZmVyLm9mZmVyb3JBZGRyZXNzfSBkb2Vzbid0IGhhdmUgZW5vdWdoIGJhbGFuY2Ugb2YgdG9rZW4gJHtjdXJyZW5jeX1gXG4gICAgICB9O1xuICAgIH1cbiAgICBjb25zdCBvZmZlcm9yQWxsb3dhbmNlID0gYXdhaXQgZXJjMjAucmVhZENvbnRyYWN0LmFsbG93YW5jZShvZmZlci5vZmZlcm9yQWRkcmVzcywgdGhpcy5nZXRBZGRyZXNzKCkpO1xuICAgIGlmIChvZmZlcm9yQWxsb3dhbmNlLmx0KG9mZmVyLnRvdGFsUHJpY2UpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiBgT2ZmZXJvciAke29mZmVyLm9mZmVyb3JBZGRyZXNzfSBoYXNuJ3QgYXBwcm92ZWQgZW5vdWdoIGFtb3VudCBvZiB0b2tlbiAke2N1cnJlbmN5fWBcbiAgICAgIH07XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICB2YWxpZDogdHJ1ZSxcbiAgICAgIGVycm9yOiBcIlwiXG4gICAgfTtcbiAgfVxuICBhcHBseUZpbHRlcihvZmZlcnMsIGZpbHRlcikge1xuICAgIGxldCByYXdPZmZlcnMgPSBbLi4ub2ZmZXJzXTtcbiAgICBpZiAoZmlsdGVyKSB7XG4gICAgICBpZiAoZmlsdGVyLm9mZmVyb3IpIHtcbiAgICAgICAgcmF3T2ZmZXJzID0gcmF3T2ZmZXJzLmZpbHRlcihvZmZlcm9yID0+IG9mZmVyb3Iub2ZmZXJvci50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkgPT09IGZpbHRlcj8ub2ZmZXJvcj8udG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpKTtcbiAgICAgIH1cbiAgICAgIGlmIChmaWx0ZXIudG9rZW5Db250cmFjdCkge1xuICAgICAgICByYXdPZmZlcnMgPSByYXdPZmZlcnMuZmlsdGVyKHRva2VuQ29udHJhY3QgPT4gdG9rZW5Db250cmFjdC5hc3NldENvbnRyYWN0LnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKSA9PT0gZmlsdGVyPy50b2tlbkNvbnRyYWN0Py50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgfVxuICAgICAgaWYgKGZpbHRlci50b2tlbklkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmF3T2ZmZXJzID0gcmF3T2ZmZXJzLmZpbHRlcih0b2tlbkNvbnRyYWN0ID0+IHRva2VuQ29udHJhY3QudG9rZW5JZC50b1N0cmluZygpID09PSBmaWx0ZXI/LnRva2VuSWQ/LnRvU3RyaW5nKCkpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmlsdGVyPy5jb3VudCAmJiBmaWx0ZXIuY291bnQgPCByYXdPZmZlcnMubGVuZ3RoID8gcmF3T2ZmZXJzLnNsaWNlKDAsIGZpbHRlci5jb3VudCkgOiByYXdPZmZlcnM7XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgeW91ciBvd24gd2hpdGVsYWJlbCBtYXJrZXRwbGFjZSB0aGF0IGVuYWJsZXMgdXNlcnMgdG8gYnV5IGFuZCBzZWxsIGFueSBkaWdpdGFsIGFzc2V0cy5cbiAqXG4gKiBAZXhhbXBsZVxuICpcbiAqIGBgYGphdmFzY3JpcHRcbiAqIGltcG9ydCB7IFRoaXJkd2ViU0RLIH0gZnJvbSBcIkB0aGlyZHdlYi1kZXYvc2RrXCI7XG4gKlxuICogY29uc3Qgc2RrID0gbmV3IFRoaXJkd2ViU0RLKFwie3tjaGFpbk5hbWV9fVwiKTtcbiAqIGNvbnN0IGNvbnRyYWN0ID0gYXdhaXQgc2RrLmdldENvbnRyYWN0KFwie3tjb250cmFjdF9hZGRyZXNzfX1cIiwgXCJtYXJrZXRwbGFjZVwiKTtcbiAqIGBgYFxuICpcbiAqIEBwdWJsaWNcbiAqL1xuY2xhc3MgTWFya2V0cGxhY2VWMyB7XG4gIC8qKlxuICAgKiBAaW50ZXJuYWxcbiAgICovXG5cbiAgLyoqXG4gICAqIERpcmVjdCBsaXN0aW5nc1xuICAgKiBAcmVtYXJrcyBDcmVhdGUgYW5kIG1hbmFnZSBkaXJlY3QgbGlzdGluZ3MgaW4geW91ciBtYXJrZXRwbGFjZS5cbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiAvLyBEYXRhIG9mIHRoZSBsaXN0aW5nIHlvdSB3YW50IHRvIGNyZWF0ZVxuICAgKiBjb25zdCBsaXN0aW5nID0ge1xuICAgKiAgIC8vIGFkZHJlc3Mgb2YgdGhlIGNvbnRyYWN0IHRoZSBhc3NldCB5b3Ugd2FudCB0byBsaXN0IGlzIG9uXG4gICAqICAgYXNzZXRDb250cmFjdEFkZHJlc3M6IFwiMHguLi5cIixcbiAgICogICAvLyB0b2tlbiBJRCBvZiB0aGUgYXNzZXQgeW91IHdhbnQgdG8gbGlzdFxuICAgKiAgIHRva2VuSWQ6IFwiMFwiLFxuICAgKiAgIC8vIGhvdyBtYW55IG9mIHRoZSBhc3NldCB5b3Ugd2FudCB0byBsaXN0XG4gICAqICAgcXVhbnRpdHk6IDEsXG4gICAqICAgLy8gYWRkcmVzcyBvZiB0aGUgY3VycmVuY3kgY29udHJhY3QgdGhhdCB3aWxsIGJlIHVzZWQgdG8gcGF5IGZvciB0aGUgbGlzdGluZ1xuICAgKiAgIGN1cnJlbmN5Q29udHJhY3RBZGRyZXNzOiBOQVRJVkVfVE9LRU5fQUREUkVTUyxcbiAgICogICAvLyBUaGUgcHJpY2UgdG8gcGF5IHBlciB1bml0IG9mIE5GVHMgbGlzdGVkLlxuICAgKiAgIHByaWNlUGVyVG9rZW46IDEuNSxcbiAgICogICAvLyB3aGVuIHNob3VsZCB0aGUgbGlzdGluZyBvcGVuIHVwIGZvciBvZmZlcnNcbiAgICogICBzdGFydFRpbWVzdGFtcDogbmV3IERhdGUoRGF0ZS5ub3coKSksXG4gICAqICAgLy8gaG93IGxvbmcgdGhlIGxpc3Rpbmcgd2lsbCBiZSBvcGVuIGZvclxuICAgKiAgIGVuZFRpbWVzdGFtcDogbmV3IERhdGUoRGF0ZS5ub3coKSArIDUgKiAyNCAqIDYwICogNjAgKiAxMDAwKSxcbiAgICogICAvLyBXaGV0aGVyIHRoZSBsaXN0aW5nIGlzIHJlc2VydmVkIGZvciBhIHNwZWNpZmljIHNldCBvZiBidXllcnMuXG4gICAqICAgaXNSZXNlcnZlZExpc3Rpbmc6IGZhbHNlXG4gICAqIH1cbiAgICpcbiAgICogY29uc3QgdHggPSBhd2FpdCBjb250cmFjdC5kaXJlY3RMaXN0aW5ncy5jcmVhdGVMaXN0aW5nKGxpc3RpbmcpO1xuICAgKiBjb25zdCByZWNlaXB0ID0gdHgucmVjZWlwdDsgLy8gdGhlIHRyYW5zYWN0aW9uIHJlY2VpcHRcbiAgICogY29uc3QgaWQgPSB0eC5pZDsgLy8gdGhlIGlkIG9mIHRoZSBuZXdseSBjcmVhdGVkIGxpc3RpbmdcbiAgICpcbiAgICogLy8gQW5kIG9uIHRoZSBidXllcnMgc2lkZTpcbiAgICogLy8gVGhlIElEIG9mIHRoZSBsaXN0aW5nIHlvdSB3YW50IHRvIGJ1eSBmcm9tXG4gICAqIGNvbnN0IGxpc3RpbmdJZCA9IDA7XG4gICAqIC8vIFF1YW50aXR5IG9mIHRoZSBhc3NldCB5b3Ugd2FudCB0byBidXlcbiAgICogY29uc3QgcXVhbnRpdHlEZXNpcmVkID0gMTtcbiAgICpcbiAgICogYXdhaXQgY29udHJhY3QuZGlyZWN0TGlzdGluZ3MuYnV5RnJvbUxpc3RpbmcobGlzdGluZ0lkLCBxdWFudGl0eURlc2lyZWQpO1xuICAgKiBgYGBcbiAgICovXG4gIGdldCBkaXJlY3RMaXN0aW5ncygpIHtcbiAgICByZXR1cm4gYXNzZXJ0RW5hYmxlZCh0aGlzLmRldGVjdERpcmVjdExpc3RpbmdzKCksIEZFQVRVUkVfRElSRUNUX0xJU1RJTkdTKTtcbiAgfVxuICAvKipcbiAgICogQXVjdGlvbnNcbiAgICogQHJlbWFya3MgQ3JlYXRlIGFuZCBtYW5hZ2UgYXVjdGlvbnMgaW4geW91ciBtYXJrZXRwbGFjZS5cbiAgICogQGV4YW1wbGVcbiAgICogYGBgamF2YXNjcmlwdFxuICAgKiAvLyBEYXRhIG9mIHRoZSBhdWN0aW9uIHlvdSB3YW50IHRvIGNyZWF0ZVxuICAgKiBjb25zdCBhdWN0aW9uID0ge1xuICAgKiAgIC8vIGFkZHJlc3Mgb2YgdGhlIGNvbnRyYWN0IG9mIHRoZSBhc3NldCB5b3Ugd2FudCB0byBhdWN0aW9uXG4gICAqICAgYXNzZXRDb250cmFjdEFkZHJlc3M6IFwiMHguLi5cIixcbiAgICogICAvLyB0b2tlbiBJRCBvZiB0aGUgYXNzZXQgeW91IHdhbnQgdG8gYXVjdGlvblxuICAgKiAgIHRva2VuSWQ6IFwiMFwiLFxuICAgKiAgIC8vIGhvdyBtYW55IG9mIHRoZSBhc3NldCB5b3Ugd2FudCB0byBhdWN0aW9uXG4gICAqICAgcXVhbnRpdHk6IDEsXG4gICAqICAgLy8gYWRkcmVzcyBvZiB0aGUgY3VycmVuY3kgY29udHJhY3QgdGhhdCB3aWxsIGJlIHVzZWQgdG8gcGF5IGZvciB0aGUgYXVjdGlvbmVkIHRva2Vuc1xuICAgKiAgIGN1cnJlbmN5Q29udHJhY3RBZGRyZXNzOiBOQVRJVkVfVE9LRU5fQUREUkVTUyxcbiAgICogICAvLyB0aGUgbWluaW11bSBiaWQgdGhhdCB3aWxsIGJlIGFjY2VwdGVkIGZvciB0aGUgdG9rZW5cbiAgICogICBtaW5pbXVtQmlkQW1vdW50OiBcIjEuNVwiLFxuICAgKiAgIC8vIGhvdyBtdWNoIHBlb3BsZSB3b3VsZCBoYXZlIHRvIGJpZCB0byBpbnN0YW50bHkgYnV5IHRoZSBhc3NldFxuICAgKiAgIGJ1eW91dEJpZEFtb3VudDogXCIxMFwiLFxuICAgKiAgIC8vIElmIGEgYmlkIGlzIG1hZGUgbGVzcyB0aGFuIHRoZXNlIG1hbnkgc2Vjb25kcyBiZWZvcmUgZXhwaXJhdGlvbiwgdGhlIGV4cGlyYXRpb24gdGltZSBpcyBpbmNyZWFzZWQgYnkgdGhpcy5cbiAgICogICB0aW1lQnVmZmVySW5TZWNvbmRzOiBcIjEwMDBcIixcbiAgICogICAvLyBBIGJpZCBtdXN0IGJlIGF0IGxlYXN0IHRoaXMgbXVjaCBicHMgZ3JlYXRlciB0aGFuIHRoZSBjdXJyZW50IHdpbm5pbmcgYmlkXG4gICAqICAgYmlkQnVmZmVyQnBzOiBcIjEwMFwiLCAvLyAxMDAgYnBzIHN0YW5kcyBmb3IgMSVcbiAgICogICAvLyB3aGVuIHNob3VsZCB0aGUgYXVjdGlvbiBvcGVuIHVwIGZvciBiaWRkaW5nXG4gICAqICAgc3RhcnRUaW1lc3RhbXA6IG5ldyBEYXRlKERhdGUubm93KCkpLFxuICAgKiAgIC8vIGVuZCB0aW1lIG9mIGF1Y3Rpb25cbiAgICogICBlbmRUaW1lc3RhbXA6IG5ldyBEYXRlKERhdGUubm93KCkgKyA1ICogMjQgKiA2MCAqIDYwICogMTAwMCksXG4gICAqIH1cbiAgICpcbiAgICogY29uc3QgdHggPSBhd2FpdCBjb250cmFjdC5lbmdsaXNoQXVjdGlvbnMuY3JlYXRlQXVjdGlvbihhdWN0aW9uKTtcbiAgICogY29uc3QgcmVjZWlwdCA9IHR4LnJlY2VpcHQ7IC8vIHRoZSB0cmFuc2FjdGlvbiByZWNlaXB0XG4gICAqIGNvbnN0IGlkID0gdHguaWQ7IC8vIHRoZSBpZCBvZiB0aGUgbmV3bHkgY3JlYXRlZCBhdWN0aW9uXG4gICAqXG4gICAqIC8vIEFuZCBvbiB0aGUgYnV5ZXJzIHNpZGU6XG4gICAqIC8vIFRoZSBhdWN0aW9uIElEIG9mIHRoZSBhc3NldCB5b3Ugd2FudCB0byBiaWQgb25cbiAgICogY29uc3QgYXVjdGlvbklkID0gMDtcbiAgICogLy8gVGhlIHRvdGFsIGFtb3VudCB5b3UgYXJlIHdpbGxpbmcgdG8gYmlkIGZvciBhdWN0aW9uZWQgdG9rZW5zXG4gICAqIGNvbnN0IGJpZEFtb3VudCA9IDE7XG4gICAqXG4gICAqIGF3YWl0IGNvbnRyYWN0LmVuZ2xpc2hBdWN0aW9ucy5tYWtlQmlkKGF1Y3Rpb25JZCwgYmlkQW1vdW50KTtcbiAgICogYGBgXG4gICAqL1xuICBnZXQgZW5nbGlzaEF1Y3Rpb25zKCkge1xuICAgIHJldHVybiBhc3NlcnRFbmFibGVkKHRoaXMuZGV0ZWN0RW5nbGlzaEF1Y3Rpb25zKCksIEZFQVRVUkVfRU5HTElTSF9BVUNUSU9OUyk7XG4gIH1cblxuICAvKipcbiAgICogT2ZmZXJzXG4gICAqIEByZW1hcmtzIE1ha2UgYW5kIG1hbmFnZSBvZmZlcnMuXG4gICAqIEBleGFtcGxlXG4gICAqIGBgYGphdmFzY3JpcHRcbiAgICogLy8gRGF0YSBvZiB0aGUgb2ZmZXIgeW91IHdhbnQgdG8gbWFrZVxuICAgKiBjb25zdCBvZmZlciA9IHtcbiAgICogICAvLyBhZGRyZXNzIG9mIHRoZSBjb250cmFjdCB0aGUgYXNzZXQgeW91IHdhbnQgdG8gbWFrZSBhbiBvZmZlciBmb3JcbiAgICogICBhc3NldENvbnRyYWN0QWRkcmVzczogXCIweC4uLlwiLFxuICAgKiAgIC8vIHRva2VuIElEIG9mIHRoZSBhc3NldCB5b3Ugd2FudCB0byBidXlcbiAgICogICB0b2tlbklkOiBcIjBcIixcbiAgICogICAvLyBob3cgbWFueSBvZiB0aGUgYXNzZXQgeW91IHdhbnQgdG8gYnV5XG4gICAqICAgcXVhbnRpdHk6IDEsXG4gICAqICAgLy8gYWRkcmVzcyBvZiB0aGUgY3VycmVuY3kgY29udHJhY3QgdGhhdCB5b3Ugb2ZmZXIgdG8gcGF5IGluXG4gICAqICAgY3VycmVuY3lDb250cmFjdEFkZHJlc3M6IE5BVElWRV9UT0tFTl9BRERSRVNTLFxuICAgKiAgIC8vIFRvdGFsIHByaWNlIHlvdSBvZmZlciB0byBwYXkgZm9yIHRoZSBtZW50aW9uZWQgdG9rZW4ocylcbiAgICogICB0b3RhbFByaWNlOiBcIjEuNVwiLFxuICAgKiAgIC8vIE9mZmVyIHZhbGlkIHVudGlsXG4gICAqICAgZW5kVGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgKiB9XG4gICAqXG4gICAqIGNvbnN0IHR4ID0gYXdhaXQgY29udHJhY3Qub2ZmZXJzLm1ha2VPZmZlcihvZmZlcik7XG4gICAqIGNvbnN0IHJlY2VpcHQgPSB0eC5yZWNlaXB0OyAvLyB0aGUgdHJhbnNhY3Rpb24gcmVjZWlwdFxuICAgKiBjb25zdCBpZCA9IHR4LmlkOyAvLyB0aGUgaWQgb2YgdGhlIG5ld2x5IGNyZWF0ZWQgb2ZmZXJcbiAgICpcbiAgICogLy8gQW5kIG9uIHRoZSBzZWxsZXIncyBzaWRlOlxuICAgKiAvLyBUaGUgSUQgb2YgdGhlIG9mZmVyIHlvdSB3YW50IHRvIGFjY2VwdFxuICAgKiBjb25zdCBvZmZlcklkID0gMDtcbiAgICogYXdhaXQgY29udHJhY3Qub2ZmZXJzLmFjY2VwdE9mZmVyKG9mZmVySWQpO1xuICAgKiBgYGBcbiAgICovXG4gIGdldCBvZmZlcnMoKSB7XG4gICAgcmV0dXJuIGFzc2VydEVuYWJsZWQodGhpcy5kZXRlY3RPZmZlcnMoKSwgRkVBVFVSRV9PRkZFUlMpO1xuICB9XG4gIGdldCBjaGFpbklkKCkge1xuICAgIHJldHVybiB0aGlzLl9jaGFpbklkO1xuICB9XG4gIGNvbnN0cnVjdG9yKG5ldHdvcmssIGFkZHJlc3MsIHN0b3JhZ2UpIHtcbiAgICBsZXQgb3B0aW9ucyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDoge307XG4gICAgbGV0IGFiaSA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ID8gYXJndW1lbnRzWzRdIDogdW5kZWZpbmVkO1xuICAgIGxldCBjaGFpbklkID0gYXJndW1lbnRzLmxlbmd0aCA+IDUgPyBhcmd1bWVudHNbNV0gOiB1bmRlZmluZWQ7XG4gICAgbGV0IGNvbnRyYWN0V3JhcHBlciA9IGFyZ3VtZW50cy5sZW5ndGggPiA2ICYmIGFyZ3VtZW50c1s2XSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzZdIDogbmV3IENvbnRyYWN0V3JhcHBlcihuZXR3b3JrLCBhZGRyZXNzLCBhYmksIG9wdGlvbnMpO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImFiaVwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImNvbnRyYWN0V3JhcHBlclwiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInN0b3JhZ2VcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJlbmNvZGVyXCIsIHZvaWQgMCk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwiZXZlbnRzXCIsIHZvaWQgMCk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwiZXN0aW1hdG9yXCIsIHZvaWQgMCk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwicGxhdGZvcm1GZWVzXCIsIHZvaWQgMCk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwibWV0YWRhdGFcIiwgdm9pZCAwKTtcbiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgXCJyb2xlc1wiLCB2b2lkIDApO1xuICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImludGVyY2VwdG9yXCIsIHZvaWQgMCk7XG4gICAgX2RlZmluZVByb3BlcnR5KHRoaXMsIFwiX2NoYWluSWRcIiwgdm9pZCAwKTtcbiAgICB0aGlzLl9jaGFpbklkID0gY2hhaW5JZDtcbiAgICB0aGlzLmFiaSA9IGFiaTtcbiAgICB0aGlzLmNvbnRyYWN0V3JhcHBlciA9IGNvbnRyYWN0V3JhcHBlcjtcbiAgICB0aGlzLnN0b3JhZ2UgPSBzdG9yYWdlO1xuICAgIHRoaXMubWV0YWRhdGEgPSBuZXcgQ29udHJhY3RNZXRhZGF0YSh0aGlzLmNvbnRyYWN0V3JhcHBlciwgTWFya2V0cGxhY2VDb250cmFjdFNjaGVtYSwgdGhpcy5zdG9yYWdlKTtcbiAgICB0aGlzLnJvbGVzID0gbmV3IENvbnRyYWN0Um9sZXModGhpcy5jb250cmFjdFdyYXBwZXIsIE1hcmtldHBsYWNlVjMuY29udHJhY3RSb2xlcyk7XG4gICAgdGhpcy5lbmNvZGVyID0gbmV3IENvbnRyYWN0RW5jb2Rlcih0aGlzLmNvbnRyYWN0V3JhcHBlcik7XG4gICAgdGhpcy5lc3RpbWF0b3IgPSBuZXcgR2FzQ29zdEVzdGltYXRvcih0aGlzLmNvbnRyYWN0V3JhcHBlcik7XG4gICAgdGhpcy5ldmVudHMgPSBuZXcgQ29udHJhY3RFdmVudHModGhpcy5jb250cmFjdFdyYXBwZXIpO1xuICAgIHRoaXMucGxhdGZvcm1GZWVzID0gbmV3IENvbnRyYWN0UGxhdGZvcm1GZWUodGhpcy5jb250cmFjdFdyYXBwZXIpO1xuICAgIHRoaXMuaW50ZXJjZXB0b3IgPSBuZXcgQ29udHJhY3RJbnRlcmNlcHRvcih0aGlzLmNvbnRyYWN0V3JhcHBlcik7XG4gIH1cbiAgb25OZXR3b3JrVXBkYXRlZChuZXR3b3JrKSB7XG4gICAgdGhpcy5jb250cmFjdFdyYXBwZXIudXBkYXRlU2lnbmVyT3JQcm92aWRlcihuZXR3b3JrKTtcbiAgfVxuICBnZXRBZGRyZXNzKCkge1xuICAgIHJldHVybiB0aGlzLmNvbnRyYWN0V3JhcHBlci5yZWFkQ29udHJhY3QuYWRkcmVzcztcbiAgfVxuXG4gIC8qKlxuICAgKiBAaW50ZXJuYWxcbiAgICovXG4gIGFzeW5jIGNhbGwoZnVuY3Rpb25OYW1lKSB7XG4gICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDEgPyBfbGVuIC0gMSA6IDApLCBfa2V5ID0gMTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmNvbnRyYWN0V3JhcHBlci5jYWxsKGZ1bmN0aW9uTmFtZSwgLi4uYXJncyk7XG4gIH1cblxuICAvKiogKioqKioqKioqKioqKioqKioqKipcbiAgICogRkVBVFVSRSBERVRFQ1RJT05cbiAgICogKioqKioqKioqKioqKioqKioqKiovXG5cbiAgZGV0ZWN0RGlyZWN0TGlzdGluZ3MoKSB7XG4gICAgaWYgKGRldGVjdENvbnRyYWN0RmVhdHVyZSh0aGlzLmNvbnRyYWN0V3JhcHBlciwgXCJEaXJlY3RMaXN0aW5nc1wiKSkge1xuICAgICAgcmV0dXJuIG5ldyBNYXJrZXRwbGFjZVYzRGlyZWN0TGlzdGluZ3ModGhpcy5jb250cmFjdFdyYXBwZXIsIHRoaXMuc3RvcmFnZSk7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgZGV0ZWN0RW5nbGlzaEF1Y3Rpb25zKCkge1xuICAgIGlmIChkZXRlY3RDb250cmFjdEZlYXR1cmUodGhpcy5jb250cmFjdFdyYXBwZXIsIFwiRW5nbGlzaEF1Y3Rpb25zXCIpKSB7XG4gICAgICByZXR1cm4gbmV3IE1hcmtldHBsYWNlVjNFbmdsaXNoQXVjdGlvbnModGhpcy5jb250cmFjdFdyYXBwZXIsIHRoaXMuc3RvcmFnZSk7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbiAgZGV0ZWN0T2ZmZXJzKCkge1xuICAgIGlmIChkZXRlY3RDb250cmFjdEZlYXR1cmUodGhpcy5jb250cmFjdFdyYXBwZXIsIFwiT2ZmZXJzXCIpKSB7XG4gICAgICByZXR1cm4gbmV3IE1hcmtldHBsYWNlVjNPZmZlcnModGhpcy5jb250cmFjdFdyYXBwZXIsIHRoaXMuc3RvcmFnZSk7XG4gICAgfVxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cbn1cbl9kZWZpbmVQcm9wZXJ0eShNYXJrZXRwbGFjZVYzLCBcImNvbnRyYWN0Um9sZXNcIiwgW1wiYWRtaW5cIiwgXCJsaXN0ZXJcIiwgXCJhc3NldFwiXSk7XG5cbmV4cG9ydCB7IE1hcmtldHBsYWNlVjMgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./node_modules/@thirdweb-dev/sdk/dist/marketplacev3-4b7b9376.esm.js\n"));

/***/ })

}]);